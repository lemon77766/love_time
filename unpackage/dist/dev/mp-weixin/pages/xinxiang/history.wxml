<view class="history-page"><view wx:if="{{a}}" class="letter-list"><view wx:for="{{b}}" wx:for-item="letter" wx:key="k" class="letter-card" bindtap="{{letter.l}}"><view class="card-preview"><image class="preview-bg" src="{{letter.a}}" mode="aspectFill"></image><view class="preview-overlay" style="{{'opacity:' + letter.b}}"></view><view class="preview-badge"><text class="badge-text">{{letter.c}}</text></view></view><view class="card-info"><text class="card-title">{{letter.d}}</text><view class="card-meta"><text class="meta-item">📅 送达: {{letter.e}}</text><text class="meta-item">📝 {{letter.f}}</text></view><view class="card-preview-content"><text class="preview-text">{{letter.g}}{{letter.h}}</text></view></view><view class="card-actions"><view class="action-btn view" catchtap="{{letter.i}}"><text>👁️ 查看</text></view><view class="action-btn delete" catchtap="{{letter.j}}"><text>🗑️ 删除</text></view></view></view></view><view wx:else class="empty-state"><text class="empty-icon">✉️</text><text class="empty-text">还没有写过信件</text><button class="write-btn" bindtap="{{c}}">写第一封信</button></view><view wx:if="{{d}}" class="detail-modal-overlay" bindtap="{{q}}"><view class="detail-modal-content" catchtap="{{p}}"><text class="detail-modal-title">信件详情</text><view class="letter-detail"><view class="letter-wrapper"><image class="letter-bg" src="{{e}}" mode="aspectFill"></image><view class="letter-overlay" style="{{'opacity:' + f}}"></view><view class="letter-content"><view class="letter-header"><text class="letter-title">{{g}}</text><text class="letter-date">送达时间：{{h}}</text></view><view class="letter-body"><text class="letter-text">{{i}}</text></view><view class="letter-footer"><text class="letter-info">收件人：{{j}}****{{k}}</text><text wx:if="{{l}}" class="letter-info">微信：{{m}}</text><text class="letter-time">创建于 {{n}}</text></view></view></view></view><view class="detail-modal-actions"><button class="detail-modal-btn close" bindtap="{{o}}">关闭</button></view></view></view></view>