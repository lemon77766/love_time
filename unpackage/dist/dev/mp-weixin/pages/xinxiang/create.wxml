<view class="create-page"><view class="steps"><view class="{{['step', a && 'active']}}"><view class="step-number">1</view><text class="step-text">选择样式</text></view><view class="step-line"></view><view class="{{['step', b && 'active']}}"><view class="step-number">2</view><text class="step-text">填写信息</text></view></view><view wx:if="{{c}}" class="step-content"><text class="section-title">选择信件样式</text><view class="style-grid"><view wx:for="{{d}}" wx:for-item="i" wx:key="c" class="{{['style-item', i.d && 'selected']}}" bindtap="{{i.e}}"><image class="style-image" src="{{i.a}}" mode="aspectFill"></image><view wx:if="{{i.b}}" class="check-mark">✓</view></view></view><view class="custom-section"><button class="custom-btn" bindtap="{{e}}"><text class="btn-icon">📷</text><text>自定义信件底图</text></button><view wx:if="{{f}}" class="custom-preview" bindtap="{{v}}"><view class="preview-wrapper"><image class="preview-bg" src="{{g}}" mode="aspectFill"></image><view class="preview-overlay" style="{{'opacity:' + h}}"></view><view class="mask-layer"><view class="mask-top" style="{{'height:' + i}}"></view><view class="mask-middle" style="{{'top:' + m + ';' + ('height:' + n)}}"><view class="mask-left" style="{{'width:' + j}}"></view><view class="mask-center" style="{{'width:' + k}}"></view><view class="mask-right" style="{{'width:' + l}}"></view></view><view class="mask-bottom" style="{{'top:' + o + ';' + ('height:' + p)}}"></view></view><view class="crop-preview" style="{{'left:' + q + ';' + ('top:' + r) + ';' + ('width:' + s) + ';' + ('height:' + t)}}"></view></view><text class="preview-tip">点击调整透明度和选定区域</text></view></view><button class="next-btn" bindtap="{{w}}">下一步</button></view><view wx:if="{{x}}" class="modal-overlay" bindtap="{{af}}"><view class="modal-content" catchtap="{{ae}}"><text class="modal-title">调整图片</text><view class="modal-preview"><view class="preview-wrapper" bindtouchmove="{{T}}" bindtouchend="{{U}}"><image class="preview-bg" src="{{y}}" mode="aspectFill" style="{{'transform:' + z + ';' + ('transform-origin:' + 'center center')}}"></image><view class="preview-overlay" style="{{'opacity:' + A}}"></view><view class="mask-layer"><view class="mask-top" style="{{'height:' + B}}"></view><view class="mask-middle" style="{{'top:' + F + ';' + ('height:' + G)}}"><view class="mask-left" style="{{'width:' + C}}"></view><view class="mask-center" style="{{'width:' + D}}"></view><view class="mask-right" style="{{'width:' + E}}"></view></view><view class="mask-bottom" style="{{'top:' + H + ';' + ('height:' + I)}}"></view></view><view class="crop-box" style="{{'left:' + M + ';' + ('top:' + N) + ';' + ('width:' + O) + ';' + ('height:' + P)}}" bindtouchstart="{{Q}}" catchtouchmove="{{R}}" bindtouchend="{{S}}"><view class="crop-border"></view><view class="crop-corner corner-tl"></view><view class="crop-corner corner-tr"></view><view class="crop-corner corner-bl"></view><view class="crop-corner corner-br" catchtouchstart="{{J}}" catchtouchmove="{{K}}" bindtouchend="{{L}}"></view><text class="crop-hint">拖动移动，右下角调整大小</text></view></view></view><view class="opacity-control"><text class="control-label">透明度</text><slider class="slider" value="{{V}}" bindchange="{{W}}" bindchanging="{{X}}" min="0" max="100" activeColor="#d483b8" block-size="20"/><text class="control-value">{{Y}}%</text></view><view class="opacity-control"><text class="control-label">底图大小</text><slider class="slider" value="{{Z}}" bindchange="{{aa}}" bindchanging="{{ab}}" min="50" max="200" activeColor="#d483b8" block-size="20"/><text class="control-value">{{ac}}%</text></view><view class="modal-actions"><button class="modal-btn cancel" bindtap="{{ad}}">完成</button></view></view></view><view wx:if="{{ag}}" class="step-content"><text class="section-title">填写信件信息</text><view class="form"><view class="form-item"><text class="form-label">信件主题</text><input class="form-input" placeholder="例如：给未来的你" maxlength="50" value="{{ah}}" bindinput="{{ai}}"/></view><view class="form-item"><text class="form-label">预计送达时间</text><picker mode="date" value="{{ak}}" bindchange="{{al}}" start="{{am}}"><view class="picker-display">{{aj}}</view></picker></view><view class="form-item"><text class="form-label">对方手机号</text><input class="form-input" placeholder="请输入手机号" type="number" maxlength="11" value="{{an}}" bindinput="{{ao}}"/></view><view class="form-item"><text class="form-label">对方微信号</text><input class="form-input" placeholder="请输入微信号（选填）" value="{{ap}}" bindinput="{{aq}}"/></view><view class="form-item"><text class="form-label">信件内容</text><block wx:if="{{r0}}"><textarea class="form-textarea" placeholder="写下你想说的话..." maxlength="1000" value="{{ar}}" bindinput="{{as}}"/></block><text class="char-count">{{at}}/1000</text></view></view><view class="action-btns"><button class="back-btn" bindtap="{{av}}">上一步</button><button class="preview-btn" bindtap="{{aw}}">👁️ 预览</button><button class="submit-btn" bindtap="{{ax}}">提交信件</button></view></view><view wx:if="{{ay}}" class="preview-modal-overlay" bindtap="{{aT}}"><view class="preview-modal-content" catchtap="{{aS}}"><text class="preview-modal-title">信件预览</text><view class="letter-preview"><view class="letter-wrapper"><image class="letter-bg" src="{{az}}" mode="aspectFill" style="{{'transform:' + aA + ';' + ('transform-origin:' + 'center center')}}"></image><view class="letter-overlay" style="{{'opacity:' + aB}}"></view><view class="letter-content"><view class="letter-header"><text class="letter-title">{{aC}}</text><text class="letter-date">送达时间：{{aD}}</text></view><view class="letter-body"><text class="letter-text">{{aE}}</text></view><view class="letter-footer"><text wx:if="{{aF}}" class="letter-sign">—— 给 {{aG}}****{{aH}}</text></view></view></view></view><view class="preview-controls"><view class="opacity-control"><text class="control-label">透明度</text><slider class="slider" value="{{aI}}" bindchange="{{aJ}}" bindchanging="{{aK}}" min="0" max="100" activeColor="#d483b8" block-size="20"/><text class="control-value">{{aL}}%</text></view><view class="opacity-control"><text class="control-label">底图大小</text><slider class="slider" value="{{aM}}" bindchange="{{aN}}" bindchanging="{{aO}}" min="50" max="200" activeColor="#d483b8" block-size="20"/><text class="control-value">{{aP}}%</text></view></view><view class="preview-modal-actions"><button class="preview-modal-btn adjust" bindtap="{{aQ}}">调整底图</button><button class="preview-modal-btn close" bindtap="{{aR}}">关闭</button></view></view></view><view wx:if="{{aU}}" class="modal-overlay" bindtap="{{bF}}"><view class="modal-content" catchtap="{{bE}}"><text class="modal-title">调整底图</text><view class="modal-preview"><view class="preview-wrapper" bindtouchmove="{{bs}}" bindtouchend="{{bt}}"><image class="preview-bg" src="{{aV}}" mode="aspectFill" style="{{'transform:' + aW + ';' + ('transform-origin:' + 'center center')}}"></image><view class="preview-overlay" style="{{'opacity:' + aX}}"></view><view wx:if="{{aY}}" class="mask-layer"><view class="mask-top" style="{{'height:' + aZ}}"></view><view class="mask-middle" style="{{'top:' + bd + ';' + ('height:' + be)}}"><view class="mask-left" style="{{'width:' + ba}}"></view><view class="mask-center" style="{{'width:' + bb}}"></view><view class="mask-right" style="{{'width:' + bc}}"></view></view><view class="mask-bottom" style="{{'top:' + bf + ';' + ('height:' + bg)}}"></view></view><view wx:if="{{bh}}" class="crop-box" style="{{'left:' + bl + ';' + ('top:' + bm) + ';' + ('width:' + bn) + ';' + ('height:' + bo)}}" bindtouchstart="{{bp}}" catchtouchmove="{{bq}}" bindtouchend="{{br}}"><view class="crop-border"></view><view class="crop-corner corner-tl"></view><view class="crop-corner corner-tr"></view><view class="crop-corner corner-bl"></view><view class="crop-corner corner-br" catchtouchstart="{{bi}}" catchtouchmove="{{bj}}" bindtouchend="{{bk}}"></view><text class="crop-hint">拖动移动，右下角调整大小</text></view></view></view><view class="opacity-control"><text class="control-label">透明度</text><slider class="slider" value="{{bv}}" bindchange="{{bw}}" bindchanging="{{bx}}" min="0" max="100" activeColor="#d483b8" block-size="20"/><text class="control-value">{{by}}%</text></view><view class="opacity-control"><text class="control-label">底图大小</text><slider class="slider" value="{{bz}}" bindchange="{{bA}}" bindchanging="{{bB}}" min="50" max="200" activeColor="#d483b8" block-size="20"/><text class="control-value">{{bC}}%</text></view><view class="modal-actions"><button class="modal-btn cancel" bindtap="{{bD}}">完成</button></view></view></view><view wx:if="{{bG}}" class="preview-modal-overlay"><view class="preview-modal-content" catchtap="{{bQ}}"><text class="preview-modal-title">信件预览</text><view class="letter-preview"><view class="letter-wrapper"><image class="letter-bg" src="{{bH}}" mode="aspectFill" style="{{'clip-path:' + bI}}"></image><view class="letter-overlay" style="{{'opacity:' + bJ}}"></view><view class="letter-content"><view class="letter-header"><text class="letter-title">{{bK}}</text><text class="letter-date">送达时间：{{bL}}</text></view><view class="letter-body"><text class="letter-text">{{bM}}</text></view><view class="letter-footer"><text class="letter-sign">—— 给 {{bN}}****{{bO}}</text></view></view></view></view><view class="preview-modal-actions"><button class="preview-modal-btn confirm" bindtap="{{bP}}">确认</button></view></view></view></view>