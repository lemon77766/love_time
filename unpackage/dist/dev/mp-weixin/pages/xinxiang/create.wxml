<view class="create-page" style="{{'padding-top:' + bU}}"><view class="custom-navbar"><view class="navbar-gradient-bg"></view><view class="status-bar" style="{{'height:' + a}}"></view><view class="navbar-content" style="{{'height:' + c}}"><view class="navbar-left" bindtap="{{b}}"><text class="back-icon">←</text></view><view class="navbar-title"><text class="title-text">写信</text></view><view class="navbar-right"></view></view></view><view class="steps"><view class="{{['step', d && 'active']}}"><view class="step-number">1</view><text class="step-text">选择样式</text></view><view class="step-line"></view><view class="{{['step', e && 'active']}}"><view class="step-number">2</view><text class="step-text">填写信息</text></view></view><view wx:if="{{f}}" class="step-content"><text class="section-title">选择信件样式</text><view class="style-grid"><view wx:for="{{g}}" wx:for-item="i" wx:key="c" class="{{['style-item', i.d && 'selected']}}" bindtap="{{i.e}}"><image class="style-image" src="{{i.a}}" mode="aspectFill"></image><view wx:if="{{i.b}}" class="check-mark">✓</view></view></view><view class="custom-section"><button class="custom-btn" bindtap="{{h}}"><text class="btn-icon">📷</text><text>自定义信件底图</text></button><view wx:if="{{i}}" class="custom-preview" bindtap="{{y}}"><view class="preview-wrapper"><image class="preview-bg" src="{{j}}" mode="aspectFill"></image><view class="preview-overlay" style="{{'opacity:' + k}}"></view><view class="mask-layer"><view class="mask-top" style="{{'height:' + l}}"></view><view class="mask-middle" style="{{'top:' + p + ';' + ('height:' + q)}}"><view class="mask-left" style="{{'width:' + m}}"></view><view class="mask-center" style="{{'width:' + n}}"></view><view class="mask-right" style="{{'width:' + o}}"></view></view><view class="mask-bottom" style="{{'top:' + r + ';' + ('height:' + s)}}"></view></view><view class="crop-preview" style="{{'left:' + t + ';' + ('top:' + v) + ';' + ('width:' + w) + ';' + ('height:' + x)}}"></view></view><text class="preview-tip">点击调整透明度和选定区域</text></view></view><button class="next-btn" bindtap="{{z}}">下一步</button></view><view wx:if="{{A}}" class="modal-overlay" bindtap="{{ai}}"><view class="modal-content" catchtap="{{ah}}"><text class="modal-title">调整图片</text><view class="modal-preview"><view class="preview-wrapper" bindtouchmove="{{W}}" bindtouchend="{{X}}"><image class="preview-bg" src="{{B}}" mode="aspectFill" style="{{'transform:' + C + ';' + ('transform-origin:' + 'center center')}}"></image><view class="preview-overlay" style="{{'opacity:' + D}}"></view><view class="mask-layer"><view class="mask-top" style="{{'height:' + E}}"></view><view class="mask-middle" style="{{'top:' + I + ';' + ('height:' + J)}}"><view class="mask-left" style="{{'width:' + F}}"></view><view class="mask-center" style="{{'width:' + G}}"></view><view class="mask-right" style="{{'width:' + H}}"></view></view><view class="mask-bottom" style="{{'top:' + K + ';' + ('height:' + L)}}"></view></view><view class="crop-box" style="{{'left:' + P + ';' + ('top:' + Q) + ';' + ('width:' + R) + ';' + ('height:' + S)}}" bindtouchstart="{{T}}" catchtouchmove="{{U}}" bindtouchend="{{V}}"><view class="crop-border"></view><view class="crop-corner corner-tl"></view><view class="crop-corner corner-tr"></view><view class="crop-corner corner-bl"></view><view class="crop-corner corner-br" catchtouchstart="{{M}}" catchtouchmove="{{N}}" bindtouchend="{{O}}"></view><text class="crop-hint">拖动移动，右下角调整大小</text></view></view></view><view class="opacity-control"><text class="control-label">透明度</text><slider class="slider" value="{{Y}}" bindchange="{{Z}}" bindchanging="{{aa}}" min="0" max="100" activeColor="#DCC7E1" block-size="20"/><text class="control-value">{{ab}}%</text></view><view class="opacity-control"><text class="control-label">底图大小</text><slider class="slider" value="{{ac}}" bindchange="{{ad}}" bindchanging="{{ae}}" min="50" max="200" activeColor="#DCC7E1" block-size="20"/><text class="control-value">{{af}}%</text></view><view class="modal-actions"><button class="modal-btn cancel" bindtap="{{ag}}">完成</button></view></view></view><view wx:if="{{aj}}" class="step-content"><text class="section-title">填写信件信息</text><view class="form"><view class="form-item"><text class="form-label">信件主题</text><input class="form-input" placeholder="例如：给未来的你" maxlength="50" value="{{ak}}" bindinput="{{al}}"/></view><view class="form-item"><text class="form-label">预计送达时间</text><picker mode="date" value="{{an}}" bindchange="{{ao}}" start="{{ap}}"><view class="picker-display">{{am}}</view></picker></view><view class="form-item"><text class="form-label">对方手机号</text><input class="form-input" placeholder="请输入手机号" type="number" maxlength="11" value="{{aq}}" bindinput="{{ar}}"/></view><view class="form-item"><text class="form-label">对方微信号</text><input class="form-input" placeholder="请输入微信号（选填）" value="{{as}}" bindinput="{{at}}"/></view><view class="form-item"><text class="form-label">信件内容</text><block wx:if="{{r0}}"><textarea class="form-textarea" placeholder="写下你想说的话..." maxlength="1000" value="{{av}}" bindinput="{{aw}}"/></block><text class="char-count">{{ax}}/1000</text></view></view><view class="action-btns"><button class="back-btn" bindtap="{{ay}}">上一步</button><button class="preview-btn" bindtap="{{az}}">👁️ 预览</button><button class="submit-btn" bindtap="{{aA}}">提交信件</button></view></view><view wx:if="{{aB}}" class="preview-modal-overlay" bindtap="{{aW}}"><view class="preview-modal-content" catchtap="{{aV}}"><text class="preview-modal-title">信件预览</text><view class="letter-preview"><view class="letter-wrapper"><image class="letter-bg" src="{{aC}}" mode="aspectFill" style="{{'transform:' + aD + ';' + ('transform-origin:' + 'center center')}}"></image><view class="letter-overlay" style="{{'opacity:' + aE}}"></view><view class="letter-content"><view class="letter-header"><text class="letter-title">{{aF}}</text><text class="letter-date">送达时间：{{aG}}</text></view><view class="letter-body"><text class="letter-text">{{aH}}</text></view><view class="letter-footer"><text wx:if="{{aI}}" class="letter-sign">—— 给 {{aJ}}****{{aK}}</text></view></view></view></view><view class="preview-controls"><view class="opacity-control"><text class="control-label">透明度</text><slider class="slider" value="{{aL}}" bindchange="{{aM}}" bindchanging="{{aN}}" min="0" max="100" activeColor="#DCC7E1" block-size="20"/><text class="control-value">{{aO}}%</text></view><view class="opacity-control"><text class="control-label">底图大小</text><slider class="slider" value="{{aP}}" bindchange="{{aQ}}" bindchanging="{{aR}}" min="50" max="200" activeColor="#DCC7E1" block-size="20"/><text class="control-value">{{aS}}%</text></view></view><view class="preview-modal-actions"><button class="preview-modal-btn adjust" bindtap="{{aT}}">调整底图</button><button class="preview-modal-btn close" bindtap="{{aU}}">关闭</button></view></view></view><view wx:if="{{aX}}" class="modal-overlay" bindtap="{{bI}}"><view class="modal-content" catchtap="{{bH}}"><text class="modal-title">调整底图</text><view class="modal-preview"><view class="preview-wrapper" bindtouchmove="{{bw}}" bindtouchend="{{bx}}"><image class="preview-bg" src="{{aY}}" mode="aspectFill" style="{{'transform:' + aZ + ';' + ('transform-origin:' + 'center center')}}"></image><view class="preview-overlay" style="{{'opacity:' + ba}}"></view><view wx:if="{{bb}}" class="mask-layer"><view class="mask-top" style="{{'height:' + bc}}"></view><view class="mask-middle" style="{{'top:' + bg + ';' + ('height:' + bh)}}"><view class="mask-left" style="{{'width:' + bd}}"></view><view class="mask-center" style="{{'width:' + be}}"></view><view class="mask-right" style="{{'width:' + bf}}"></view></view><view class="mask-bottom" style="{{'top:' + bi + ';' + ('height:' + bj)}}"></view></view><view wx:if="{{bk}}" class="crop-box" style="{{'left:' + bo + ';' + ('top:' + bp) + ';' + ('width:' + bq) + ';' + ('height:' + br)}}" bindtouchstart="{{bs}}" catchtouchmove="{{bt}}" bindtouchend="{{bv}}"><view class="crop-border"></view><view class="crop-corner corner-tl"></view><view class="crop-corner corner-tr"></view><view class="crop-corner corner-bl"></view><view class="crop-corner corner-br" catchtouchstart="{{bl}}" catchtouchmove="{{bm}}" bindtouchend="{{bn}}"></view><text class="crop-hint">拖动移动，右下角调整大小</text></view></view></view><view class="opacity-control"><text class="control-label">透明度</text><slider class="slider" value="{{by}}" bindchange="{{bz}}" bindchanging="{{bA}}" min="0" max="100" activeColor="#DCC7E1" block-size="20"/><text class="control-value">{{bB}}%</text></view><view class="opacity-control"><text class="control-label">底图大小</text><slider class="slider" value="{{bC}}" bindchange="{{bD}}" bindchanging="{{bE}}" min="50" max="200" activeColor="#DCC7E1" block-size="20"/><text class="control-value">{{bF}}%</text></view><view class="modal-actions"><button class="modal-btn cancel" bindtap="{{bG}}">完成</button></view></view></view><view wx:if="{{bJ}}" class="preview-modal-overlay"><view class="preview-modal-content" catchtap="{{bT}}"><text class="preview-modal-title">信件预览</text><view class="letter-preview"><view class="letter-wrapper"><image class="letter-bg" src="{{bK}}" mode="aspectFill" style="{{'clip-path:' + bL}}"></image><view class="letter-overlay" style="{{'opacity:' + bM}}"></view><view class="letter-content"><view class="letter-header"><text class="letter-title">{{bN}}</text><text class="letter-date">送达时间：{{bO}}</text></view><view class="letter-body"><text class="letter-text">{{bP}}</text></view><view class="letter-footer"><text class="letter-sign">—— 给 {{bQ}}****{{bR}}</text></view></view></view></view><view class="preview-modal-actions"><button class="preview-modal-btn confirm" bindtap="{{bS}}">确认</button></view></view></view></view>