{"version":3,"file":"trajectory.js","sources":["api/trajectory.js"],"sourcesContent":["/**\r\n * 轨迹相关 API\r\n */\r\n\r\nimport http from '../utils/http.js';\r\nimport config from '../utils/config.js';\r\n\r\n/**\r\n * 上传/更新用户位置信息（实时定位）\r\n * @param {Object} locationData - 位置数据\r\n * @param {number} locationData.latitude - 纬度（必填）\r\n * @param {number} locationData.longitude - 经度（必填）\r\n * @param {string} locationData.address - 地址（可选，后端可自动解析）\r\n * @param {string} locationData.location_name - 地点名称（可选）\r\n * @returns {Promise<Object>} 返回更新结果\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：POST\r\n * - 请求地址：/api/trajectory/location/update\r\n * - 请求头：需携带 Authorization token\r\n * - 请求参数：\r\n *   {\r\n *     latitude: number,        // 纬度（必填）\r\n *     longitude: number,       // 经度（必填）\r\n *     address: string,         // 地址（可选）\r\n *     location_name: string    // 地点名称（可选）\r\n *   }\r\n * - 返回数据：\r\n *   {\r\n *     success: true,\r\n *     message: \"位置更新成功\",\r\n *     data: {\r\n *       location_id: number,\r\n *       update_time: string    // ISO时间格式\r\n *     }\r\n *   }\r\n */\r\nexport function updateLocation(locationData) {\r\n  return http.post(config.API.TRAJECTORY.LOCATION_UPDATE, {\r\n    latitude: locationData.latitude,\r\n    longitude: locationData.longitude,\r\n    address: locationData.address,\r\n    location_name: locationData.location_name\r\n  });\r\n}\r\n\r\n/**\r\n * 获取双方实时位置\r\n * @returns {Promise<Object>} 返回双方位置信息\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：GET\r\n * - 请求地址：/api/trajectory/location/current\r\n * - 请求头：需携带 Authorization token\r\n * - 返回数据：\r\n *   {\r\n *     success: true,\r\n *     data: {\r\n *       my_location: {\r\n *         user_id: number,\r\n *         latitude: number,\r\n *         longitude: number,\r\n *         address: string,\r\n *         location_name: string,\r\n *         update_time: string    // ISO时间格式\r\n *       },\r\n *       partner_location: {\r\n *         user_id: number,\r\n *         latitude: number,\r\n *         longitude: number,\r\n *         address: string,\r\n *         location_name: string,\r\n *         update_time: string\r\n *       },\r\n *       distance: number,        // 双方距离（公里）\r\n *       distance_text: string     // 格式化距离（如：\"1.2公里\"）\r\n *     }\r\n *   }\r\n * \r\n * 注意：\r\n * - 如果对方未上传位置，partner_location 可能为 null\r\n * - 如果双方都未上传位置，返回错误或空数据\r\n */\r\nexport function getCurrentLocations() {\r\n  return http.get(config.API.TRAJECTORY.LOCATION_CURRENT);\r\n}\r\n\r\n/**\r\n * 获取主要轨迹点列表\r\n * @param {Object} params - 查询参数\r\n * @param {string} params.period - 时间范围：'7d'（7天）或 '30d'（30天），默认 '7d'（与start_date/end_date二选一）\r\n * @param {string} params.start_date - 开始日期（格式：YYYY-MM-DD），与end_date一起使用\r\n * @param {string} params.end_date - 结束日期（格式：YYYY-MM-DD），与start_date一起使用\r\n * @param {number} params.page - 页码（可选，默认1）\r\n * @param {number} params.limit - 每页数量（可选，默认50）\r\n * @returns {Promise<Object>} 返回轨迹点列表\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：GET\r\n * - 请求地址：/api/trajectory/points\r\n * - 请求头：需携带 Authorization token\r\n * - 请求参数：\r\n *   {\r\n *     period: string,      // '7d' 或 '30d'（可选，与start_date/end_date二选一）\r\n *     start_date: string,  // 开始日期（格式：YYYY-MM-DD），与end_date一起使用\r\n *     end_date: string,   // 结束日期（格式：YYYY-MM-DD），与start_date一起使用\r\n *     page: number,       // 页码（可选，默认1）\r\n *     limit: number       // 每页数量（可选，默认50）\r\n *   }\r\n * - 返回数据：\r\n *   {\r\n *     success: true,\r\n *     data: {\r\n *       points: [\r\n *         {\r\n *           id: number,\r\n *           user_id: number,\r\n *           latitude: number,\r\n *           longitude: number,\r\n *           address: string,\r\n *           location_name: string,\r\n *           visit_time: string,        // ISO时间格式\r\n *           stay_duration: number,      // 停留时长（分钟）\r\n *           importance_score: number,    // 重要性评分（0-10）\r\n *           visit_count: number,        // 到访次数\r\n *           is_manual: boolean,         // 是否手动添加\r\n *           description: string,        // 描述\r\n *           photos: string[]            // 照片列表\r\n *         }\r\n *       ],\r\n *       summary: {\r\n *         total_points: number,\r\n *         total_distance: number,       // 总行程（公里）\r\n *         most_visited: {              // 最常去的地点\r\n *           location_name: string,\r\n *           visit_count: number\r\n *         }\r\n *       }\r\n *     }\r\n *   }\r\n */\r\nexport function getTrajectoryPoints(params = {}) {\r\n  return http.get(config.API.TRAJECTORY.POINTS, params);\r\n}\r\n\r\n/**\r\n * 手动添加轨迹点\r\n * @param {Object} pointData - 轨迹点数据\r\n * @param {number} pointData.latitude - 纬度（必填）\r\n * @param {number} pointData.longitude - 经度（必填）\r\n * @param {string} pointData.address - 地址（可选）\r\n * @param {string} pointData.location_name - 地点名称（必填）\r\n * @param {string} pointData.visit_time - 到访时间（可选，默认当前时间，ISO格式）\r\n * @param {string} pointData.description - 描述（可选）\r\n * @param {string[]} pointData.photos - 照片列表（可选）\r\n * @returns {Promise<Object>} 返回添加结果\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：POST\r\n * - 请求地址：/api/trajectory/points\r\n * - 请求头：需携带 Authorization token\r\n * - 请求参数：\r\n *   {\r\n *     latitude: number,\r\n *     longitude: number,\r\n *     address: string,         // 可选\r\n *     location_name: string,    // 必填\r\n *     visit_time: string,       // ISO时间格式，可选，默认当前时间\r\n *     description: string,     // 可选\r\n *     photos: string[]          // 可选\r\n *   }\r\n * - 返回数据：\r\n *   {\r\n *     success: true,\r\n *     message: \"轨迹点添加成功\",\r\n *     data: {\r\n *       point_id: number,\r\n *       importance_score: number  // 手动添加的默认高分（10.0）\r\n *     }\r\n *   }\r\n */\r\nexport function addTrajectoryPoint(pointData) {\r\n  return http.post(config.API.TRAJECTORY.POINTS, {\r\n    latitude: pointData.latitude,\r\n    longitude: pointData.longitude,\r\n    address: pointData.address,\r\n    location_name: pointData.location_name,\r\n    visit_time: pointData.visit_time,\r\n    description: pointData.description,\r\n    photos: pointData.photos || []\r\n  });\r\n}\r\n\r\n/**\r\n * 获取轨迹统计信息\r\n * @param {Object} params - 查询参数\r\n * @param {string} params.period - 时间范围：'7d' 或 '30d'，默认 '7d'\r\n * @returns {Promise<Object>} 返回统计信息\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：GET\r\n * - 请求地址：/api/trajectory/statistics\r\n * - 请求头：需携带 Authorization token\r\n * - 请求参数：\r\n *   {\r\n *     period: string    // '7d' 或 '30d'（可选，默认'7d'）\r\n *   }\r\n * - 返回数据：\r\n *   {\r\n *     success: true,\r\n *     data: {\r\n *       total_points: number,\r\n *       total_distance: number,        // 总行程（公里）\r\n *       avg_daily_points: number,      // 平均每日轨迹点数\r\n *       most_visited_location: {\r\n *         name: string,\r\n *         count: number,\r\n *         latitude: number,\r\n *         longitude: number\r\n *       },\r\n *       trajectory_heatmap: [         // 轨迹热力图数据（可选）\r\n *         {\r\n *           latitude: number,\r\n *           longitude: number,\r\n *           intensity: number          // 热度值 0-1\r\n *         }\r\n *       ]\r\n *     }\r\n *   }\r\n */\r\nexport function getTrajectoryStatistics(params = {}) {\r\n  return http.get(config.API.TRAJECTORY.STATISTICS, params);\r\n}\r\n\r\n"],"names":["http","config"],"mappings":";;;AAqCO,SAAS,eAAe,cAAc;AAC3C,SAAOA,WAAAA,KAAK,KAAKC,aAAAA,OAAO,IAAI,WAAW,iBAAiB;AAAA,IACtD,UAAU,aAAa;AAAA,IACvB,WAAW,aAAa;AAAA,IACxB,SAAS,aAAa;AAAA,IACtB,eAAe,aAAa;AAAA,EAChC,CAAG;AACH;AAuCO,SAAS,sBAAsB;AACpC,SAAOD,WAAAA,KAAK,IAAIC,aAAAA,OAAO,IAAI,WAAW,gBAAgB;AACxD;AAwDO,SAAS,oBAAoB,SAAS,IAAI;AAC/C,SAAOD,WAAAA,KAAK,IAAIC,aAAM,OAAC,IAAI,WAAW,QAAQ,MAAM;AACtD;;;;"}