{"version":3,"file":"heartwall.js","sources":["api/heartwall.js"],"sourcesContent":["/**\r\n * 心形墙 API\r\n * 对接后端接口文档：心形墙API接口文档\r\n * 基础URL前缀：/api/heart-wall\r\n */\r\n\r\nimport http from '../utils/http.js';\r\nimport config from '../utils/config.js';\r\n\r\n/**\r\n * 创建心形墙项目\r\n * @param {Object} projectData - 项目数据\r\n * @param {string} projectData.projectName - 项目名称\r\n * @param {string} projectData.description - 项目描述\r\n * @param {boolean} projectData.isPublic - 是否公开\r\n * @param {number} projectData.maxPhotos - 最大照片数量\r\n * @returns {Promise<Object>} 返回创建结果\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：POST\r\n * - 请求地址：/api/heart-wall/projects\r\n * - 请求头：需携带 Authorization token\r\n * - 请求参数：\r\n *   {\r\n *     \"projectName\": \"我们的回忆\",\r\n *     \"description\": \"记录我们的美好时光\",\r\n *     \"isPublic\": false,\r\n *     \"maxPhotos\": 40\r\n *   }\r\n */\r\nexport function createProject(projectData) {\r\n  const url = config.API.HEART_WALL.PROJECTS;\r\n  const fullUrl = config.baseURL + url;\r\n  \r\n  console.log('🔗 [心形墙API] 开始创建项目');\r\n  console.log('📍 请求地址:', fullUrl);\r\n  console.log('📋 请求方法: POST');\r\n  console.log('📤 请求参数:', projectData);\r\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\r\n  \r\n  return http.post(url, projectData).then(response => {\r\n    console.log('✅ [心形墙API] 创建项目成功');\r\n    console.log('📦 响应数据:', response);\r\n    \r\n    if (response && response.data) {\r\n      console.log(`📝 项目ID: ${response.data.projectId || response.data.id || '未知'}`);\r\n      console.log(`📝 项目名称: ${response.data.projectName || '未知'}`);\r\n      return response;\r\n    } else if (response && (response.projectId || response.id)) {\r\n      // 兼容直接返回项目信息的情况\r\n      return { success: true, data: response };\r\n    } else {\r\n      console.warn('⚠️ 响应数据格式异常:', response);\r\n      return response;\r\n    }\r\n  }).catch(error => {\r\n    console.error('❌ [心形墙API] 创建项目失败');\r\n    console.error('🔴 错误信息:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n/**\r\n * 获取用户所有心形墙项目\r\n * @returns {Promise<Object>} 返回项目列表\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：GET\r\n * - 请求地址：/api/heart-wall/projects\r\n * - 请求头：需携带 Authorization token\r\n */\r\nexport function getProjects() {\r\n  const url = config.API.HEART_WALL.PROJECTS;\r\n  const fullUrl = config.baseURL + url;\r\n  \r\n  console.log('🔗 [心形墙API] 开始获取项目列表');\r\n  console.log('📍 请求地址:', fullUrl);\r\n  console.log('📋 请求方法: GET');\r\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\r\n  \r\n  return http.get(url).then(response => {\r\n    console.log('✅ [心形墙API] 获取项目列表成功');\r\n    console.log('📦 响应数据:', response);\r\n    \r\n    if (response && response.data) {\r\n      const projects = Array.isArray(response.data) ? response.data : (response.data.projects || []);\r\n      console.log(`📊 项目数量: ${projects.length}`);\r\n      return response;\r\n    } else if (Array.isArray(response)) {\r\n      // 兼容直接返回数组的情况\r\n      console.log(`📊 项目数量: ${response.length}`);\r\n      return { success: true, data: response };\r\n    } else if (response && response.projects) {\r\n      // 兼容直接返回对象包含projects字段的情况\r\n      console.log(`📊 项目数量: ${response.projects.length}`);\r\n      return { success: true, data: response.projects };\r\n    } else {\r\n      console.warn('⚠️ 响应数据格式异常:', response);\r\n      return { success: true, data: [] };\r\n    }\r\n  }).catch(error => {\r\n    console.error('❌ [心形墙API] 获取项目列表失败');\r\n    console.error('🔴 错误信息:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n/**\r\n * 获取心形墙项目详情\r\n * @param {number|string} projectId - 项目ID\r\n * @returns {Promise<Object>} 返回项目详情\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：GET\r\n * - 请求地址：/api/heart-wall/projects/{projectId}\r\n * - 请求头：需携带 Authorization token\r\n */\r\nexport function getProjectDetail(projectId) {\r\n  const url = `${config.API.HEART_WALL.PROJECT_DETAIL}/${projectId}`;\r\n  const fullUrl = config.baseURL + url;\r\n  \r\n  console.log('🔗 [心形墙API] 开始获取项目详情');\r\n  console.log('📍 请求地址:', fullUrl);\r\n  console.log('📋 请求方法: GET');\r\n  console.log('📝 项目ID:', projectId);\r\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\r\n  \r\n  return http.get(url).then(response => {\r\n    console.log('✅ [心形墙API] 获取项目详情成功');\r\n    console.log('📦 响应数据:', response);\r\n    \r\n    if (response && response.data) {\r\n      console.log(`📝 项目名称: ${response.data.projectName || '未知'}`);\r\n      return response;\r\n    } else if (response && (response.projectId || response.id)) {\r\n      // 兼容直接返回项目详情的情况\r\n      return { success: true, data: response };\r\n    } else {\r\n      console.warn('⚠️ 响应数据格式异常:', response);\r\n      return response;\r\n    }\r\n  }).catch(error => {\r\n    console.error('❌ [心形墙API] 获取项目详情失败');\r\n    console.error('🔴 错误信息:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n/**\r\n * 更新心形墙项目\r\n * @param {number|string} projectId - 项目ID\r\n * @param {Object} projectData - 项目数据\r\n * @param {string} [projectData.projectName] - 项目名称\r\n * @param {string} [projectData.description] - 项目描述\r\n * @param {boolean} [projectData.isPublic] - 是否公开\r\n * @returns {Promise<Object>} 返回更新结果\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：PUT\r\n * - 请求地址：/api/heart-wall/projects/{projectId}\r\n * - 请求头：需携带 Authorization token\r\n * - 请求参数：\r\n *   {\r\n *     \"projectName\": \"我们的恋与时光册\",\r\n *     \"description\": \"记录我们的恋与时光册\",\r\n *     \"isPublic\": true\r\n *   }\r\n */\r\nexport function updateProject(projectId, projectData) {\r\n  const url = `${config.API.HEART_WALL.PROJECT_DETAIL}/${projectId}`;\r\n  const fullUrl = config.baseURL + url;\r\n  \r\n  console.log('🔗 [心形墙API] 开始更新项目');\r\n  console.log('📍 请求地址:', fullUrl);\r\n  console.log('📋 请求方法: PUT');\r\n  console.log('📝 项目ID:', projectId);\r\n  console.log('📤 请求参数:', projectData);\r\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\r\n  \r\n  return http.put(url, projectData).then(response => {\r\n    console.log('✅ [心形墙API] 更新项目成功');\r\n    console.log('📦 响应数据:', response);\r\n    return response;\r\n  }).catch(error => {\r\n    console.error('❌ [心形墙API] 更新项目失败');\r\n    console.error('🔴 错误信息:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n/**\r\n * 删除心形墙项目\r\n * @param {number|string} projectId - 项目ID\r\n * @returns {Promise<Object>} 返回删除结果\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：DELETE\r\n * - 请求地址：/api/heart-wall/projects/{projectId}\r\n * - 请求头：需携带 Authorization token\r\n */\r\nexport function deleteProject(projectId) {\r\n  const url = `${config.API.HEART_WALL.PROJECT_DETAIL}/${projectId}`;\r\n  const fullUrl = config.baseURL + url;\r\n  \r\n  console.log('🔗 [心形墙API] 开始删除项目');\r\n  console.log('📍 请求地址:', fullUrl);\r\n  console.log('📋 请求方法: DELETE');\r\n  console.log('📝 项目ID:', projectId);\r\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\r\n  \r\n  return http.delete(url).then(response => {\r\n    console.log('✅ [心形墙API] 删除项目成功');\r\n    console.log('📦 响应数据:', response);\r\n    return response;\r\n  }).catch(error => {\r\n    console.error('❌ [心形墙API] 删除项目失败');\r\n    console.error('🔴 错误信息:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n/**\r\n * 上传照片到心形墙（使用JSON格式，需要先上传文件获取URL）\r\n * @param {Object} photoData - 照片数据\r\n * @param {number|string} photoData.projectId - 项目ID\r\n * @param {string} photoData.photoUrl - 照片URL\r\n * @param {string} photoData.thumbnailUrl - 缩略图URL\r\n * @param {number} photoData.positionIndex - 位置索引\r\n * @param {string} [photoData.caption] - 照片说明\r\n * @param {string} [photoData.takenDate] - 拍摄日期 (格式: YYYY-MM-DD)\r\n * @returns {Promise<Object>} 返回上传结果\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：POST\r\n * - 请求地址：/api/heart-wall/photos/upload\r\n * - 请求头：需携带 Authorization token\r\n * - 请求格式：application/json\r\n * - 请求参数（JSON格式）：\r\n *   {\r\n *     \"projectId\": 1,\r\n *     \"photoUrl\": \"https://example.com/photo.jpg\",\r\n *     \"thumbnailUrl\": \"https://example.com/thumb.jpg\",\r\n *     \"positionIndex\": 1,\r\n *     \"caption\": \"这是我们第一次约会\",\r\n *     \"takenDate\": \"2025-11-01\"\r\n *   }\r\n */\r\nexport function uploadPhoto(photoData) {\r\n  const url = `/api/heart-wall/photos/upload`;\r\n  const fullUrl = config.baseURL + url;\r\n  \r\n  console.log('🔗 [心形墙API] 开始上传照片（JSON格式）');\r\n  console.log('📍 请求地址:', fullUrl);\r\n  console.log('📋 请求方法: POST');\r\n  console.log('📤 请求参数:', photoData);\r\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\r\n  \r\n  return http.post(url, photoData).then(response => {\r\n    console.log('✅ [心形墙API] 上传照片成功');\r\n    console.log('📦 响应数据:', response);\r\n    \r\n    // 处理多种响应格式\r\n    if (response && response.data) {\r\n      // 格式1: { data: { photoId: ..., ... } }\r\n      console.log(`📷 照片ID: ${response.data.photoId || response.data.id || '未知'}`);\r\n      return response;\r\n    } else if (response && response.photo) {\r\n      // 格式2: { success: true, photo: { id: ..., ... }, ... }\r\n      const photo = response.photo;\r\n      console.log(`📷 照片ID: ${photo.id || photo.photoId || '未知'}`);\r\n      return { \r\n        success: true, \r\n        data: photo,\r\n        message: response.message,\r\n        photoCount: response.photoCount,\r\n        nextPosition: response.nextPosition\r\n      };\r\n    } else if (response && (response.photoId || response.id)) {\r\n      // 格式3: 直接返回照片信息 { photoId: ..., ... }\r\n      return { success: true, data: response };\r\n    } else {\r\n      // 其他格式，直接返回\r\n      return response;\r\n    }\r\n  }).catch(error => {\r\n    console.error('❌ [心形墙API] 上传照片失败');\r\n    console.error('🔴 错误信息:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n/**\r\n * 直接上传照片文件到心形墙（使用multipart/form-data格式）\r\n * 这种方式一步完成，无需先上传文件获取URL\r\n * @param {Object} options - 上传选项\r\n * @param {string} options.filePath - 本地文件路径（必需）\r\n * @param {number|string} options.projectId - 项目ID（必需）\r\n * @param {number} [options.positionIndex] - 位置索引（可选）\r\n * @param {string} [options.caption] - 照片说明（可选）\r\n * @param {string} [options.takenDate] - 拍摄日期，格式: YYYY-MM-DD（可选）\r\n * @returns {Promise<Object>} 返回上传结果\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：POST\r\n * - 请求地址：/api/heart-wall/photos/upload\r\n * - 请求头：需携带 Authorization token\r\n * - 请求格式：multipart/form-data\r\n * - 请求参数：\r\n *   - file: 文件字段（必需）\r\n *   - projectId: 项目ID（必需）\r\n *   - positionIndex: 位置索引（可选）\r\n *   - caption: 照片说明（可选）\r\n *   - takenDate: 拍摄日期（可选）\r\n */\r\nexport function uploadPhotoWithFile(options) {\r\n  const { filePath, projectId, positionIndex, caption, takenDate } = options;\r\n  \r\n  // 验证必需参数\r\n  if (!filePath) {\r\n    return Promise.reject(new Error('文件路径不能为空'));\r\n  }\r\n  if (!projectId) {\r\n    return Promise.reject(new Error('项目ID不能为空'));\r\n  }\r\n  \r\n  const url = `/api/heart-wall/photos/upload`;\r\n  const fullUrl = config.baseURL + url;\r\n  \r\n  console.log('🔗 [心形墙API] 开始直接上传照片文件');\r\n  console.log('📍 请求地址:', fullUrl);\r\n  console.log('📋 请求方法: POST (multipart/form-data)');\r\n  console.log('📁 文件路径:', filePath);\r\n  console.log('📝 项目ID:', projectId);\r\n  console.log('📍 位置索引:', positionIndex);\r\n  console.log('💬 照片说明:', caption);\r\n  console.log('📅 拍摄日期:', takenDate);\r\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\r\n  \r\n  // 构建formData\r\n  const formData = {\r\n    projectId: String(projectId)\r\n  };\r\n  \r\n  if (positionIndex !== undefined && positionIndex !== null) {\r\n    formData.positionIndex = String(positionIndex);\r\n  }\r\n  if (caption) {\r\n    formData.caption = caption;\r\n  }\r\n  if (takenDate) {\r\n    formData.takenDate = takenDate;\r\n  }\r\n  \r\n  return http.upload({\r\n    url: url,\r\n    filePath: filePath,\r\n    name: 'file',  // 后端期望的文件字段名\r\n    formData: formData\r\n  }).then(response => {\r\n    console.log('✅ [心形墙API] 直接上传照片文件成功');\r\n    console.log('📦 响应数据:', response);\r\n    \r\n    // 处理多种响应格式\r\n    if (response && response.data) {\r\n      // 格式1: { data: { photoId: ..., ... } }\r\n      console.log(`📷 照片ID: ${response.data.photoId || response.data.id || '未知'}`);\r\n      return response;\r\n    } else if (response && response.photo) {\r\n      // 格式2: { success: true, photo: { id: ..., ... }, ... }\r\n      const photo = response.photo;\r\n      console.log(`📷 照片ID: ${photo.id || photo.photoId || '未知'}`);\r\n      return { \r\n        success: true, \r\n        data: photo,\r\n        message: response.message,\r\n        photoCount: response.photoCount,\r\n        nextPosition: response.nextPosition\r\n      };\r\n    } else if (response && (response.photoId || response.id)) {\r\n      // 格式3: 直接返回照片信息 { photoId: ..., ... }\r\n      return { success: true, data: response };\r\n    } else {\r\n      // 其他格式，直接返回\r\n      return response;\r\n    }\r\n  }).catch(error => {\r\n    console.error('❌ [心形墙API] 直接上传照片文件失败');\r\n    console.error('🔴 错误信息:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n/**\r\n * 获取心形墙项目中的所有照片\r\n * @param {number|string} projectId - 项目ID\r\n * @param {Object} [options] - 查询选项\r\n * @param {number} [options.page] - 页码，默认1\r\n * @param {number} [options.pageSize] - 每页数量，默认20\r\n * @returns {Promise<Object>} 返回照片列表\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：GET\r\n * - 请求地址：/api/heart-wall/projects/{projectId}?action=photos[&page=1&pageSize=20]\r\n * - 请求头：需携带 Authorization token\r\n */\r\nexport function getProjectPhotos(projectId, options = {}) {\r\n  const { page = 1, pageSize = 20 } = options;\r\n  let url = `${config.API.HEART_WALL.PROJECT_DETAIL}/${projectId}?action=photos`;\r\n  \r\n  // 添加分页参数\r\n  if (page) {\r\n    url += `&page=${page}`;\r\n  }\r\n  if (pageSize) {\r\n    url += `&pageSize=${pageSize}`;\r\n  }\r\n  \r\n  const fullUrl = config.baseURL + url;\r\n  \r\n  console.log('🔗 [心形墙API] 开始获取项目照片列表');\r\n  console.log('📍 请求地址:', fullUrl);\r\n  console.log('📋 请求方法: GET');\r\n  console.log('📝 项目ID:', projectId);\r\n  console.log('📄 分页参数: page=', page, 'pageSize=', pageSize);\r\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\r\n  \r\n  return http.get(url).then(response => {\r\n    console.log('✅ [心形墙API] 获取项目照片列表成功');\r\n    console.log('📦 响应数据:', response);\r\n    \r\n    if (response && response.data) {\r\n      const photos = Array.isArray(response.data) ? response.data : (response.data.photos || []);\r\n      console.log(`📊 照片数量: ${photos.length}`);\r\n      return response;\r\n    } else if (Array.isArray(response)) {\r\n      // 兼容直接返回数组的情况\r\n      console.log(`📊 照片数量: ${response.length}`);\r\n      return { success: true, data: response };\r\n    } else if (response && response.photos) {\r\n      // 兼容直接返回对象包含photos字段的情况\r\n      console.log(`📊 照片数量: ${response.photos.length}`);\r\n      return { success: true, data: response.photos };\r\n    } else {\r\n      console.warn('⚠️ 响应数据格式异常:', response);\r\n      return { success: true, data: [] };\r\n    }\r\n  }).catch(error => {\r\n    console.error('❌ [心形墙API] 获取项目照片列表失败');\r\n    console.error('🔴 错误信息:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n/**\r\n * 获取下一个可用位置\r\n * @param {number|string} projectId - 项目ID\r\n * @returns {Promise<Object>} 返回下一个可用位置索引\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：GET\r\n * - 请求地址：/api/heart-wall/next-position?projectId=1\r\n * - 请求头：需携带 Authorization token\r\n */\r\nexport function getNextPosition(projectId) {\r\n  const url = `${config.API.HEART_WALL.NEXT_POSITION}?projectId=${projectId}`;\r\n  const fullUrl = config.baseURL + url;\r\n  \r\n  console.log('🔗 [心形墙API] 开始获取下一个可用位置');\r\n  console.log('📍 请求地址:', fullUrl);\r\n  console.log('📋 请求方法: GET');\r\n  console.log('📝 项目ID:', projectId);\r\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\r\n  \r\n  return http.get(url).then(response => {\r\n    console.log('✅ [心形墙API] 获取下一个可用位置成功');\r\n    console.log('📦 响应数据:', response);\r\n    \r\n    if (response && response.data) {\r\n      console.log(`📍 下一个位置索引: ${response.data.positionIndex || response.data.nextPosition || '未知'}`);\r\n      return response;\r\n    } else if (response && (response.positionIndex !== undefined || response.nextPosition !== undefined)) {\r\n      // 兼容直接返回位置信息的情况\r\n      const positionIndex = response.positionIndex || response.nextPosition;\r\n      console.log(`📍 下一个位置索引: ${positionIndex}`);\r\n      return { success: true, data: { positionIndex } };\r\n    } else {\r\n      console.warn('⚠️ 响应数据格式异常:', response);\r\n      return response;\r\n    }\r\n  }).catch(error => {\r\n    console.error('❌ [心形墙API] 获取下一个可用位置失败');\r\n    console.error('🔴 错误信息:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n/**\r\n * 更新照片信息\r\n * @param {number|string} photoId - 照片ID\r\n * @param {Object} photoData - 照片数据\r\n * @param {string} [photoData.photoUrl] - 照片URL\r\n * @param {string} [photoData.thumbnailUrl] - 缩略图URL\r\n * @param {number} [photoData.positionIndex] - 位置索引\r\n * @param {string} [photoData.caption] - 照片说明\r\n * @param {string} [photoData.takenDate] - 拍摄日期 (格式: YYYY-MM-DD)\r\n * @returns {Promise<Object>} 返回更新结果\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：PUT\r\n * - 请求地址：/api/heart-wall/photos/{photoId}\r\n * - 请求头：需携带 Authorization token\r\n * - 请求参数：\r\n *   {\r\n *     \"photoUrl\": \"https://example.com/new-photo.jpg\",\r\n *     \"thumbnailUrl\": \"https://example.com/new-thumb.jpg\",\r\n *     \"positionIndex\": 2,\r\n *     \"caption\": \"这是我们第一次约会的更新版\",\r\n *     \"takenDate\": \"2025-11-01\"\r\n *   }\r\n */\r\nexport function updatePhoto(photoId, photoData) {\r\n  const url = `/api/heart-wall/photos/${photoId}`;\r\n  const fullUrl = config.baseURL + url;\r\n  \r\n  console.log('🔗 [心形墙API] 开始更新照片');\r\n  console.log('📍 请求地址:', fullUrl);\r\n  console.log('📋 请求方法: PUT');\r\n  console.log('📷 照片ID:', photoId);\r\n  console.log('📤 请求参数:', photoData);\r\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\r\n  \r\n  return http.put(url, photoData).then(response => {\r\n    console.log('✅ [心形墙API] 更新照片成功');\r\n    console.log('📦 响应数据:', response);\r\n    return response;\r\n  }).catch(error => {\r\n    console.error('❌ [心形墙API] 更新照片失败');\r\n    console.error('🔴 错误信息:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n/**\r\n * 删除照片\r\n * @param {number|string} photoId - 照片ID\r\n * @returns {Promise<Object>} 返回删除结果\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：DELETE\r\n * - 请求地址：/api/heart-wall/photos/{photoId}\r\n * - 请求头：需携带 Authorization token\r\n */\r\nexport function deletePhoto(photoId) {\r\n  const url = `/api/heart-wall/photos/${photoId}`;\r\n  const fullUrl = config.baseURL + url;\r\n  \r\n  console.log('🔗 [心形墙API] 开始删除照片');\r\n  console.log('📍 请求地址:', fullUrl);\r\n  console.log('📋 请求方法: DELETE');\r\n  console.log('📷 照片ID:', photoId);\r\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\r\n  \r\n  return http.delete(url).then(response => {\r\n    console.log('✅ [心形墙API] 删除照片成功');\r\n    console.log('📦 响应数据:', response);\r\n    return response;\r\n  }).catch(error => {\r\n    console.error('❌ [心形墙API] 删除照片失败');\r\n    console.error('🔴 错误信息:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n/**\r\n * 清空心形墙项目中的所有照片\r\n * @param {number|string} projectId - 项目ID\r\n * @returns {Promise<Object>} 返回清空结果\r\n * \r\n * 后端接口要求：\r\n * - 请求方法：PUT\r\n * - 请求地址：/api/heart-wall/clear-photos\r\n * - 请求头：需携带 Authorization token\r\n * - 请求参数（URL参数）：projectId\r\n */\r\nexport function clearProjectPhotos(projectId) {\r\n  // 确保projectId是正确的类型\r\n  const projectIdValue = typeof projectId === 'string' ? parseInt(projectId, 10) : Number(projectId);\r\n  \r\n  // 检查projectId是否有效\r\n  if (isNaN(projectIdValue) || projectIdValue <= 0) {\r\n    const error = new Error(`无效的项目ID: ${projectId}`);\r\n    console.error('❌ [心形墙API] 项目ID验证失败:', error);\r\n    return Promise.reject(error);\r\n  }\r\n  \r\n  // 将projectId作为URL参数传递\r\n  const url = `/api/heart-wall/clear-photos?projectId=${projectIdValue}`;\r\n  const fullUrl = config.baseURL + url;\r\n  \r\n  console.log('🔗 [心形墙API] 开始清空项目照片');\r\n  console.log('📍 请求地址:', fullUrl);\r\n  console.log('📋 请求方法: PUT');\r\n  console.log('📝 项目ID:', projectId, '→', projectIdValue, '(类型: number)');\r\n  console.log('📤 URL参数: projectId=' + projectIdValue);\r\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\r\n  \r\n  // PUT请求，不传递body数据（参数已在URL中）\r\n  return http.put(url, {}).then(response => {\r\n    console.log('✅ [心形墙API] 清空项目照片成功');\r\n    console.log('📦 响应数据:', response);\r\n    return response;\r\n  }).catch(error => {\r\n    console.error('❌ [心形墙API] 清空项目照片失败');\r\n    console.error('🔴 HTTP状态码:', error.statusCode || '未知');\r\n    console.error('🔴 错误消息:', error.message || error.data?.message || '未知错误');\r\n    console.error('🔴 完整错误对象:', error);\r\n    throw error;\r\n  });\r\n}\r\n\r\n"],"names":["config","uni","http"],"mappings":";;;;AA8BO,SAAS,cAAc,aAAa;AACzC,QAAM,MAAMA,aAAM,OAAC,IAAI,WAAW;AAClC,QAAM,UAAUA,aAAAA,OAAO,UAAU;AAEjCC,gBAAAA,MAAY,MAAA,OAAA,0BAAA,oBAAoB;AAChCA,6DAAY,YAAY,OAAO;AAC/BA,gBAAAA,MAAY,MAAA,OAAA,0BAAA,eAAe;AAC3BA,gBAAY,MAAA,MAAA,OAAA,0BAAA,YAAY,WAAW;AACnCA,sBAAY,MAAA,OAAA,0BAAA,YAAW,oBAAI,KAAI,GAAG,eAAc,CAAE;AAElD,SAAOC,WAAAA,KAAK,KAAK,KAAK,WAAW,EAAE,KAAK,cAAY;AAClDD,kBAAAA,MAAY,MAAA,OAAA,0BAAA,mBAAmB;AAC/BA,kBAAY,MAAA,MAAA,OAAA,0BAAA,YAAY,QAAQ;AAEhC,QAAI,YAAY,SAAS,MAAM;AAC7BA,oBAAAA,MAAY,MAAA,OAAA,0BAAA,YAAY,SAAS,KAAK,aAAa,SAAS,KAAK,MAAM,IAAI,EAAE;AAC7EA,oBAAAA,6CAAY,YAAY,SAAS,KAAK,eAAe,IAAI,EAAE;AAC3D,aAAO;AAAA,IACb,WAAe,aAAa,SAAS,aAAa,SAAS,KAAK;AAE1D,aAAO,EAAE,SAAS,MAAM,MAAM,SAAQ;AAAA,IAC5C,OAAW;AACLA,oBAAa,MAAA,MAAA,QAAA,0BAAA,gBAAgB,QAAQ;AACrC,aAAO;AAAA,IACR;AAAA,EACL,CAAG,EAAE,MAAM,WAAS;AAChBA,kBAAAA,MAAc,MAAA,SAAA,0BAAA,mBAAmB;AACjCA,kBAAA,MAAA,MAAA,SAAA,0BAAc,YAAY,KAAK;AAC/B,UAAM;AAAA,EACV,CAAG;AACH;AAWO,SAAS,cAAc;AAC5B,QAAM,MAAMD,aAAM,OAAC,IAAI,WAAW;AAClC,QAAM,UAAUA,aAAAA,OAAO,UAAU;AAEjCC,gBAAAA,MAAY,MAAA,OAAA,0BAAA,sBAAsB;AAClCA,6DAAY,YAAY,OAAO;AAC/BA,gBAAAA,MAAY,MAAA,OAAA,0BAAA,cAAc;AAC1BA,sBAAY,MAAA,OAAA,0BAAA,YAAW,oBAAI,KAAI,GAAG,eAAc,CAAE;AAElD,SAAOC,WAAI,KAAC,IAAI,GAAG,EAAE,KAAK,cAAY;AACpCD,kBAAAA,MAAY,MAAA,OAAA,0BAAA,qBAAqB;AACjCA,kBAAY,MAAA,MAAA,OAAA,0BAAA,YAAY,QAAQ;AAEhC,QAAI,YAAY,SAAS,MAAM;AAC7B,YAAM,WAAW,MAAM,QAAQ,SAAS,IAAI,IAAI,SAAS,OAAQ,SAAS,KAAK,YAAY,CAAE;AAC7FA,iEAAY,YAAY,SAAS,MAAM,EAAE;AACzC,aAAO;AAAA,IACR,WAAU,MAAM,QAAQ,QAAQ,GAAG;AAElCA,iEAAY,YAAY,SAAS,MAAM,EAAE;AACzC,aAAO,EAAE,SAAS,MAAM,MAAM,SAAQ;AAAA,IAC5C,WAAe,YAAY,SAAS,UAAU;AAExCA,0BAAY,MAAA,OAAA,0BAAA,YAAY,SAAS,SAAS,MAAM,EAAE;AAClD,aAAO,EAAE,SAAS,MAAM,MAAM,SAAS,SAAQ;AAAA,IACrD,OAAW;AACLA,oBAAa,MAAA,MAAA,QAAA,0BAAA,gBAAgB,QAAQ;AACrC,aAAO,EAAE,SAAS,MAAM,MAAM,CAAE,EAAA;AAAA,IACjC;AAAA,EACL,CAAG,EAAE,MAAM,WAAS;AAChBA,kBAAAA,MAAc,MAAA,SAAA,2BAAA,qBAAqB;AACnCA,kBAAA,MAAA,MAAA,SAAA,2BAAc,YAAY,KAAK;AAC/B,UAAM;AAAA,EACV,CAAG;AACH;AAYO,SAAS,iBAAiB,WAAW;AAC1C,QAAM,MAAM,GAAGD,aAAAA,OAAO,IAAI,WAAW,cAAc,IAAI,SAAS;AAChE,QAAM,UAAUA,aAAAA,OAAO,UAAU;AAEjCC,gBAAAA,MAAY,MAAA,OAAA,2BAAA,sBAAsB;AAClCA,8DAAY,YAAY,OAAO;AAC/BA,gBAAAA,MAAY,MAAA,OAAA,2BAAA,cAAc;AAC1BA,gBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,SAAS;AACjCA,sBAAY,MAAA,OAAA,2BAAA,YAAW,oBAAI,KAAI,GAAG,eAAc,CAAE;AAElD,SAAOC,WAAI,KAAC,IAAI,GAAG,EAAE,KAAK,cAAY;AACpCD,kBAAAA,MAAY,MAAA,OAAA,2BAAA,qBAAqB;AACjCA,kBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,QAAQ;AAEhC,QAAI,YAAY,SAAS,MAAM;AAC7BA,oBAAAA,8CAAY,YAAY,SAAS,KAAK,eAAe,IAAI,EAAE;AAC3D,aAAO;AAAA,IACb,WAAe,aAAa,SAAS,aAAa,SAAS,KAAK;AAE1D,aAAO,EAAE,SAAS,MAAM,MAAM,SAAQ;AAAA,IAC5C,OAAW;AACLA,oBAAa,MAAA,MAAA,QAAA,2BAAA,gBAAgB,QAAQ;AACrC,aAAO;AAAA,IACR;AAAA,EACL,CAAG,EAAE,MAAM,WAAS;AAChBA,kBAAAA,MAAc,MAAA,SAAA,2BAAA,qBAAqB;AACnCA,kBAAA,MAAA,MAAA,SAAA,2BAAc,YAAY,KAAK;AAC/B,UAAM;AAAA,EACV,CAAG;AACH;AAsBO,SAAS,cAAc,WAAW,aAAa;AACpD,QAAM,MAAM,GAAGD,aAAAA,OAAO,IAAI,WAAW,cAAc,IAAI,SAAS;AAChE,QAAM,UAAUA,aAAAA,OAAO,UAAU;AAEjCC,gBAAAA,MAAY,MAAA,OAAA,2BAAA,oBAAoB;AAChCA,8DAAY,YAAY,OAAO;AAC/BA,gBAAAA,MAAY,MAAA,OAAA,2BAAA,cAAc;AAC1BA,gBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,SAAS;AACjCA,gBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,WAAW;AACnCA,sBAAY,MAAA,OAAA,2BAAA,YAAW,oBAAI,KAAI,GAAG,eAAc,CAAE;AAElD,SAAOC,WAAAA,KAAK,IAAI,KAAK,WAAW,EAAE,KAAK,cAAY;AACjDD,kBAAAA,MAAY,MAAA,OAAA,2BAAA,mBAAmB;AAC/BA,kBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,QAAQ;AAChC,WAAO;AAAA,EACX,CAAG,EAAE,MAAM,WAAS;AAChBA,kBAAAA,MAAc,MAAA,SAAA,2BAAA,mBAAmB;AACjCA,kBAAA,MAAA,MAAA,SAAA,2BAAc,YAAY,KAAK;AAC/B,UAAM;AAAA,EACV,CAAG;AACH;AAYO,SAAS,cAAc,WAAW;AACvC,QAAM,MAAM,GAAGD,aAAAA,OAAO,IAAI,WAAW,cAAc,IAAI,SAAS;AAChE,QAAM,UAAUA,aAAAA,OAAO,UAAU;AAEjCC,gBAAAA,MAAY,MAAA,OAAA,2BAAA,oBAAoB;AAChCA,8DAAY,YAAY,OAAO;AAC/BA,gBAAAA,8CAAY,iBAAiB;AAC7BA,gBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,SAAS;AACjCA,sBAAY,MAAA,OAAA,2BAAA,YAAW,oBAAI,KAAI,GAAG,eAAc,CAAE;AAElD,SAAOC,WAAI,KAAC,OAAO,GAAG,EAAE,KAAK,cAAY;AACvCD,kBAAAA,MAAY,MAAA,OAAA,2BAAA,mBAAmB;AAC/BA,kBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,QAAQ;AAChC,WAAO;AAAA,EACX,CAAG,EAAE,MAAM,WAAS;AAChBA,kBAAAA,MAAc,MAAA,SAAA,2BAAA,mBAAmB;AACjCA,kBAAA,MAAA,MAAA,SAAA,2BAAc,YAAY,KAAK;AAC/B,UAAM;AAAA,EACV,CAAG;AACH;AA+FO,SAAS,oBAAoB,SAAS;AAC3C,QAAM,EAAE,UAAU,WAAW,eAAe,SAAS,UAAW,IAAG;AAGnE,MAAI,CAAC,UAAU;AACb,WAAO,QAAQ,OAAO,IAAI,MAAM,UAAU,CAAC;AAAA,EAC5C;AACD,MAAI,CAAC,WAAW;AACd,WAAO,QAAQ,OAAO,IAAI,MAAM,UAAU,CAAC;AAAA,EAC5C;AAED,QAAM,MAAM;AACZ,QAAM,UAAUD,aAAAA,OAAO,UAAU;AAEjCC,gBAAAA,MAAA,MAAA,OAAA,2BAAY,wBAAwB;AACpCA,8DAAY,YAAY,OAAO;AAC/BA,gBAAAA,MAAY,MAAA,OAAA,2BAAA,qCAAqC;AACjDA,gBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,QAAQ;AAChCA,gBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,SAAS;AACjCA,gBAAA,MAAA,MAAA,OAAA,2BAAY,YAAY,aAAa;AACrCA,8DAAY,YAAY,OAAO;AAC/BA,gBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,SAAS;AACjCA,sBAAY,MAAA,OAAA,2BAAA,YAAW,oBAAI,KAAI,GAAG,eAAc,CAAE;AAGlD,QAAM,WAAW;AAAA,IACf,WAAW,OAAO,SAAS;AAAA,EAC/B;AAEE,MAAI,kBAAkB,UAAa,kBAAkB,MAAM;AACzD,aAAS,gBAAgB,OAAO,aAAa;AAAA,EAC9C;AACD,MAAI,SAAS;AACX,aAAS,UAAU;AAAA,EACpB;AACD,MAAI,WAAW;AACb,aAAS,YAAY;AAAA,EACtB;AAED,SAAOC,WAAAA,KAAK,OAAO;AAAA,IACjB;AAAA,IACA;AAAA,IACA,MAAM;AAAA;AAAA,IACN;AAAA,EACJ,CAAG,EAAE,KAAK,cAAY;AAClBD,kBAAAA,MAAA,MAAA,OAAA,2BAAY,uBAAuB;AACnCA,kBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,QAAQ;AAGhC,QAAI,YAAY,SAAS,MAAM;AAE7BA,oBAAAA,MAAY,MAAA,OAAA,2BAAA,YAAY,SAAS,KAAK,WAAW,SAAS,KAAK,MAAM,IAAI,EAAE;AAC3E,aAAO;AAAA,IACb,WAAe,YAAY,SAAS,OAAO;AAErC,YAAM,QAAQ,SAAS;AACvBA,oBAAAA,8CAAY,YAAY,MAAM,MAAM,MAAM,WAAW,IAAI,EAAE;AAC3D,aAAO;AAAA,QACL,SAAS;AAAA,QACT,MAAM;AAAA,QACN,SAAS,SAAS;AAAA,QAClB,YAAY,SAAS;AAAA,QACrB,cAAc,SAAS;AAAA,MAC/B;AAAA,IACA,WAAe,aAAa,SAAS,WAAW,SAAS,KAAK;AAExD,aAAO,EAAE,SAAS,MAAM,MAAM,SAAQ;AAAA,IAC5C,OAAW;AAEL,aAAO;AAAA,IACR;AAAA,EACL,CAAG,EAAE,MAAM,WAAS;AAChBA,kBAAAA,MAAA,MAAA,SAAA,2BAAc,uBAAuB;AACrCA,kBAAA,MAAA,MAAA,SAAA,2BAAc,YAAY,KAAK;AAC/B,UAAM;AAAA,EACV,CAAG;AACH;AAeO,SAAS,iBAAiB,WAAW,UAAU,IAAI;AACxD,QAAM,EAAE,OAAO,GAAG,WAAW,GAAE,IAAK;AACpC,MAAI,MAAM,GAAGD,aAAAA,OAAO,IAAI,WAAW,cAAc,IAAI,SAAS;AAG9D,MAAI,MAAM;AACR,WAAO,SAAS,IAAI;AAAA,EACrB;AACD,MAAI,UAAU;AACZ,WAAO,aAAa,QAAQ;AAAA,EAC7B;AAED,QAAM,UAAUA,aAAAA,OAAO,UAAU;AAEjCC,gBAAAA,MAAA,MAAA,OAAA,2BAAY,wBAAwB;AACpCA,8DAAY,YAAY,OAAO;AAC/BA,gBAAAA,MAAY,MAAA,OAAA,2BAAA,cAAc;AAC1BA,gBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,SAAS;AACjCA,8DAAY,kBAAkB,MAAM,aAAa,QAAQ;AACzDA,sBAAY,MAAA,OAAA,2BAAA,YAAW,oBAAI,KAAI,GAAG,eAAc,CAAE;AAElD,SAAOC,WAAI,KAAC,IAAI,GAAG,EAAE,KAAK,cAAY;AACpCD,kBAAAA,MAAA,MAAA,OAAA,2BAAY,uBAAuB;AACnCA,kBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,QAAQ;AAEhC,QAAI,YAAY,SAAS,MAAM;AAC7B,YAAM,SAAS,MAAM,QAAQ,SAAS,IAAI,IAAI,SAAS,OAAQ,SAAS,KAAK,UAAU,CAAE;AACzFA,0BAAY,MAAA,OAAA,2BAAA,YAAY,OAAO,MAAM,EAAE;AACvC,aAAO;AAAA,IACR,WAAU,MAAM,QAAQ,QAAQ,GAAG;AAElCA,kEAAY,YAAY,SAAS,MAAM,EAAE;AACzC,aAAO,EAAE,SAAS,MAAM,MAAM,SAAQ;AAAA,IAC5C,WAAe,YAAY,SAAS,QAAQ;AAEtCA,0BAAY,MAAA,OAAA,2BAAA,YAAY,SAAS,OAAO,MAAM,EAAE;AAChD,aAAO,EAAE,SAAS,MAAM,MAAM,SAAS,OAAM;AAAA,IACnD,OAAW;AACLA,oBAAa,MAAA,MAAA,QAAA,2BAAA,gBAAgB,QAAQ;AACrC,aAAO,EAAE,SAAS,MAAM,MAAM,CAAE,EAAA;AAAA,IACjC;AAAA,EACL,CAAG,EAAE,MAAM,WAAS;AAChBA,kBAAAA,MAAA,MAAA,SAAA,2BAAc,uBAAuB;AACrCA,kBAAA,MAAA,MAAA,SAAA,2BAAc,YAAY,KAAK;AAC/B,UAAM;AAAA,EACV,CAAG;AACH;AAqEO,SAAS,YAAY,SAAS,WAAW;AAC9C,QAAM,MAAM,0BAA0B,OAAO;AAC7C,QAAM,UAAUD,aAAAA,OAAO,UAAU;AAEjCC,gBAAAA,MAAY,MAAA,OAAA,2BAAA,oBAAoB;AAChCA,8DAAY,YAAY,OAAO;AAC/BA,gBAAAA,MAAY,MAAA,OAAA,2BAAA,cAAc;AAC1BA,8DAAY,YAAY,OAAO;AAC/BA,gBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,SAAS;AACjCA,sBAAY,MAAA,OAAA,2BAAA,YAAW,oBAAI,KAAI,GAAG,eAAc,CAAE;AAElD,SAAOC,WAAAA,KAAK,IAAI,KAAK,SAAS,EAAE,KAAK,cAAY;AAC/CD,kBAAAA,MAAY,MAAA,OAAA,2BAAA,mBAAmB;AAC/BA,kBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,QAAQ;AAChC,WAAO;AAAA,EACX,CAAG,EAAE,MAAM,WAAS;AAChBA,kBAAAA,MAAc,MAAA,SAAA,2BAAA,mBAAmB;AACjCA,kBAAA,MAAA,MAAA,SAAA,2BAAc,YAAY,KAAK;AAC/B,UAAM;AAAA,EACV,CAAG;AACH;AA4CO,SAAS,mBAAmB,WAAW;AAE5C,QAAM,iBAAiB,OAAO,cAAc,WAAW,SAAS,WAAW,EAAE,IAAI,OAAO,SAAS;AAGjG,MAAI,MAAM,cAAc,KAAK,kBAAkB,GAAG;AAChD,UAAM,QAAQ,IAAI,MAAM,YAAY,SAAS,EAAE;AAC/CA,kBAAA,MAAA,MAAA,SAAA,2BAAc,wBAAwB,KAAK;AAC3C,WAAO,QAAQ,OAAO,KAAK;AAAA,EAC5B;AAGD,QAAM,MAAM,0CAA0C,cAAc;AACpE,QAAM,UAAUD,aAAAA,OAAO,UAAU;AAEjCC,gBAAAA,MAAY,MAAA,OAAA,2BAAA,sBAAsB;AAClCA,8DAAY,YAAY,OAAO;AAC/BA,gBAAAA,MAAY,MAAA,OAAA,2BAAA,cAAc;AAC1BA,sBAAA,MAAA,OAAA,2BAAY,YAAY,WAAW,KAAK,gBAAgB,cAAc;AACtEA,gBAAY,MAAA,MAAA,OAAA,2BAAA,yBAAyB,cAAc;AACnDA,sBAAY,MAAA,OAAA,2BAAA,YAAW,oBAAI,KAAI,GAAG,eAAc,CAAE;AAGlD,SAAOC,WAAAA,KAAK,IAAI,KAAK,CAAA,CAAE,EAAE,KAAK,cAAY;AACxCD,kBAAAA,MAAY,MAAA,OAAA,2BAAA,qBAAqB;AACjCA,kBAAY,MAAA,MAAA,OAAA,2BAAA,YAAY,QAAQ;AAChC,WAAO;AAAA,EACX,CAAG,EAAE,MAAM,WAAS;;AAChBA,kBAAAA,MAAc,MAAA,SAAA,2BAAA,qBAAqB;AACnCA,wBAAA,MAAA,SAAA,2BAAc,eAAe,MAAM,cAAc,IAAI;AACrDA,kBAAAA,MAAA,MAAA,SAAA,2BAAc,YAAY,MAAM,aAAW,WAAM,SAAN,mBAAY,YAAW,MAAM;AACxEA,kBAAc,MAAA,MAAA,SAAA,2BAAA,cAAc,KAAK;AACjC,UAAM;AAAA,EACV,CAAG;AACH;;;;;;;;;;"}