{"version":3,"file":"couple.js","sources":["api/couple.js"],"sourcesContent":["/**\n * 情侣关系 API\n * 对接后端接口文档：情侣关系绑定API\n */\n\nimport http from '../utils/http.js';\nimport config from '../utils/config.js';\nimport { getUserInfo as getUserInfoFromAuth } from '../utils/auth.js';\nimport { getUserInfo as getUserInfoFromAPI } from './login.js';\n\nfunction isMsgCodeSuccess(response) {\n  return (\n    response &&\n    typeof response === 'object' &&\n    response.code === 200 &&\n    ('msg' in response || 'message' in response)\n  );\n}\n\nfunction getResponseMessage(response, fallbackText = '') {\n  if (!response || typeof response !== 'object') {\n    return fallbackText;\n  }\n  return response.msg || response.message || fallbackText;\n}\n\n/**\n * 获取当前用户ID\n * @returns {Promise<string>} 返回用户ID\n */\nasync function getCurrentUserId() {\n  try {\n    console.log('🔍 [获取用户ID] 开始尝试获取用户ID...');\n    \n    // 方法1: 从本地登录信息中获取\n    const userInfo = getUserInfoFromAuth();\n    console.log('🔍 [方法1] 从auth.js获取用户信息:', userInfo);\n    if (userInfo && userInfo.userId) {\n      console.log('✅ [方法1] 成功获取userId:', userInfo.userId);\n      return userInfo.userId;\n    }\n    \n    // 方法2: 从登录信息中查找userId\n    const loginInfo = uni.getStorageSync('login_info');\n    console.log('🔍 [方法2] 从登录信息获取:', loginInfo ? '找到登录信息' : '未找到登录信息');\n    if (loginInfo) {\n      console.log('🔍 [方法2] 登录信息完整结构:', JSON.stringify(loginInfo, null, 2));\n      \n      // 尝试多个可能的字段名\n      if (loginInfo.userId) {\n        console.log('✅ [方法2] 从loginInfo.userId获取:', loginInfo.userId);\n        return loginInfo.userId;\n      }\n      if (loginInfo.userInfo && loginInfo.userInfo.userId) {\n        console.log('✅ [方法2] 从loginInfo.userInfo.userId获取:', loginInfo.userInfo.userId);\n        return loginInfo.userInfo.userId;\n      }\n      if (loginInfo.data && loginInfo.data.userId) {\n        console.log('✅ [方法2] 从loginInfo.data.userId获取:', loginInfo.data.userId);\n        return loginInfo.data.userId;\n      }\n      // 尝试openid作为userId（微信小程序场景）\n      if (loginInfo.openid) {\n        console.log('✅ [方法2] 使用openid作为userId:', loginInfo.openid);\n        return loginInfo.openid;\n      }\n    }\n    \n    // 方法3: 调用API获取用户信息\n    console.log('🔍 [方法3] 尝试调用用户信息API...');\n    try {\n      const response = await getUserInfoFromAPI();\n      console.log('🔍 [方法3] API响应:', response);\n      if (response && response.success && response.data && response.data.userId) {\n        console.log('✅ [方法3] 从API获取userId:', response.data.userId);\n        // 保存userId到本地登录信息\n        if (loginInfo) {\n          if (!loginInfo.userInfo) {\n            loginInfo.userInfo = {};\n          }\n          loginInfo.userInfo.userId = response.data.userId;\n          uni.setStorageSync('login_info', loginInfo);\n          console.log('💾 [方法3] 已保存userId到本地存储');\n        }\n        return response.data.userId;\n      } else {\n        console.warn('⚠️ [方法3] API响应中没有userId:', response);\n      }\n    } catch (apiError) {\n      console.warn('⚠️ [方法3] 调用用户信息API失败:', apiError);\n    }\n    \n    // 方法4: 从token中解析（如果是JWT）\n    if (loginInfo && loginInfo.token) {\n      console.log('🔍 [方法4] 尝试从token解析userId...');\n      try {\n        const tokenParts = loginInfo.token.split('.');\n        console.log('🔍 [方法4] Token分段数量:', tokenParts.length);\n        if (tokenParts.length === 3) {\n          // uni-app兼容的base64解码\n          let base64Payload = tokenParts[1];\n          // 处理base64 padding\n          base64Payload = base64Payload.replace(/-/g, '+').replace(/_/g, '/');\n          while (base64Payload.length % 4) {\n            base64Payload += '=';\n          }\n          \n          // 使用uni-app的base64解码或原生方法\n          let decodedPayload;\n          try {\n            if (typeof uni !== 'undefined' && uni.base64ToArrayBuffer) {\n              // uni-app方式\n              const arrayBuffer = uni.base64ToArrayBuffer(base64Payload);\n              decodedPayload = String.fromCharCode.apply(null, new Uint8Array(arrayBuffer));\n            } else {\n              // 浏览器方式（H5环境）\n              decodedPayload = decodeURIComponent(atob(base64Payload));\n            }\n            \n            const payload = JSON.parse(decodedPayload);\n            console.log('🔍 [方法4] Token payload:', payload);\n            if (payload.userId || payload.uid || payload.user_id) {\n              const userId = payload.userId || payload.uid || payload.user_id;\n              console.log('✅ [方法4] 从token解析userId:', userId);\n              return userId;\n            } else {\n              console.warn('⚠️ [方法4] Token payload中没有userId字段');\n            }\n          } catch (decodeError) {\n            console.warn('⚠️ [方法4] Token解码失败:', decodeError);\n            // 如果token不是标准JWT格式，尝试直接使用openid\n            if (loginInfo.openid) {\n              console.log('✅ [方法4] 使用openid作为userId:', loginInfo.openid);\n              return loginInfo.openid;\n            }\n          }\n        } else {\n          console.warn('⚠️ [方法4] Token格式不正确，不是JWT格式');\n          // 如果token不是JWT格式，尝试直接使用openid\n          if (loginInfo.openid) {\n            console.log('✅ [方法4] 使用openid作为userId:', loginInfo.openid);\n            return loginInfo.openid;\n          }\n        }\n      } catch (e) {\n        console.warn('⚠️ [方法4] 从token解析userId失败:', e);\n      }\n    } else {\n      console.warn('⚠️ [方法4] 登录信息中没有token');\n    }\n    \n    // 所有方法都失败\n    console.error('❌ [获取用户ID] 所有方法都失败，无法获取用户ID');\n    console.error('❌ [登录信息]', loginInfo);\n    throw new Error('无法获取用户ID，请先登录');\n  } catch (error) {\n    console.error('❌ [获取用户ID] 异常:', error);\n    throw error;\n  }\n}\n\n/**\n * 生成邀请码\n * @returns {Promise<Object>} 返回邀请码信息\n * \n * 后端接口要求：\n * - 请求方法：POST\n * - 请求地址：/api/couple/invite/create\n * - 请求头：需携带 Authorization token\n * - 请求参数：\n *   {\n *     userId: \"user_123\"\n *   }\n * - 返回数据格式：\n *   {\n *     success: true,\n *     message: \"邀请码生成成功\",\n *     data: {\n *       inviteCode: \"ABC123\",\n *       expireAt: \"2024-01-16T10:30:00Z\"\n *     }\n *   }\n */\nexport function createInviteCode() {\n  const url = config.API.COUPLE.INVITE_CREATE;\n  const fullUrl = config.baseURL + url;\n  \n  console.log('🔗 [情侣关系API] 开始生成邀请码');\n  console.log('📍 请求地址:', fullUrl);\n  console.log('📋 请求方法: POST');\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\n  \n  // 先获取userId，然后发送请求\n  return getCurrentUserId().then(userId => {\n    console.log('👤 用户ID:', userId);\n    console.log('📤 请求参数: { userId:', userId, '}');\n    \n    return http.post(url, { userId }).then(response => {\n      console.log('✅ [情侣关系API] 生成邀请码成功');\n      console.log('📦 响应数据:', response);\n      \n      // 先检查响应码，如果是错误码（非200），应该抛出错误（特别是401认证失败）\n      if (response && typeof response === 'object' && response.code !== undefined && response.code !== 200) {\n        const errorMsg = response.msg || response.message || '请求失败';\n        console.error('❌ [情侣关系API] 后端返回错误码:', response.code);\n        console.error('❌ 错误信息:', errorMsg);\n        // 对于401认证失败等严重错误，直接抛出错误\n        if (response.code === 401 || response.code === 403) {\n          throw new Error(errorMsg);\n        }\n        // 其他错误码（如业务错误）返回失败状态\n        return {\n          success: false,\n          message: errorMsg,\n          data: { inviteCode: '', expireAt: '' },\n          code: response.code\n        };\n      }\n      \n      const normalizedMessage = getResponseMessage(response, '邀请码生成成功');\n\n      if (isMsgCodeSuccess(response)) {\n        const responseData = response?.data;\n        const inviteCode =\n          typeof responseData === 'string'\n            ? responseData\n            : responseData?.inviteCode || responseData?.code || '';\n        const expireAt =\n          (typeof responseData === 'object' && responseData?.expireAt) ||\n          response?.expireAt ||\n          response?.data?.expireAt ||\n          '';\n\n        console.log(`📝 邀请码: ${inviteCode}`);\n        return {\n          success: true,\n          message: normalizedMessage,\n          data: {\n            inviteCode,\n            expireAt\n          }\n        };\n      }\n      \n      // 新格式：{ \"msg\": \"邀请码生成成功\", \"code\": 200, \"data\": \"U9441L\" }\n      // data 是字符串，直接是邀请码\n      if (response && response.data && typeof response.data === 'string') {\n        const inviteCode = response.data;\n        console.log(`📝 邀请码: ${inviteCode}`);\n        // 统一转换为标准格式\n        return {\n          success: response.code === 200 || response.success !== false,\n          message: normalizedMessage,\n          data: {\n            inviteCode: inviteCode,\n            expireAt: response.expireAt || '' // 如果后端返回过期时间\n          }\n        };\n      }\n      // 兼容旧格式：response.data.inviteCode（对象格式）\n      else if (response && response.data && response.data.inviteCode) {\n        console.log(`📝 邀请码: ${response.data.inviteCode}`);\n        console.log(`⏰ 过期时间: ${response.data.expireAt}`);\n        return {\n          ...response,\n          message: getResponseMessage(response, '邀请码生成成功')\n        };\n      }\n      // 兼容后端返回格式：response.invitation\n      else if (response && response.invitation) {\n        const invitation = response.invitation;\n        console.log(`📝 邀请码: ${invitation.inviteCode || invitation.code || ''}`);\n        console.log(`⏰ 过期时间: ${invitation.expireAt || invitation.expireTime || ''}`);\n        // 统一转换为标准格式\n        return {\n          success: response.success !== false,\n          message: normalizedMessage,\n          data: {\n            inviteCode: invitation.inviteCode || invitation.code || '',\n            expireAt: invitation.expireAt || invitation.expireTime || ''\n          },\n          isBound: response.isBound || false\n        };\n      }\n      // 兼容直接返回邀请码的情况\n      else if (response && (response.inviteCode || response.code)) {\n        console.log(`📝 邀请码: ${response.inviteCode || response.code}`);\n        return {\n          success: response.success !== false,\n          message: normalizedMessage,\n          data: {\n            inviteCode: response.inviteCode || response.code || '',\n            expireAt: response.expireAt || response.expireTime || ''\n          }\n        };\n      }\n      // 数据格式异常\n      else {\n        console.warn('⚠️ 响应数据格式异常:', response);\n        return {\n          success: response.code === 200 || response.success !== false,\n          message: normalizedMessage || '生成成功',\n          data: { inviteCode: '', expireAt: '' }\n        };\n      }\n    });\n  }).catch(error => {\n    console.error('❌ [情侣关系API] 生成邀请码失败');\n    console.error('🔴 错误信息:', error);\n    throw error;\n  });\n}\n\n/**\n * 验证邀请码\n * @param {string} inviteCode - 邀请码\n * @returns {Promise<Object>} 返回邀请码验证结果和发起方信息\n * \n * 后端接口要求：\n * - 请求方法：GET\n * - 请求地址：/api/couple/invite/validate?code=ABC123\n * - 请求头：需携带 Authorization token\n * - 返回数据格式：\n *   {\n *     success: true,\n *     message: \"邀请码有效\",\n *     data: {\n *       code: \"ABC123\",\n *       creator: {\n *         userId: \"user_123\",\n *         nickName: \"用户昵称\",\n *         avatarUrl: \"头像URL\",\n *         displayName: \"显示昵称\",\n *         displayAvatar: \"显示头像\"\n *       },\n *       expireAt: \"2024-01-16T10:30:00Z\"\n *     }\n *   }\n */\nexport function validateInviteCode(inviteCode) {\n  const url = config.API.COUPLE.INVITE_VALIDATE + '?code=' + encodeURIComponent(inviteCode);\n  const fullUrl = config.baseURL + url;\n  \n  console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n  console.log('🔗 [情侣关系API] 开始验证邀请码');\n  console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n  console.log('📍 [请求地址]', fullUrl);\n  console.log('📋 [请求方法] GET');\n  console.log('📝 [原始邀请码]', inviteCode);\n  console.log('📝 [邀请码类型]', typeof inviteCode);\n  console.log('📝 [邀请码长度]', inviteCode ? inviteCode.length : 0);\n  console.log('📝 [URL编码后邀请码]', encodeURIComponent(inviteCode));\n  console.log('📝 [完整URL参数]', 'code=' + encodeURIComponent(inviteCode));\n  console.log('⏰ [请求时间]', new Date().toLocaleString());\n  console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n  \n  return http.get(url).then(response => {\n    console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n    console.log('✅ [情侣关系API] 验证邀请码成功');\n    console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n    console.log('📦 [响应数据类型]', typeof response);\n    console.log('📦 [完整响应数据]', JSON.stringify(response, null, 2));\n    \n    if (response && typeof response === 'object') {\n      console.log('📦 [响应数据字段列表]', Object.keys(response).join(', '));\n    }\n    \n    // 先检查响应码，如果是错误码（非200），应该抛出错误（特别是401认证失败）\n    if (response && typeof response === 'object' && response.code !== undefined && response.code !== 200) {\n      const errorMsg = response.msg || response.message || '请求失败';\n      console.error('❌ [情侣关系API] 后端返回错误码:', response.code);\n      console.error('❌ 错误信息:', errorMsg);\n      // 对于401认证失败等严重错误，直接抛出错误\n      if (response.code === 401 || response.code === 403) {\n        throw new Error(errorMsg);\n      }\n      // 其他错误码（如业务错误）返回失败状态\n      return {\n        success: false,\n        message: errorMsg,\n        data: null,\n        code: response.code\n      };\n    }\n    \n    // 兼容仅返回 msg/code 的新格式\n    const hasMsgCodeFormat = response && typeof response === 'object' && 'code' in response && (response.msg || response.message);\n    if (hasMsgCodeFormat) {\n      if (isMsgCodeSuccess(response)) {\n        const normalizedResponse = {\n          success: true,\n          message: getResponseMessage(response, '邀请码有效'),\n          data: null\n        };\n\n        if (response.data && typeof response.data === 'object') {\n          normalizedResponse.data = {\n            code: response.data.code || inviteCode,\n            creator: response.data.creator || response.creator || null,\n            expireAt: response.data.expireAt || response.expireAt || null\n          };\n        } else {\n          normalizedResponse.data = {\n            code: inviteCode,\n            creator: response.creator || null,\n            expireAt: response.expireAt || null\n          };\n        }\n\n        console.log('✅ [情侣关系API] msg/code格式响应，已转换为标准结构');\n        console.log('📦 [转换后的数据]', JSON.stringify(normalizedResponse, null, 2));\n        return normalizedResponse;\n      }\n\n      console.warn('⚠️ [情侣关系API] msg/code格式响应但 code 非200，视为失败');\n      return {\n        success: false,\n        message: getResponseMessage(response, '邀请码验证失败'),\n        data: null,\n        code: response.code\n      };\n    }\n\n    // 处理标准格式：response.data.creator\n    if (response && response.data && response.data.creator) {\n      console.log(`📝 [返回的邀请码] ${response.data.code || inviteCode}`);\n      console.log(`👤 [发起方昵称] ${response.data.creator?.nickName || '未知'}`);\n      console.log(`👤 [发起方ID] ${response.data.creator?.id || '未知'}`);\n      console.log(`⏰ [过期时间] ${response.data.expireAt || '未知'}`);\n      if (response.data.creator) {\n        console.log('👤 [发起方完整信息]', JSON.stringify(response.data.creator, null, 2));\n      }\n      return response;\n    }\n    \n    // 处理直接返回 creator 的情况\n    if (response && response.creator) {\n      console.log(`👤 [发起方昵称] ${response.creator?.nickName || '未知'}`);\n      console.log(`👤 [发起方ID] ${response.creator?.id || '未知'}`);\n      return { success: true, data: response };\n    }\n    \n    // 处理新格式：inviterNickName, inviterId, inviterAvatarUrl\n    if (response && (response.inviterNickName || response.inviterId)) {\n      console.log(`👤 [发起方昵称] ${response.inviterNickName || '未知'}`);\n      console.log(`👤 [发起方ID] ${response.inviterId || '未知'}`);\n      console.log(`🖼️ [发起方头像] ${response.inviterAvatarUrl || '未知'}`);\n      \n      // 转换为统一格式\n      const normalizedResponse = {\n        success: response.success !== undefined ? response.success : true,\n        message: getResponseMessage(response, '邀请码有效'),\n        data: {\n          code: inviteCode,\n          creator: {\n            id: response.inviterId,\n            nickName: response.inviterNickName,\n            avatarUrl: response.inviterAvatarUrl\n          },\n          expireAt: response.expireAt || null\n        }\n      };\n      \n      console.log('✅ [数据格式转换] 已将新格式转换为标准格式');\n      console.log('📦 [转换后的数据]', JSON.stringify(normalizedResponse, null, 2));\n      return normalizedResponse;\n    }\n    \n    // 如果都不匹配，返回错误\n    console.warn('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n    console.warn('⚠️ [情侣关系API] 响应数据格式异常');\n    console.warn('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n    console.warn('📦 [响应数据]', response);\n    console.warn('📦 [响应数据类型]', typeof response);\n    if (response && typeof response === 'object') {\n      console.warn('📦 [响应数据字段]', Object.keys(response).join(', '));\n    }\n    console.warn('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n    return { success: false, message: getResponseMessage(response, '邀请码验证失败') };\n  }).catch(error => {\n    console.error('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n    console.error('❌ [情侣关系API] 验证邀请码失败');\n    console.error('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n    console.error('📝 [输入的邀请码]', inviteCode);\n    console.error('📝 [邀请码类型]', typeof inviteCode);\n    console.error('📝 [邀请码长度]', inviteCode ? inviteCode.length : 0);\n    console.error('🔴 [错误对象]', error);\n    console.error('🔴 [错误类型]', typeof error);\n    console.error('🔴 [错误消息]', error?.message);\n    console.error('🔴 [错误状态码]', error?.statusCode);\n    console.error('🔴 [错误数据]', error?.data);\n    console.error('🔴 [错误响应数据]', error?.responseData);\n    if (error && typeof error === 'object') {\n      console.error('🔴 [错误对象字段列表]', Object.keys(error).join(', '));\n    }\n    if (error?.stack) {\n      console.error('🔴 [错误堆栈]', error.stack);\n    }\n    console.error('⏰ [错误时间]', new Date().toLocaleString());\n    console.error('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');\n    throw error;\n  });\n}\n\n/**\n * 接受邀请（建立情侣关系）\n * @param {string} inviteCode - 邀请码\n * @returns {Promise<Object>} 返回绑定结果\n * \n * 后端接口要求：\n * - 请求方法：POST\n * - 请求地址：/api/couple/bind/accept\n * - 请求头：需携带 Authorization token\n * - 请求参数：\n *   {\n *     inviteCode: \"邀请码\",\n *     userId: \"被邀请用户ID\"\n *   }\n * - 返回数据格式：\n *   {\n *     \"msg\": \"邀请成功\",\n *     \"code\": 200,\n *     \"data\": {\n *       // 邀请人信息\n *     }\n *   }\n */\nexport function acceptInvite(inviteCode) {\n  const url = config.API.COUPLE.BIND_ACCEPT;\n  const fullUrl = config.baseURL + url;\n  \n  console.log('🔗 [情侣关系API] 开始接受邀请');\n  console.log('📍 请求地址:', fullUrl);\n  console.log('📋 请求方法: POST');\n  console.log('📝 邀请码:', inviteCode);\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\n  \n  // 先获取userId，然后发送请求\n  return getCurrentUserId().then(userId => {\n    console.log('👤 被邀请用户ID:', userId);\n    console.log('📤 请求参数: { inviteCode:', inviteCode, ', userId:', userId, '}');\n    \n    return http.post(url, { inviteCode, userId }).then(response => {\n      console.log('✅ [情侣关系API] 接受邀请成功');\n      console.log('📦 响应数据:', response);\n      \n      // 先检查响应码，如果是错误码（非200），应该抛出错误（特别是401认证失败）\n      if (response && typeof response === 'object' && response.code !== undefined && response.code !== 200) {\n        const errorMsg = response.msg || response.message || '请求失败';\n        console.error('❌ [情侣关系API] 后端返回错误码:', response.code);\n        console.error('❌ 错误信息:', errorMsg);\n        // 对于401认证失败等严重错误，直接抛出错误\n        if (response.code === 401 || response.code === 403) {\n          throw new Error(errorMsg);\n        }\n        // 其他错误码（如业务错误）返回失败状态\n        return {\n          success: false,\n          message: errorMsg,\n          data: null,\n          code: response.code\n        };\n      }\n      \n      const normalizedMessage = getResponseMessage(response, '邀请成功');\n      \n      if (isMsgCodeSuccess(response)) {\n        const inviteData = response?.data || {};\n        console.log('👤 邀请人信息:', inviteData);\n        \n        return {\n          success: true,\n          message: normalizedMessage,\n          data: {\n            coupleId: inviteData.coupleId || '',\n            partnerInfo: inviteData.partnerInfo || inviteData || {},\n            bindTime: inviteData.bindTime || new Date().toISOString()\n          }\n        };\n      }\n      \n      // 新格式：{ \"msg\": \"邀请成功\", \"code\": 200, \"data\": { // 邀请人信息 } }\n      if (response && response.code === 200 && response.data) {\n        // 如果 data 是邀请人信息对象，转换为标准格式\n        const inviteData = response.data;\n        console.log(`👤 邀请人信息:`, inviteData);\n        \n        // 转换为标准格式，兼容页面期望的数据结构\n        return {\n          success: true,\n          message: normalizedMessage,\n          data: {\n            coupleId: inviteData.coupleId || '',\n            partnerInfo: inviteData.partnerInfo || inviteData || {},\n            bindTime: inviteData.bindTime || new Date().toISOString()\n          }\n        };\n      }\n      // 兼容旧格式：response.data 包含 coupleId 和 partnerInfo\n      else if (response && response.data) {\n        console.log(`💑 关系ID: ${response.data.coupleId || '未知'}`);\n        console.log(`👤 对方昵称: ${response.data.partnerInfo?.nickName || '未知'}`);\n        return response;\n      }\n      // 兼容直接返回关系信息的情况\n      else if (response && response.coupleId) {\n        console.log(`💑 关系ID: ${response.coupleId}`);\n        return { success: true, data: response };\n      }\n      // 其他格式\n      else {\n        console.warn('⚠️ 响应数据格式异常:', response);\n        return {\n          success: response.code === 200 || response.success !== false,\n          message: normalizedMessage || '邀请成功',\n          data: response.data || {}\n        };\n      }\n    });\n  }).catch(error => {\n    console.error('❌ [情侣关系API] 接受邀请失败');\n    console.error('🔴 错误信息:', error);\n    throw error;\n  });\n}\n\n/**\n * 查询绑定状态\n * @returns {Promise<Object>} 返回绑定状态信息\n * \n * 后端接口要求：\n * - 请求方法：GET\n * - 请求地址：/api/couple/status\n * - 请求头：需携带 Authorization token\n * - 返回数据格式：\n *   {\n *     success: true,\n *     data: {\n *       isBound: true,\n *       coupleId: \"couple_123456\",\n *       partnerInfo: {\n *         userId: \"user_789\",\n *         nickName: \"对方昵称\",\n *         avatarUrl: \"头像URL\",\n *         displayName: \"显示昵称\",\n *         displayAvatar: \"显示头像\"\n *       },\n *       bindTime: \"2024-01-15T10:30:00Z\",\n *       role: \"initiator\"\n *     }\n *   }\n */\nexport function getCoupleStatus() {\n  const url = config.API.COUPLE.STATUS;\n  const fullUrl = config.baseURL + url;\n  \n  console.log('🔗 [情侣关系API] 开始查询绑定状态');\n  console.log('📍 请求地址:', fullUrl);\n  console.log('📋 请求方法: GET');\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\n  \n  return http.get(url).then(response => {\n    console.log('✅ [情侣关系API] 查询绑定状态成功');\n    console.log('📦 响应数据:', response);\n    \n    // 先检查响应码，如果是错误码（非200），应该抛出错误\n    if (response && typeof response === 'object' && response.code !== undefined && response.code !== 200) {\n      const errorMsg = response.msg || response.message || '请求失败';\n      console.error('❌ [情侣关系API] 后端返回错误码:', response.code);\n      console.error('❌ 错误信息:', errorMsg);\n      throw new Error(errorMsg);\n    }\n    \n    if (response && response.data) {\n      const status = response.data;\n      console.log('📊 绑定状态:');\n      console.log(`   - 是否已绑定: ${status.isBound ? '是' : '否'}`);\n      if (status.isBound) {\n        console.log(`   - 关系ID: ${status.coupleId}`);\n        console.log(`   - 对方昵称: ${status.partnerInfo?.nickName || '未知'}`);\n        console.log(`   - 绑定时间: ${status.bindTime || '未知'}`);\n      }\n      return response;\n    } else if (response && (response.isBound !== undefined || response.coupleId)) {\n      // 兼容直接返回状态的情况\n      return { success: true, data: response };\n    } else if (response && (response.isCouple !== undefined)) {\n      // 兼容后端返回 isCouple 字段的情况\n      console.log('📊 绑定状态:');\n      console.log(`   - 是否已绑定: ${response.isCouple ? '是' : '否'}`);\n      return {\n        success: response.success !== false,\n        message: response.message || '查询成功',\n        data: {\n          isBound: response.isCouple,\n          coupleId: response.coupleId || null,\n          partnerInfo: response.partnerInfo || null,\n          bindTime: response.bindTime || null,\n          role: response.role || null\n        }\n      };\n    } else if (response && response.msg && (response.msg.includes('未找到情侣关系') || response.msg.includes('没有情侣关系') || response.msg.includes('未绑定'))) {\n      // 兼容后端返回 {msg: \"未找到情侣关系\", code: 200} 的格式\n      // 这是正常的业务状态（未绑定），不是错误\n      console.log('📊 绑定状态: 未绑定（后端返回未找到情侣关系）');\n      return {\n        success: true,\n        message: response.msg || '未找到情侣关系',\n        data: {\n          isBound: false,\n          coupleId: null,\n          partnerInfo: null,\n          bindTime: null,\n          role: null\n        }\n      };\n    } else {\n      console.warn('⚠️ 响应数据格式异常:', response);\n      return { success: true, data: { isBound: false } };\n    }\n  }).catch(error => {\n    console.error('❌ [情侣关系API] 查询绑定状态失败');\n    console.error('🔴 错误信息:', error);\n    throw error;\n  });\n}\n\n/**\n * 解绑关系\n * @returns {Promise<Object>} 返回解绑结果\n * \n * 后端接口要求：\n * - 请求方法：POST\n * - 请求地址：/api/couple/unbind\n * - 请求头：需携带 Authorization token\n * - 返回数据格式：\n *   {\n *     success: true,\n *     message: \"解绑成功\"\n *   }\n */\nexport function unbindCouple() {\n  const url = config.API.COUPLE.UNBIND;\n  const fullUrl = config.baseURL + url;\n  \n  console.log('🔗 [情侣关系API] 开始解绑关系');\n  console.log('📍 请求地址:', fullUrl);\n  console.log('📋 请求方法: POST');\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\n  \n  return http.post(url).then(response => {\n    console.log('✅ [情侣关系API] 解绑关系成功');\n    console.log('📦 响应数据:', response);\n    return response;\n  }).catch(error => {\n    // 如果错误消息是\"没有情侣关系\"，说明已经达到解绑的目的（没有关系可解）\n    // 这种情况可以视为成功，因为目标就是解除关系\n    const errorMessage = error.message || (error.data && error.data.message) || '';\n    \n    if (errorMessage.includes('没有情侣关系') || errorMessage.includes('未绑定') || errorMessage.includes('不存在')) {\n      console.warn('⚠️ [情侣关系API] 解绑时检测到\"没有情侣关系\"，视为成功');\n      console.warn('💡 说明：没有关系可解，目标已达成');\n      return {\n        success: true,\n        message: '已解除关系（原本没有情侣关系）',\n        data: null\n      };\n    }\n    \n    console.error('❌ [情侣关系API] 解绑关系失败');\n    console.error('🔴 错误信息:', error);\n    throw error;\n  });\n}\n\n/**\n * 获取相爱天数\n * @returns {Promise<Object>} 返回相爱天数信息\n * \n * 后端接口要求：\n * - 请求方法：GET\n * - 请求地址：/api/couple/love-days\n * - 请求头：需携带 Authorization token\n * - 返回数据格式：\n *   {\n *     success: true,\n *     message: \"获取相爱天数成功\",\n *     data: {\n *       loveDays: 150,\n *       anniversaryDate: \"2025-06-10\",\n *       relationshipName: \"我的宝贝\"\n *     }\n *   }\n */\nexport function getLoveDays() {\n  const url = config.API.COUPLE.LOVE_DAYS;\n  const fullUrl = config.baseURL + url;\n  \n  console.log('🔗 [情侣关系API] 开始获取相爱天数');\n  console.log('📍 请求地址:', fullUrl);\n  console.log('📋 请求方法: GET');\n  console.log('⏰ 请求时间:', new Date().toLocaleString());\n  \n  return http.get(url).then(response => {\n    console.log('✅ [情侣关系API] 获取相爱天数成功');\n    console.log('📦 响应数据:', response);\n    \n    if (response && response.data) {\n      const loveDaysData = response.data;\n      console.log('📊 相爱天数信息:');\n      console.log(`   - 相爱天数: ${loveDaysData.loveDays || '未知'}`);\n      console.log(`   - 纪念日: ${loveDaysData.anniversaryDate || '未知'}`);\n      console.log(`   - 关系名称: ${loveDaysData.relationshipName || '未知'}`);\n      return response;\n    } else if (response && (response.loveDays !== undefined || response.anniversaryDate)) {\n      // 兼容直接返回数据的情况\n      return { success: true, data: response };\n    } else {\n      console.warn('⚠️ 响应数据格式异常:', response);\n      return response;\n    }\n  }).catch(error => {\n    console.error('❌ [情侣关系API] 获取相爱天数失败');\n    console.error('🔴 错误信息:', error);\n    throw error;\n  });\n}\n\n"],"names":["uni","getUserInfoFromAuth","getUserInfoFromAPI","config","http"],"mappings":"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"}