{"version":3,"file":"index.js","sources":["pages/invite/index.vue","D:/softcaree/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW52aXRlL2luZGV4LnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"invite-page\" :style=\"{ paddingTop: containerPaddingTop }\">\r\n    <!-- Ëá™ÂÆö‰πâÂØºËà™Ê†è -->\r\n    <view class=\"custom-navbar\">\r\n      <!-- Ê∏êÂèòËÉåÊôØ -->\r\n      <view class=\"navbar-gradient-bg\"></view>\r\n      <!-- Áä∂ÊÄÅÊ†èÂç†‰Ωç -->\r\n      <view class=\"status-bar\" :style=\"{ height: statusBarHeight + 'px' }\"></view>\r\n      <!-- ÂØºËà™Ê†èÂÜÖÂÆπ -->\r\n      <view class=\"navbar-content\" :style=\"{ height: navBarHeight + 'px' }\">\r\n        <view class=\"navbar-left\" @click=\"goBack\">\r\n          <text class=\"back-icon\">‚Üê</text>\r\n        </view>\r\n        <view class=\"navbar-title\">\r\n          <text class=\"title-text\">{{ isInviteMode ? 'Êé•ÂèóÈÇÄËØ∑' : 'ÈÇÄËØ∑Âè¶‰∏ÄÂçä' }}</text>\r\n        </view>\r\n        <view class=\"navbar-right\"></view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- ÂÜÖÂÆπÂå∫Âüü -->\r\n    <view class=\"content-area\">\r\n      <!-- Êé•ÂèóÈÇÄËØ∑Ê®°ÂºèÔºöÊòæÁ§∫ÈÇÄËØ∑Êñπ‰ø°ÊÅØ -->\r\n      <view v-if=\"isInviteMode\" class=\"invite-container\">\r\n        <view class=\"invite-header\">\r\n          <text class=\"invite-title\">üíï Êî∂Âà∞ÈÇÄËØ∑</text>\r\n          <text class=\"invite-subtitle\">{{ creatorInfo.nickName || 'Â•ΩÂèã' }} ÈÇÄËØ∑‰Ω†Êàê‰∏∫ÊÉÖ‰æ£</text>\r\n        </view>\r\n\r\n        <!-- ÈÇÄËØ∑Êñπ‰ø°ÊÅØÂç°Áâá -->\r\n        <view class=\"creator-card\">\r\n          <image class=\"creator-avatar\" :src=\"creatorInfo.avatarUrl || '/static/zhuye/lanmei_boy.png'\" mode=\"aspectFill\" />\r\n          <text class=\"creator-name\">{{ creatorInfo.nickName || 'Â•ΩÂèã' }}</text>\r\n          <text class=\"creator-tip\">ÊÉ≥Ë¶ÅÂíå‰Ω†Âª∫Á´ãÊÉÖ‰æ£ÂÖ≥Á≥ª</text>\r\n        </view>\r\n\r\n        <!-- Êé•ÂèóÊåâÈíÆ -->\r\n        <view class=\"action-buttons\">\r\n          <button class=\"btn accept-btn\" @click=\"handleAccept\" :disabled=\"isAccepting\">\r\n            {{ isAccepting ? 'Êé•Âèó‰∏≠...' : 'Êé•ÂèóÈÇÄËØ∑' }}\r\n          </button>\r\n          <button class=\"btn cancel-btn\" @click=\"goBack\">ÊãíÁªù</button>\r\n        </view>\r\n\r\n        <!-- Âä†ËΩΩÁä∂ÊÄÅ -->\r\n        <view v-if=\"isAccepting\" class=\"loading-tip\">\r\n          <text>Ê≠£Âú®Âª∫Á´ãÂÖ≥Á≥ª...</text>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- ÂèëËµ∑ÈÇÄËØ∑Ê®°ÂºèÔºöÁîüÊàêÈÇÄËØ∑Á†ÅÂπ∂ÂàÜ‰∫´ -->\r\n      <view v-else class=\"create-container\">\r\n        <!-- Â∑≤ÁªëÂÆöÁä∂ÊÄÅ -->\r\n        <view v-if=\"isBound\" class=\"bound-status\">\r\n          <view class=\"bound-header\">\r\n            <text class=\"bound-icon\">üíë</text>\r\n            <text class=\"bound-title\">Â∑≤ÁªëÂÆö</text>\r\n          </view>\r\n          <view class=\"partner-card\">\r\n            <image class=\"partner-avatar\" :src=\"partnerInfo.displayAvatar || partnerInfo.avatarUrl || '/static/zhuye/lanmei_boy.png'\" mode=\"aspectFill\" />\r\n            <text class=\"partner-name\">{{ partnerInfo.displayName || partnerInfo.nickName || 'ÂØπÊñπ' }}</text>\r\n            <text class=\"bound-time\">ÁªëÂÆö‰∫é {{ bindTimeText }}</text>\r\n          </view>\r\n          <button class=\"btn unbind-btn\" @click=\"handleUnbind\">Ëß£Èô§ÂÖ≥Á≥ª</button>\r\n        </view>\r\n\r\n        <!-- Êú™ÁªëÂÆöÁä∂ÊÄÅÔºöÁîüÊàêÈÇÄËØ∑ -->\r\n        <view v-else class=\"invite-content\">\r\n          <view class=\"invite-header\">\r\n            <text class=\"invite-title\">üíï ÈÇÄËØ∑Âè¶‰∏ÄÂçä</text>\r\n            <text class=\"invite-subtitle\">ÂàÜ‰∫´ÈÇÄËØ∑ÁªôTAÔºå‰∏ÄËµ∑ËÆ∞ÂΩïÁæéÂ•ΩÊó∂ÂÖâ</text>\r\n          </view>\r\n\r\n          <!-- ÈÇÄËØ∑Á†ÅÊòæÁ§∫ -->\r\n          <view v-if=\"inviteCode\" class=\"invite-code-card\">\r\n            <text class=\"code-label\">ÈÇÄËØ∑Á†Å</text>\r\n            <view class=\"code-display\">\r\n              <text class=\"code-text\">{{ inviteCode }}</text>\r\n              <button class=\"copy-btn\" @click=\"copyInviteCode\">Â§çÂà∂</button>\r\n            </view>\r\n            <text class=\"code-tip\">ÊúâÊïàÊúüÔºö{{ expireTimeText }}</text>\r\n          </view>\r\n\r\n          <!-- ÂàÜ‰∫´ÊåâÈíÆ -->\r\n          <view class=\"action-buttons\">\r\n            <button v-if=\"!inviteCode\" class=\"btn primary-btn\" @click=\"generateInviteCode\" :disabled=\"isGenerating\">\r\n              {{ isGenerating ? 'ÁîüÊàê‰∏≠...' : 'ÁîüÊàêÈÇÄËØ∑Á†Å' }}\r\n            </button>\r\n            <button v-else class=\"btn primary-btn\" @click=\"shareInvite\" :disabled=\"isSharing\">\r\n              {{ isSharing ? 'ÂàÜ‰∫´‰∏≠...' : 'ÂàÜ‰∫´ÁªôTA' }}\r\n            </button>\r\n            <button v-if=\"inviteCode\" class=\"btn secondary-btn\" @click=\"regenerateInviteCode\" :disabled=\"isGenerating\">\r\n              ÈáçÊñ∞ÁîüÊàê\r\n            </button>\r\n          </view>\r\n\r\n          <!-- ÂàÜ‰∫´ÊèêÁ§∫ -->\r\n          <view v-if=\"inviteCode\" class=\"share-tip\">\r\n            <text class=\"tip-text\">üí° ÁÇπÂáªÂè≥‰∏äËßí\"...\"ÊåâÈíÆÔºåÈÄâÊã©\"ËΩ¨Âèë\"ÂàÜ‰∫´ÁªôÂ•ΩÂèã</text>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { createInviteCode, validateInviteCode, acceptInvite, getCoupleStatus, unbindCouple } from '../../api/couple.js';\r\nimport { saveCoupleInfo, getCoupleInfo, clearCoupleInfo, isBound as checkIsBound, getPartnerInfo } from '../../utils/couple.js';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      statusBarHeight: 0,\r\n      navBarHeight: 54,\r\n      screenWidth: 375,\r\n      // ÈÇÄËØ∑Á†ÅÁõ∏ÂÖ≥\r\n      inviteCode: '',\r\n      expireAt: '',\r\n      isGenerating: false,\r\n      isSharing: false,\r\n      // Êé•ÂèóÈÇÄËØ∑Áõ∏ÂÖ≥\r\n      isInviteMode: false, // ÊòØÂê¶‰∏∫Êé•ÂèóÈÇÄËØ∑Ê®°Âºè\r\n      creatorInfo: {}, // ÈÇÄËØ∑Êñπ‰ø°ÊÅØ\r\n      isAccepting: false,\r\n      // ÁªëÂÆöÁä∂ÊÄÅ\r\n      isBound: false,\r\n      partnerInfo: {},\r\n      bindTime: ''\r\n    };\r\n  },\r\n  computed: {\r\n    containerPaddingTop() {\r\n      const totalHeightPx = this.statusBarHeight + this.navBarHeight;\r\n      const pxToRpx = 750 / this.screenWidth;\r\n      const totalHeightRpx = totalHeightPx * pxToRpx;\r\n      return totalHeightRpx + 20 + 'rpx';\r\n    },\r\n    expireTimeText() {\r\n      if (!this.expireAt) return '';\r\n      try {\r\n        const date = new Date(this.expireAt);\r\n        return date.toLocaleString('zh-CN', { \r\n          month: '2-digit', \r\n          day: '2-digit', \r\n          hour: '2-digit', \r\n          minute: '2-digit' \r\n        });\r\n      } catch (e) {\r\n        return '';\r\n      }\r\n    },\r\n    bindTimeText() {\r\n      if (!this.bindTime) return '';\r\n      try {\r\n        const date = new Date(this.bindTime);\r\n        return date.toLocaleString('zh-CN', { \r\n          year: 'numeric',\r\n          month: '2-digit', \r\n          day: '2-digit'\r\n        });\r\n      } catch (e) {\r\n        return '';\r\n      }\r\n    }\r\n  },\r\n  onLoad(options) {\r\n    this.getSystemInfo();\r\n    \r\n    // Ê£ÄÊü•ÊòØÂê¶ÊúâÈÇÄËØ∑Á†ÅÂèÇÊï∞Ôºà‰ªéÂàÜ‰∫´ËøõÂÖ•Ôºâ\r\n    if (options.code) {\r\n      this.handleInviteCode(options.code);\r\n    } else {\r\n      // Ê≠£Â∏∏ËøõÂÖ•ÔºåÊ£ÄÊü•ÁªëÂÆöÁä∂ÊÄÅ\r\n      this.checkCoupleStatus();\r\n    }\r\n  },\r\n  onShow() {\r\n    // ÊØèÊ¨°ÊòæÁ§∫È°µÈù¢Êó∂Ê£ÄÊü•ÁªëÂÆöÁä∂ÊÄÅÔºà‰ªéÂÖ∂‰ªñÈ°µÈù¢ËøîÂõûÊó∂Ôºâ\r\n    if (!this.isInviteMode) {\r\n      this.checkCoupleStatus();\r\n    }\r\n  },\r\n  // ÂæÆ‰ø°ÂàÜ‰∫´ÈÖçÁΩÆ\r\n  onShareAppMessage() {\r\n    if (!this.inviteCode) {\r\n      return {\r\n        title: 'ÈÇÄËØ∑‰Ω†Êàê‰∏∫ÊÉÖ‰æ£',\r\n        path: '/pages/invite/index'\r\n      };\r\n    }\r\n    \r\n    const userInfo = this.getCurrentUserInfo();\r\n    return {\r\n      title: `${userInfo.nickName || 'Êàë'} ÈÇÄËØ∑‰Ω†Êàê‰∏∫ÊÉÖ‰æ£`,\r\n      path: `/pages/invite/index?code=${this.inviteCode}`,\r\n      imageUrl: '/static/invite-share.png' // ÂèØ‰ª•Ê∑ªÂä†‰∏Ä‰∏™ÂàÜ‰∫´ÂõæÁâá\r\n    };\r\n  },\r\n  methods: {\r\n    getSystemInfo() {\r\n      const systemInfo = uni.getSystemInfoSync();\r\n      this.statusBarHeight = systemInfo.statusBarHeight || 0;\r\n      this.screenWidth = systemInfo.windowWidth || 375;\r\n      // #ifdef MP-WEIXIN\r\n      this.navBarHeight = 54;\r\n      // #endif\r\n      // #ifdef H5\r\n      this.navBarHeight = 54;\r\n      // #endif\r\n    },\r\n    \r\n    getCurrentUserInfo() {\r\n      try {\r\n        const loginInfo = uni.getStorageSync('login_info');\r\n        return loginInfo && loginInfo.userInfo ? loginInfo.userInfo : {};\r\n      } catch (e) {\r\n        return {};\r\n      }\r\n    },\r\n    \r\n    // Ê£ÄÊü•ÁªëÂÆöÁä∂ÊÄÅ\r\n    async checkCoupleStatus() {\r\n      try {\r\n        // ÂÖàÊ£ÄÊü•Êú¨Âú∞\r\n        const localCoupleInfo = getCoupleInfo();\r\n        if (localCoupleInfo && localCoupleInfo.isBound) {\r\n          this.isBound = true;\r\n          this.partnerInfo = localCoupleInfo.partnerInfo || {};\r\n          this.bindTime = localCoupleInfo.bindTime || '';\r\n          \r\n          // ÂêåÊó∂Êõ¥Êñ∞Êú¨Âú∞ÈÇÄËØ∑Á†ÅÔºàÂ¶ÇÊûúÊúâÔºâ\r\n          if (localCoupleInfo.inviteCode) {\r\n            this.inviteCode = localCoupleInfo.inviteCode;\r\n            this.expireAt = localCoupleInfo.inviteCodeExpire || '';\r\n          }\r\n          \r\n          // ÂÜç‰ªéÊúçÂä°Âô®ÂêåÊ≠•‰∏ÄÊ¨°Áä∂ÊÄÅ\r\n          try {\r\n            const response = await getCoupleStatus();\r\n            if (response && response.data && response.data.isBound) {\r\n              // Êõ¥Êñ∞Êú¨Âú∞‰ø°ÊÅØ\r\n              saveCoupleInfo({\r\n                isBound: true,\r\n                coupleId: response.data.coupleId,\r\n                partnerId: response.data.partnerInfo?.userId || '',\r\n                partnerInfo: response.data.partnerInfo || {},\r\n                bindTime: response.data.bindTime || '',\r\n                role: response.data.role || ''\r\n              });\r\n              this.partnerInfo = response.data.partnerInfo || {};\r\n              this.bindTime = response.data.bindTime || '';\r\n            }\r\n          } catch (e) {\r\n            console.error('ÂêåÊ≠•ÁªëÂÆöÁä∂ÊÄÅÂ§±Ë¥•', e);\r\n          }\r\n          return;\r\n        }\r\n        \r\n        // Êú¨Âú∞Ê≤°ÊúâÔºåÊü•ËØ¢ÊúçÂä°Âô®\r\n        this.isBound = false;\r\n        try {\r\n          const response = await getCoupleStatus();\r\n          if (response && response.data && response.data.isBound) {\r\n            this.isBound = true;\r\n            this.partnerInfo = response.data.partnerInfo || {};\r\n            this.bindTime = response.data.bindTime || '';\r\n            \r\n            // ‰øùÂ≠òÂà∞Êú¨Âú∞\r\n            saveCoupleInfo({\r\n              isBound: true,\r\n              coupleId: response.data.coupleId,\r\n              partnerId: response.data.partnerInfo?.userId || '',\r\n              partnerInfo: response.data.partnerInfo || {},\r\n              bindTime: response.data.bindTime || '',\r\n              role: response.data.role || ''\r\n            });\r\n          }\r\n        } catch (e) {\r\n          console.error('Êü•ËØ¢ÁªëÂÆöÁä∂ÊÄÅÂ§±Ë¥•', e);\r\n          // Â¶ÇÊûúÊü•ËØ¢Â§±Ë¥•Ôºå‰ΩøÁî®Êú¨Âú∞Áä∂ÊÄÅ\r\n          this.isBound = checkIsBound();\r\n          if (this.isBound) {\r\n            this.partnerInfo = getPartnerInfo() || {};\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.error('Ê£ÄÊü•ÁªëÂÆöÁä∂ÊÄÅÂ§±Ë¥•', e);\r\n        this.isBound = checkIsBound();\r\n        if (this.isBound) {\r\n          this.partnerInfo = getPartnerInfo() || {};\r\n        }\r\n      }\r\n    },\r\n    \r\n    // Â§ÑÁêÜÈÇÄËØ∑Á†ÅÔºà‰ªéÂàÜ‰∫´ËøõÂÖ•Ôºâ\r\n    async handleInviteCode(code) {\r\n      this.isInviteMode = true;\r\n      this.isAccepting = false;\r\n      \r\n      try {\r\n        uni.showLoading({ title: 'È™åËØÅ‰∏≠...' });\r\n        \r\n        const response = await validateInviteCode(code);\r\n        uni.hideLoading();\r\n        \r\n        if (response && response.success && response.data) {\r\n          this.creatorInfo = response.data.creator || {};\r\n          this.inviteCode = code;\r\n          this.expireAt = response.data.expireAt || '';\r\n        } else {\r\n          uni.showModal({\r\n            title: 'ÊèêÁ§∫',\r\n            content: response.message || 'ÈÇÄËØ∑Á†ÅÊó†ÊïàÊàñÂ∑≤ËøáÊúü',\r\n            showCancel: false,\r\n            success: () => {\r\n              this.goBack();\r\n            }\r\n          });\r\n        }\r\n      } catch (error) {\r\n        uni.hideLoading();\r\n        console.error('È™åËØÅÈÇÄËØ∑Á†ÅÂ§±Ë¥•', error);\r\n        uni.showModal({\r\n          title: 'ÈîôËØØ',\r\n          content: 'È™åËØÅÈÇÄËØ∑Á†ÅÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•',\r\n          showCancel: false,\r\n          success: () => {\r\n            this.goBack();\r\n          }\r\n        });\r\n      }\r\n    },\r\n    \r\n    // ÁîüÊàêÈÇÄËØ∑Á†Å\r\n    async generateInviteCode() {\r\n      // ÂÖàÊ£ÄÊü•ÊòØÂê¶Â∑≤ÁªëÂÆö\r\n      if (this.isBound) {\r\n        uni.showToast({ title: 'ÊÇ®Â∑≤ÁªèÁªëÂÆö‰∫ÜÊÉÖ‰æ£ÂÖ≥Á≥ª', icon: 'none' });\r\n        return;\r\n      }\r\n      \r\n      this.isGenerating = true;\r\n      try {\r\n        const response = await createInviteCode();\r\n        \r\n        if (response && response.success && response.data) {\r\n          this.inviteCode = response.data.inviteCode || '';\r\n          this.expireAt = response.data.expireAt || '';\r\n          \r\n          // ‰øùÂ≠òÂà∞Êú¨Âú∞ÔºàÊú™ÁªëÂÆöÁä∂ÊÄÅ‰πü‰øùÂ≠òÈÇÄËØ∑Á†ÅÔºâ\r\n          saveCoupleInfo({\r\n            isBound: false,\r\n            coupleId: '',\r\n            partnerId: '',\r\n            partnerInfo: null,\r\n            bindTime: '',\r\n            role: 'initiator',\r\n            inviteCode: this.inviteCode,\r\n            inviteCodeExpire: this.expireAt\r\n          });\r\n          \r\n          uni.showToast({ title: 'ÈÇÄËØ∑Á†ÅÁîüÊàêÊàêÂäü', icon: 'success' });\r\n        } else {\r\n          uni.showToast({ title: response.message || 'ÁîüÊàêÂ§±Ë¥•', icon: 'none' });\r\n        }\r\n      } catch (error) {\r\n        console.error('ÁîüÊàêÈÇÄËØ∑Á†ÅÂ§±Ë¥•', error);\r\n        uni.showToast({ title: 'ÁîüÊàêÂ§±Ë¥•ÔºåËØ∑ÈáçËØï', icon: 'none' });\r\n      } finally {\r\n        this.isGenerating = false;\r\n      }\r\n    },\r\n    \r\n    // ÈáçÊñ∞ÁîüÊàêÈÇÄËØ∑Á†Å\r\n    async regenerateInviteCode() {\r\n      uni.showModal({\r\n        title: 'ÊèêÁ§∫',\r\n        content: 'Á°ÆÂÆöË¶ÅÈáçÊñ∞ÁîüÊàêÈÇÄËØ∑Á†ÅÂêóÔºüÊóßÁöÑÈÇÄËØ∑Á†ÅÂ∞ÜÂ§±Êïà„ÄÇ',\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            this.generateInviteCode();\r\n          }\r\n        }\r\n      });\r\n    },\r\n    \r\n    // Â§çÂà∂ÈÇÄËØ∑Á†Å\r\n    copyInviteCode() {\r\n      if (!this.inviteCode) return;\r\n      \r\n      // #ifdef MP-WEIXIN\r\n      uni.setClipboardData({\r\n        data: this.inviteCode,\r\n        success: () => {\r\n          uni.showToast({ title: 'Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø', icon: 'success' });\r\n        }\r\n      });\r\n      // #endif\r\n      \r\n      // #ifdef H5\r\n      if (navigator.clipboard) {\r\n        navigator.clipboard.writeText(this.inviteCode).then(() => {\r\n          uni.showToast({ title: 'Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø', icon: 'success' });\r\n        });\r\n      }\r\n      // #endif\r\n    },\r\n    \r\n    // ÂàÜ‰∫´ÈÇÄËØ∑\r\n    shareInvite() {\r\n      // Â∞èÁ®ãÂ∫èÂàÜ‰∫´ÈÄöËøáÂè≥‰∏äËßíËèúÂçïËß¶Âèë onShareAppMessage\r\n      // ËøôÈáåÂèØ‰ª•ÊèêÁ§∫Áî®Êà∑Â¶Ç‰Ωï‰ΩøÁî®ÂàÜ‰∫´ÂäüËÉΩ\r\n      uni.showModal({\r\n        title: 'ÂàÜ‰∫´ÈÇÄËØ∑',\r\n        content: 'ËØ∑ÁÇπÂáªÂè≥‰∏äËßí\"...\"ÊåâÈíÆÔºåÈÄâÊã©\"ËΩ¨Âèë\"ÂàÜ‰∫´ÁªôÂ•ΩÂèã',\r\n        showCancel: false\r\n      });\r\n    },\r\n    \r\n    // Êé•ÂèóÈÇÄËØ∑\r\n    async handleAccept() {\r\n      if (!this.inviteCode) {\r\n        uni.showToast({ title: 'ÈÇÄËØ∑Á†ÅÊó†Êïà', icon: 'none' });\r\n        return;\r\n      }\r\n      \r\n      // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªëÂÆö\r\n      if (this.isBound) {\r\n        uni.showModal({\r\n          title: 'ÊèêÁ§∫',\r\n          content: 'ÊÇ®Â∑≤ÁªèÁªëÂÆö‰∫ÜÊÉÖ‰æ£ÂÖ≥Á≥ªÔºåÊó†Ê≥ïÊé•ÂèóÊñ∞ÁöÑÈÇÄËØ∑',\r\n          showCancel: false\r\n        });\r\n        return;\r\n      }\r\n      \r\n      this.isAccepting = true;\r\n      try {\r\n        const response = await acceptInvite(this.inviteCode);\r\n        \r\n        if (response && response.success && response.data) {\r\n          // ‰øùÂ≠òÁªëÂÆö‰ø°ÊÅØ\r\n          const coupleData = {\r\n            isBound: true,\r\n            coupleId: response.data.coupleId || '',\r\n            partnerId: response.data.partnerInfo?.userId || '',\r\n            partnerInfo: response.data.partnerInfo || {},\r\n            bindTime: response.data.bindTime || '',\r\n            role: 'accepter'\r\n          };\r\n          \r\n          saveCoupleInfo(coupleData);\r\n          \r\n          uni.showToast({ \r\n            title: 'ÁªëÂÆöÊàêÂäüÔºÅ', \r\n            icon: 'success',\r\n            duration: 2000\r\n          });\r\n          \r\n          // Âª∂ËøüË∑≥ËΩ¨ÔºåËÆ©Áî®Êà∑ÁúãÂà∞ÊàêÂäüÊèêÁ§∫\r\n          setTimeout(() => {\r\n            uni.reLaunch({\r\n              url: '/pages/we/index'\r\n            });\r\n          }, 2000);\r\n        } else {\r\n          uni.showToast({ \r\n            title: response.message || 'Êé•ÂèóÂ§±Ë¥•', \r\n            icon: 'none' \r\n          });\r\n          this.isAccepting = false;\r\n        }\r\n      } catch (error) {\r\n        console.error('Êé•ÂèóÈÇÄËØ∑Â§±Ë¥•', error);\r\n        uni.showToast({ \r\n          title: error.message || 'Êé•ÂèóÂ§±Ë¥•ÔºåËØ∑ÈáçËØï', \r\n          icon: 'none' \r\n        });\r\n        this.isAccepting = false;\r\n      }\r\n    },\r\n    \r\n    // Ëß£ÁªëÂÖ≥Á≥ª\r\n    async handleUnbind() {\r\n      uni.showModal({\r\n        title: 'Á°ÆËÆ§Ëß£Áªë',\r\n        content: 'Ëß£Èô§ÂÖ≥Á≥ªÂêéÔºåÂèåÊñπÂ∞ÜÊó†Ê≥ïÂÖ±‰∫´Êï∞ÊçÆ„ÄÇÁ°ÆÂÆöË¶ÅËß£Èô§ÂêóÔºü',\r\n        success: async (res) => {\r\n          if (res.confirm) {\r\n            try {\r\n              uni.showLoading({ title: 'Ëß£Áªë‰∏≠...' });\r\n              await unbindCouple();\r\n              uni.hideLoading();\r\n              \r\n              // Ê∏ÖÈô§Êú¨Âú∞‰ø°ÊÅØ\r\n              clearCoupleInfo();\r\n              \r\n              uni.showToast({ \r\n                title: 'Â∑≤Ëß£Èô§ÂÖ≥Á≥ª', \r\n                icon: 'success' \r\n              });\r\n              \r\n              // Êõ¥Êñ∞È°µÈù¢Áä∂ÊÄÅ\r\n              this.isBound = false;\r\n              this.partnerInfo = {};\r\n              this.bindTime = '';\r\n              \r\n              // Âª∂ËøüÂà∑Êñ∞È°µÈù¢\r\n              setTimeout(() => {\r\n                this.checkCoupleStatus();\r\n              }, 1500);\r\n            } catch (error) {\r\n              uni.hideLoading();\r\n              console.error('Ëß£ÁªëÂ§±Ë¥•', error);\r\n              uni.showToast({ \r\n                title: 'Ëß£ÁªëÂ§±Ë¥•ÔºåËØ∑ÈáçËØï', \r\n                icon: 'none' \r\n              });\r\n            }\r\n          }\r\n        }\r\n      });\r\n    },\r\n    \r\n    goBack() {\r\n      uni.navigateBack();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.invite-page {\r\n  min-height: 100vh;\r\n  background: #F8F0FC;\r\n  padding-bottom: 40rpx;\r\n}\r\n\r\n/* Ëá™ÂÆö‰πâÂØºËà™Ê†èÊ†∑Âºè */\r\n.custom-navbar {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  z-index: 9999;\r\n  background-color: #F8F0FC;\r\n  overflow: hidden;\r\n}\r\n\r\n.navbar-gradient-bg {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  height: 200%;\r\n  background: linear-gradient(180deg, #F8F0FC 0%, #F3E8FF 30%, #F0E0FF 60%, #F8F0FC 100%);\r\n}\r\n\r\n.status-bar {\r\n  width: 100%;\r\n  background: transparent;\r\n  position: relative;\r\n  z-index: 1;\r\n}\r\n\r\n.navbar-content {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 0 30rpx;\r\n  box-sizing: border-box;\r\n  position: relative;\r\n  z-index: 1;\r\n}\r\n\r\n.navbar-left {\r\n  width: 80rpx;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.back-icon {\r\n  font-size: 44rpx;\r\n  color: #6B5B95;\r\n  font-weight: 600;\r\n}\r\n\r\n.navbar-title {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  text-align: center;\r\n}\r\n\r\n.title-text {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: #6B5B95;\r\n}\r\n\r\n.navbar-right {\r\n  width: 80rpx;\r\n}\r\n\r\n.content-area {\r\n  padding: 30rpx 24rpx;\r\n}\r\n\r\n/* Êé•ÂèóÈÇÄËØ∑ÂÆπÂô® */\r\n.invite-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding: 60rpx 40rpx;\r\n}\r\n\r\n.invite-header {\r\n  text-align: center;\r\n  margin-bottom: 60rpx;\r\n}\r\n\r\n.invite-title {\r\n  display: block;\r\n  font-size: 48rpx;\r\n  font-weight: 700;\r\n  color: #6B5B95;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.invite-subtitle {\r\n  display: block;\r\n  font-size: 28rpx;\r\n  color: #999;\r\n}\r\n\r\n/* ÈÇÄËØ∑Êñπ‰ø°ÊÅØÂç°Áâá */\r\n.creator-card {\r\n  background: #ffffff;\r\n  border-radius: 24rpx;\r\n  padding: 40rpx;\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin-bottom: 60rpx;\r\n  box-shadow: 0 8rpx 24rpx rgba(0,0,0,0.06);\r\n}\r\n\r\n.creator-avatar {\r\n  width: 160rpx;\r\n  height: 160rpx;\r\n  border-radius: 80rpx;\r\n  margin-bottom: 24rpx;\r\n  border: 4rpx solid #fdf2f8;\r\n}\r\n\r\n.creator-name {\r\n  font-size: 36rpx;\r\n  font-weight: 600;\r\n  color: #333;\r\n  margin-bottom: 12rpx;\r\n}\r\n\r\n.creator-tip {\r\n  font-size: 26rpx;\r\n  color: #999;\r\n}\r\n\r\n/* ÊåâÈíÆÁªÑ */\r\n.action-buttons {\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 24rpx;\r\n}\r\n\r\n.btn {\r\n  width: 100%;\r\n  height: 88rpx;\r\n  border-radius: 44rpx;\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  border: none;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.accept-btn {\r\n  background: linear-gradient(135deg, #FF8FB3 0%, #FF6B9D 100%);\r\n  color: #ffffff;\r\n}\r\n\r\n.accept-btn[disabled] {\r\n  background: #ddd;\r\n  color: #999;\r\n}\r\n\r\n.cancel-btn {\r\n  background: #f5f5f5;\r\n  color: #666;\r\n}\r\n\r\n.primary-btn {\r\n  background: linear-gradient(135deg, #FF8FB3 0%, #FF6B9D 100%);\r\n  color: #ffffff;\r\n}\r\n\r\n.primary-btn[disabled] {\r\n  background: #ddd;\r\n  color: #999;\r\n}\r\n\r\n.secondary-btn {\r\n  background: #ffffff;\r\n  color: #FF8FB3;\r\n  border: 2rpx solid #FF8FB3;\r\n}\r\n\r\n.unbind-btn {\r\n  background: #f5f5f5;\r\n  color: #999;\r\n  margin-top: 40rpx;\r\n}\r\n\r\n.loading-tip {\r\n  margin-top: 40rpx;\r\n  font-size: 26rpx;\r\n  color: #999;\r\n}\r\n\r\n/* ÂàõÂª∫ÈÇÄËØ∑ÂÆπÂô® */\r\n.create-container {\r\n  padding: 40rpx 0;\r\n}\r\n\r\n.bound-status {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding: 60rpx 40rpx;\r\n}\r\n\r\n.bound-header {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin-bottom: 60rpx;\r\n}\r\n\r\n.bound-icon {\r\n  font-size: 80rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.bound-title {\r\n  font-size: 36rpx;\r\n  font-weight: 600;\r\n  color: #6B5B95;\r\n}\r\n\r\n.partner-card {\r\n  background: #ffffff;\r\n  border-radius: 24rpx;\r\n  padding: 40rpx;\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin-bottom: 40rpx;\r\n  box-shadow: 0 8rpx 24rpx rgba(0,0,0,0.06);\r\n}\r\n\r\n.partner-avatar {\r\n  width: 120rpx;\r\n  height: 120rpx;\r\n  border-radius: 60rpx;\r\n  margin-bottom: 20rpx;\r\n  border: 4rpx solid #fdf2f8;\r\n}\r\n\r\n.partner-name {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: #333;\r\n  margin-bottom: 12rpx;\r\n}\r\n\r\n.bound-time {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n}\r\n\r\n.invite-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n/* ÈÇÄËØ∑Á†ÅÂç°Áâá */\r\n.invite-code-card {\r\n  background: #ffffff;\r\n  border-radius: 24rpx;\r\n  padding: 40rpx;\r\n  width: 100%;\r\n  margin-bottom: 40rpx;\r\n  box-shadow: 0 8rpx 24rpx rgba(0,0,0,0.06);\r\n}\r\n\r\n.code-label {\r\n  display: block;\r\n  font-size: 26rpx;\r\n  color: #999;\r\n  text-align: center;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.code-display {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 24rpx;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.code-text {\r\n  font-size: 56rpx;\r\n  font-weight: 700;\r\n  color: #FF8FB3;\r\n  letter-spacing: 8rpx;\r\n  font-family: 'Courier New', monospace;\r\n}\r\n\r\n.copy-btn {\r\n  padding: 12rpx 32rpx;\r\n  background: #fdf2f8;\r\n  color: #FF8FB3;\r\n  border-radius: 20rpx;\r\n  font-size: 24rpx;\r\n  border: none;\r\n}\r\n\r\n.code-tip {\r\n  display: block;\r\n  font-size: 24rpx;\r\n  color: #999;\r\n  text-align: center;\r\n}\r\n\r\n.share-tip {\r\n  margin-top: 40rpx;\r\n  padding: 24rpx;\r\n  background: #fff9e6;\r\n  border-radius: 16rpx;\r\n  width: 100%;\r\n}\r\n\r\n.tip-text {\r\n  font-size: 24rpx;\r\n  color: #ff9500;\r\n  line-height: 1.6;\r\n}\r\n</style>\r\n\r\n","import MiniProgramPage from 'C:/Users/Administrator/Desktop/È°πÁõÆ/love_time_fu/pages/invite/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getCoupleInfo","getCoupleStatus","saveCoupleInfo","getPartnerInfo","validateInviteCode","createInviteCode","unbindCouple","clearCoupleInfo"],"mappings":"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"}