{"version":3,"file":"index.js","sources":["pages/login/index.vue","D:/softcaree/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vaW5kZXgudnVl"],"sourcesContent":["<template>\r\n  <view class=\"login-page\">\r\n    <!-- 背景图片 -->\r\n    <image class=\"bg-image\" src=\"/static/login/beijing.jpg\" mode=\"aspectFill\" />\r\n    \r\n    <!-- 背景蒙版（增加可读性） -->\r\n    <view class=\"bg-overlay\"></view>\r\n\r\n    <!-- 内容层 -->\r\n    <view class=\"content-wrapper\">\r\n\r\n    <!-- Logo 和标题 -->\r\n    <view class=\"logo-section\">\r\n      <image class=\"logo\" src=\"/static/zhuye/yellow_love.png\" mode=\"aspectFit\" />\r\n      <text class=\"app-name\">甜蜜时光</text>\r\n      <text class=\"app-slogan\">记录每一个爱的瞬间</text>\r\n    </view>\r\n\r\n    <!-- 登录区域（无卡片） -->\r\n    <view class=\"login-area\">\r\n      <!-- 用户信息预览（授权后显示） -->\r\n      <view v-if=\"userInfo.nickName\" class=\"user-preview\">\r\n        <image class=\"avatar\" :src=\"userInfo.avatarUrl\" mode=\"aspectFill\" />\r\n        <text class=\"nickname\">{{ userInfo.nickName }}</text>\r\n      </view>\r\n\r\n      <!-- 登录按钮 -->\r\n      <button \r\n        v-if=\"!isLoggedIn\" \r\n        class=\"login-btn\" \r\n        @click=\"handleWxLogin\"\r\n        :loading=\"isLoading\"\r\n      >\r\n        <text class=\"btn-icon\">📱</text>\r\n        <text class=\"btn-text\">微信授权登录</text>\r\n      </button>\r\n\r\n      <!-- 进入按钮 -->\r\n      <button \r\n        v-else \r\n        class=\"enter-btn\" \r\n        @click=\"enterApp\"\r\n      >\r\n        <text class=\"btn-text\">进入甜蜜时光</text>\r\n      </button>\r\n\r\n      <!-- 提示信息 -->\r\n      <view class=\"tips\">\r\n        <text class=\"tip-text\">登录即表示同意</text>\r\n        <text class=\"link-text\">《用户协议》</text>\r\n        <text class=\"tip-text\">和</text>\r\n        <text class=\"link-text\">《隐私政策》</text>\r\n      </view>\r\n    </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      isLoggedIn: false,\r\n      isLoading: false,\r\n      userInfo: {\r\n        nickName: '',\r\n        avatarUrl: ''\r\n      }\r\n    };\r\n  },\r\n  onLoad() {\r\n    // 检查是否已登录\r\n    this.checkLoginStatus();\r\n  },\r\n  methods: {\r\n    // 检查登录状态\r\n    checkLoginStatus() {\r\n      try {\r\n        const loginInfo = uni.getStorageSync('login_info');\r\n        if (loginInfo && loginInfo.isLoggedIn) {\r\n          this.isLoggedIn = true;\r\n          this.userInfo = loginInfo.userInfo || {};\r\n        }\r\n      } catch (e) {\r\n        console.error('检查登录状态失败', e);\r\n      }\r\n    },\r\n\r\n    // 微信授权登录\r\n    async handleWxLogin() {\r\n      this.isLoading = true;\r\n\r\n      try {\r\n        // 1. 获取用户信息\r\n        const userProfile = await this.getUserProfile();\r\n        \r\n        if (userProfile) {\r\n          // 2. 保存用户信息\r\n          this.userInfo = {\r\n            nickName: userProfile.nickName,\r\n            avatarUrl: userProfile.avatarUrl\r\n          };\r\n\r\n          // 3. 保存登录状态\r\n          const loginInfo = {\r\n            isLoggedIn: true,\r\n            userInfo: this.userInfo,\r\n            loginTime: new Date().toISOString()\r\n          };\r\n          uni.setStorageSync('login_info', loginInfo);\r\n\r\n          this.isLoggedIn = true;\r\n\r\n          // 4. 提示登录成功\r\n          uni.showToast({\r\n            title: '登录成功',\r\n            icon: 'success',\r\n            duration: 1500\r\n          });\r\n\r\n          // 5. 延迟进入首页\r\n          setTimeout(() => {\r\n            this.enterApp();\r\n          }, 1500);\r\n        }\r\n      } catch (e) {\r\n        console.error('登录失败', e);\r\n        uni.showToast({\r\n          title: e.errMsg || '登录失败，请重试',\r\n          icon: 'none'\r\n        });\r\n      } finally {\r\n        this.isLoading = false;\r\n      }\r\n    },\r\n\r\n    // 获取用户信息（微信小程序）\r\n    getUserProfile() {\r\n      return new Promise((resolve, reject) => {\r\n        // #ifdef MP-WEIXIN\r\n        uni.getUserProfile({\r\n          desc: '用于完善用户资料',\r\n          success: (res) => {\r\n            resolve(res.userInfo);\r\n          },\r\n          fail: (err) => {\r\n            reject(err);\r\n          }\r\n        });\r\n        // #endif\r\n\r\n        // #ifndef MP-WEIXIN\r\n        // H5 或其他平台使用模拟数据\r\n        resolve({\r\n          nickName: '游客用户',\r\n          avatarUrl: '/static/zhuye/smile.png'\r\n        });\r\n        // #endif\r\n      });\r\n    },\r\n\r\n    // 进入应用\r\n    enterApp() {\r\n      uni.reLaunch({\r\n        url: '/pages/index/index'\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.login-page {\r\n  min-height: 100vh;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n/* 背景图片 */\r\n.bg-image {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: 0;\r\n}\r\n\r\n/* 背景蒙版（让文字更清晰） */\r\n.bg-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: rgba(255, 255, 255, 0.15);\r\n  z-index: 1;\r\n}\r\n\r\n/* 内容层 */\r\n.content-wrapper {\r\n  position: relative;\r\n  z-index: 2;\r\n  min-height: 100vh;\r\n  padding: 40rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n/* 移除旧的背景装饰 */\r\n.bg-decoration {\r\n  display: none;\r\n}\r\n\r\n.heart {\r\n  display: none;\r\n}\r\n\r\n/* Logo 区域 */\r\n.logo-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin-bottom: 80rpx;\r\n}\r\n\r\n.logo {\r\n  width: 180rpx;\r\n  height: 180rpx;\r\n  margin-bottom: 30rpx;\r\n  animation: pulse 2s ease-in-out infinite;\r\n}\r\n\r\n@keyframes pulse {\r\n  0%, 100% {\r\n    transform: scale(1);\r\n  }\r\n  50% {\r\n    transform: scale(1.05);\r\n  }\r\n}\r\n\r\n.app-name {\r\n  font-size: 48rpx;\r\n  font-weight: 700;\r\n  color: #2bad81;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.app-slogan {\r\n  font-size: 26rpx;\r\n  color: #4e3c3c;\r\n}\r\n\r\n/* 登录区域（无卡片背景） */\r\n.login-area {\r\n  width: 70%;\r\n  max-width: 500rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n/* 移除旧的登录卡片样式 */\r\n.login-card {\r\n  display: none;\r\n}\r\n\r\n/* 移除欢迎文字样式 */\r\n.welcome-text {\r\n  display: none;\r\n}\r\n\r\n.subtitle {\r\n  display: none;\r\n}\r\n\r\n/* 用户信息预览 */\r\n.user-preview {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin-bottom: 40rpx;\r\n}\r\n\r\n.avatar {\r\n  width: 120rpx;\r\n  height: 120rpx;\r\n  border-radius: 60rpx;\r\n  border: 4rpx solid #e5e5e5;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.nickname {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  font-weight: 600;\r\n}\r\n\r\n/* 登录按钮 */\r\n.login-btn, .enter-btn {\r\n  width: 100%;\r\n  background: #2bad81;\r\n  border-radius: 48rpx;\r\n  padding: 28rpx 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 12rpx;\r\n  box-shadow: 0 8rpx 20rpx rgba(43, 173, 129, 0.25);\r\n  margin-bottom: 30rpx;\r\n  border: none;\r\n  color: #ffffff;\r\n}\r\n\r\n.login-btn::after, .enter-btn::after {\r\n  border: none;\r\n}\r\n\r\n.login-btn:active, .enter-btn:active {\r\n  opacity: 0.85;\r\n}\r\n\r\n.enter-btn {\r\n  background: #2bad81;\r\n  box-shadow: 0 8rpx 20rpx rgba(43, 173, 129, 0.25);\r\n}\r\n\r\n.btn-icon {\r\n  font-size: 32rpx;\r\n}\r\n\r\n.btn-text {\r\n  font-size: 30rpx;\r\n  font-weight: 600;\r\n  color: #ffffff;\r\n}\r\n\r\n/* 提示信息 */\r\n.tips {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: center;\r\n  align-items: center;\r\n  gap: 8rpx;\r\n  padding: 16rpx 32rpx;\r\n  background: rgba(255, 255, 255, 0.85);\r\n  border-radius: 20rpx;\r\n  backdrop-filter: blur(8px);\r\n}\r\n\r\n.tip-text {\r\n  font-size: 22rpx;\r\n  color: #666;\r\n}\r\n\r\n.link-text {\r\n  font-size: 22rpx;\r\n  color: #2bad81;\r\n}\r\n\r\n/* 底部 */\r\n.footer {\r\n  position: relative;\r\n  margin-top: 40rpx;\r\n  text-align: center;\r\n}\r\n\r\n.footer-text {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  text-shadow: 0 2rpx 4rpx rgba(255, 255, 255, 0.8);\r\n}\r\n</style>\r\n","import MiniProgramPage from 'C:/Users/Administrator/Desktop/love_time/pages/login/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;;AA2DA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,WAAW;AAAA,MACX,UAAU;AAAA,QACR,UAAU;AAAA,QACV,WAAW;AAAA,MACb;AAAA;EAEH;AAAA,EACD,SAAS;AAEP,SAAK,iBAAgB;AAAA,EACtB;AAAA,EACD,SAAS;AAAA;AAAA,IAEP,mBAAmB;AACjB,UAAI;AACF,cAAM,YAAYA,cAAAA,MAAI,eAAe,YAAY;AACjD,YAAI,aAAa,UAAU,YAAY;AACrC,eAAK,aAAa;AAClB,eAAK,WAAW,UAAU,YAAY,CAAA;AAAA,QACxC;AAAA,MACF,SAAS,GAAG;AACVA,sBAAc,MAAA,MAAA,SAAA,+BAAA,YAAY,CAAC;AAAA,MAC7B;AAAA,IACD;AAAA;AAAA,IAGD,MAAM,gBAAgB;AACpB,WAAK,YAAY;AAEjB,UAAI;AAEF,cAAM,cAAc,MAAM,KAAK;AAE/B,YAAI,aAAa;AAEf,eAAK,WAAW;AAAA,YACd,UAAU,YAAY;AAAA,YACtB,WAAW,YAAY;AAAA;AAIzB,gBAAM,YAAY;AAAA,YAChB,YAAY;AAAA,YACZ,UAAU,KAAK;AAAA,YACf,YAAW,oBAAI,KAAM,GAAC,YAAY;AAAA;AAEpCA,wBAAAA,MAAI,eAAe,cAAc,SAAS;AAE1C,eAAK,aAAa;AAGlBA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,YACN,UAAU;AAAA,UACZ,CAAC;AAGD,qBAAW,MAAM;AACf,iBAAK,SAAQ;AAAA,UACd,GAAE,IAAI;AAAA,QACT;AAAA,MACF,SAAS,GAAG;AACVA,sBAAc,MAAA,MAAA,SAAA,gCAAA,QAAQ,CAAC;AACvBA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO,EAAE,UAAU;AAAA,UACnB,MAAM;AAAA,QACR,CAAC;AAAA,MACH,UAAU;AACR,aAAK,YAAY;AAAA,MACnB;AAAA,IACD;AAAA;AAAA,IAGD,iBAAiB;AACf,aAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AAEtCA,sBAAAA,MAAI,eAAe;AAAA,UACjB,MAAM;AAAA,UACN,SAAS,CAAC,QAAQ;AAChB,oBAAQ,IAAI,QAAQ;AAAA,UACrB;AAAA,UACD,MAAM,CAAC,QAAQ;AACb,mBAAO,GAAG;AAAA,UACZ;AAAA,QACF,CAAC;AAAA,MAUH,CAAC;AAAA,IACF;AAAA;AAAA,IAGD,WAAW;AACTA,oBAAAA,MAAI,SAAS;AAAA,QACX,KAAK;AAAA,MACP,CAAC;AAAA,IACH;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;ACvKA,GAAG,WAAW,eAAe;"}