{"version":3,"file":"create.js","sources":["pages/xinxiang/create.vue","D:/softcaree/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMveGlueGlhbmcvY3JlYXRlLnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"create-page\">\r\n    <!-- 步骤指示器 -->\r\n    <view class=\"steps\">\r\n      <view class=\"step\" :class=\"{ active: currentStep === 1 }\">\r\n        <view class=\"step-number\">1</view>\r\n        <text class=\"step-text\">选择样式</text>\r\n      </view>\r\n      <view class=\"step-line\"></view>\r\n      <view class=\"step\" :class=\"{ active: currentStep === 2 }\">\r\n        <view class=\"step-number\">2</view>\r\n        <text class=\"step-text\">填写信息</text>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 第一步：选择信件样式 -->\r\n    <view v-if=\"currentStep === 1\" class=\"step-content\">\r\n      <text class=\"section-title\">选择信件样式</text>\r\n      \r\n      <!-- 预设样式网格 -->\r\n      <view class=\"style-grid\">\r\n        <view \r\n          v-for=\"i in [1, 2, 4, 5, 6, 7]\" \r\n          :key=\"i\" \r\n          class=\"style-item\"\r\n          :class=\"{ selected: selectedStyle === i && !isCustomStyle }\"\r\n          @click=\"selectPresetStyle(i)\"\r\n        >\r\n          <image class=\"style-image\" :src=\"`/static/xinxiang/xin${i}.jpg`\" mode=\"aspectFill\"></image>\r\n          <view v-if=\"selectedStyle === i && !isCustomStyle\" class=\"check-mark\">✓</view>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 自定义样式 -->\r\n      <view class=\"custom-section\">\r\n        <button class=\"custom-btn\" @click=\"uploadCustom\">\r\n          <text class=\"btn-icon\">📷</text>\r\n          <text>自定义信件底图</text>\r\n        </button>\r\n        \r\n        <view v-if=\"customImage\" class=\"custom-preview\" @click=\"showOpacityModal = true\">\r\n          <view class=\"preview-wrapper\">\r\n            <image class=\"preview-bg\" :src=\"customImage\" mode=\"aspectFill\"></image>\r\n            <view class=\"preview-overlay\" :style=\"{ opacity: 1 - opacity / 100 }\"></view>\r\n            <!-- 遮罩层：使未选中区域变暗 -->\r\n            <view class=\"mask-layer\">\r\n              <!-- 上部遮罩 -->\r\n              <view class=\"mask-top\" :style=\"{ height: cropArea.top + '%' }\"></view>\r\n              <!-- 中间部分 -->\r\n              <view class=\"mask-middle\" :style=\"{ top: cropArea.top + '%', height: cropArea.height + '%' }\">\r\n                <!-- 左边遮罩 -->\r\n                <view class=\"mask-left\" :style=\"{ width: cropArea.left + '%' }\"></view>\r\n                <!-- 选中区域（透明） -->\r\n                <view class=\"mask-center\" :style=\"{ width: cropArea.width + '%' }\"></view>\r\n                <!-- 右边遮罩 -->\r\n                <view class=\"mask-right\" :style=\"{ width: (100 - cropArea.left - cropArea.width) + '%' }\"></view>\r\n              </view>\r\n              <!-- 下部遮罩 -->\r\n              <view class=\"mask-bottom\" :style=\"{ top: (cropArea.top + cropArea.height) + '%', height: (100 - cropArea.top - cropArea.height) + '%' }\"></view>\r\n            </view>\r\n            <!-- 裁剪框边框 -->\r\n            <view class=\"crop-preview\" :style=\"{\r\n              left: cropArea.left + '%',\r\n              top: cropArea.top + '%',\r\n              width: cropArea.width + '%',\r\n              height: cropArea.height + '%'\r\n            }\"></view>\r\n          </view>\r\n          <text class=\"preview-tip\">点击调整透明度和选定区域</text>\r\n        </view>\r\n      </view>\r\n\r\n      <button class=\"next-btn\" @click=\"nextStep\">下一步</button>\r\n    </view>\r\n\r\n    <!-- 透明度调整弹窗 -->\r\n    <view v-if=\"showOpacityModal\" class=\"modal-overlay\" @click=\"showOpacityModal = false\">\r\n      <view class=\"modal-content\" @click.stop>\r\n        <text class=\"modal-title\">调整图片</text>\r\n        \r\n        <view class=\"modal-preview\">\r\n          <view \r\n            class=\"preview-wrapper\"\r\n            @touchmove=\"onDrag\"\r\n            @touchend=\"endDrag\"\r\n          >\r\n            <image \r\n              class=\"preview-bg\" \r\n              :src=\"customImage\" \r\n              mode=\"aspectFill\"\r\n              :style=\"{\r\n                transform: 'scale(' + (imageScale / 100) + ')',\r\n                transformOrigin: 'center center'\r\n              }\"\r\n            ></image>\r\n            <view class=\"preview-overlay\" :style=\"{ opacity: 1 - opacity / 100 }\"></view>\r\n            \r\n            <!-- 遮罩层：使未选中区域变暗 -->\r\n            <view class=\"mask-layer\">\r\n              <!-- 上部遮罩 -->\r\n              <view class=\"mask-top\" :style=\"{ height: cropArea.top + '%' }\"></view>\r\n              <!-- 中间部分 -->\r\n              <view class=\"mask-middle\" :style=\"{ top: cropArea.top + '%', height: cropArea.height + '%' }\">\r\n                <!-- 左边遮罩 -->\r\n                <view class=\"mask-left\" :style=\"{ width: cropArea.left + '%' }\"></view>\r\n                <!-- 选中区域（透明） -->\r\n                <view class=\"mask-center\" :style=\"{ width: cropArea.width + '%' }\"></view>\r\n                <!-- 右边遮罩 -->\r\n                <view class=\"mask-right\" :style=\"{ width: (100 - cropArea.left - cropArea.width) + '%' }\"></view>\r\n              </view>\r\n              <!-- 下部遮罩 -->\r\n              <view class=\"mask-bottom\" :style=\"{ top: (cropArea.top + cropArea.height) + '%', height: (100 - cropArea.top - cropArea.height) + '%' }\"></view>\r\n            </view>\r\n            \r\n            <!-- 可拖动的裁剪框 -->\r\n            <view \r\n              class=\"crop-box\"\r\n              :style=\"{\r\n                left: cropArea.left + '%',\r\n                top: cropArea.top + '%',\r\n                width: cropArea.width + '%',\r\n                height: cropArea.height + '%'\r\n              }\"\r\n              @touchstart=\"startDrag\"\r\n              @touchmove.stop=\"onDrag\"\r\n              @touchend=\"endDrag\"\r\n            >\r\n              <view class=\"crop-border\"></view>\r\n              <view class=\"crop-corner corner-tl\"></view>\r\n              <view class=\"crop-corner corner-tr\"></view>\r\n              <view class=\"crop-corner corner-bl\"></view>\r\n              <view \r\n                class=\"crop-corner corner-br\"\r\n                @touchstart.stop=\"startResize\"\r\n                @touchmove.stop=\"onResize\"\r\n                @touchend=\"endDrag\"\r\n              ></view>\r\n              <text class=\"crop-hint\">拖动移动，右下角调整大小</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"opacity-control\">\r\n          <text class=\"control-label\">透明度</text>\r\n          <slider \r\n            class=\"slider\"\r\n            :value=\"opacity\" \r\n            @change=\"onOpacityChange\" \r\n            @changing=\"onOpacityChanging\"\r\n            min=\"0\" \r\n            max=\"100\"\r\n            activeColor=\"#2bad81\"\r\n            block-size=\"20\"\r\n          />\r\n          <text class=\"control-value\">{{ opacity }}%</text>\r\n        </view>\r\n\r\n        <!-- 新增：图片缩放控制 -->\r\n        <view class=\"opacity-control\">\r\n          <text class=\"control-label\">底图大小</text>\r\n          <slider \r\n            class=\"slider\"\r\n            :value=\"imageScale\" \r\n            @change=\"onScaleChange\" \r\n            @changing=\"onScaleChanging\"\r\n            min=\"50\" \r\n            max=\"200\"\r\n            activeColor=\"#2bad81\"\r\n            block-size=\"20\"\r\n          />\r\n          <text class=\"control-value\">{{ imageScale }}%</text>\r\n        </view>\r\n\r\n        <view class=\"modal-actions\">\r\n          <button class=\"modal-btn cancel\" @click=\"finishAdjust\">完成</button>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 第二步：填写信息 -->\r\n    <view v-if=\"currentStep === 2\" class=\"step-content\">\r\n      <text class=\"section-title\">填写信件信息</text>\r\n      \r\n      <view class=\"form\">\r\n        <!-- 信件主题 -->\r\n        <view class=\"form-item\">\r\n          <text class=\"form-label\">信件主题</text>\r\n          <input \r\n            class=\"form-input\" \r\n            v-model=\"form.title\" \r\n            placeholder=\"例如：给未来的你\"\r\n            maxlength=\"50\"\r\n          />\r\n        </view>\r\n\r\n        <!-- 预计送达时间 -->\r\n        <view class=\"form-item\">\r\n          <text class=\"form-label\">预计送达时间</text>\r\n          <picker \r\n            mode=\"date\" \r\n            :value=\"form.deliveryDate\" \r\n            @change=\"onDateChange\"\r\n            :start=\"minDate\"\r\n          >\r\n            <view class=\"picker-display\">\r\n              {{ form.deliveryDate || '请选择日期' }}\r\n            </view>\r\n          </picker>\r\n        </view>\r\n\r\n        <!-- 对方手机号 -->\r\n        <view class=\"form-item\">\r\n          <text class=\"form-label\">对方手机号</text>\r\n          <input \r\n            class=\"form-input\" \r\n            v-model=\"form.phone\" \r\n            placeholder=\"请输入手机号\"\r\n            type=\"number\"\r\n            maxlength=\"11\"\r\n          />\r\n        </view>\r\n\r\n        <!-- 对方微信号 -->\r\n        <view class=\"form-item\">\r\n          <text class=\"form-label\">对方微信号</text>\r\n          <input \r\n            class=\"form-input\" \r\n            v-model=\"form.wechat\" \r\n            placeholder=\"请输入微信号（选填）\"\r\n          />\r\n        </view>\r\n\r\n        <!-- 信件内容 -->\r\n        <view class=\"form-item\">\r\n          <text class=\"form-label\">信件内容</text>\r\n          <textarea \r\n            class=\"form-textarea\" \r\n            v-model=\"form.content\" \r\n            placeholder=\"写下你想说的话...\"\r\n            maxlength=\"1000\"\r\n          />\r\n          <text class=\"char-count\">{{ form.content.length }}/1000</text>\r\n        </view>\r\n      </view>\r\n\r\n      <view class=\"action-btns\">\r\n        <button class=\"back-btn\" @click=\"prevStep\">上一步</button>\r\n        <button class=\"preview-btn\" @click=\"openPreview\">👁️ 预览</button>\r\n        <button class=\"submit-btn\" @click=\"submitLetter\">提交信件</button>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 预览弹窗 -->\r\n    <view v-if=\"showLivePreviewModal\" class=\"preview-modal-overlay\" @click=\"showLivePreviewModal = false\">\r\n      <view class=\"preview-modal-content\" @click.stop>\r\n        <text class=\"preview-modal-title\">信件预览</text>\r\n        \r\n        <!-- 信件融合预览 -->\r\n        <view class=\"letter-preview\">\r\n          <view class=\"letter-wrapper\">\r\n            <!-- 底图层 -->\r\n            <image \r\n              class=\"letter-bg\" \r\n              :src=\"letterBackground\" \r\n              mode=\"aspectFill\"\r\n              :style=\"{\r\n                transform: 'scale(' + (imageScale / 100) + ')',\r\n                transformOrigin: 'center center'\r\n              }\"\r\n            ></image>\r\n            \r\n            <!-- 透明度遮罩 -->\r\n            <view class=\"letter-overlay\" :style=\"{ opacity: 1 - opacity / 100 }\"></view>\r\n            \r\n            <!-- 信件内容层 -->\r\n            <view class=\"letter-content\">\r\n              <view class=\"letter-header\">\r\n                <text class=\"letter-title\">{{ form.title || '信件主题' }}</text>\r\n                <text class=\"letter-date\">送达时间：{{ form.deliveryDate || '未选择' }}</text>\r\n              </view>\r\n              \r\n              <view class=\"letter-body\">\r\n                <text class=\"letter-text\">{{ form.content || '信件内容...' }}</text>\r\n              </view>\r\n              \r\n              <view class=\"letter-footer\">\r\n                <text class=\"letter-sign\" v-if=\"form.phone\">—— 给 {{ form.phone.slice(0, 3) }}****{{ form.phone.slice(-4) }}</text>\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 调整控制区域 -->\r\n        <view class=\"preview-controls\">\r\n          <view class=\"opacity-control\">\r\n            <text class=\"control-label\">透明度</text>\r\n            <slider \r\n              class=\"slider\"\r\n              :value=\"opacity\" \r\n              @change=\"onOpacityChange\" \r\n              @changing=\"onOpacityChanging\"\r\n              min=\"0\" \r\n              max=\"100\"\r\n              activeColor=\"#2bad81\"\r\n              block-size=\"20\"\r\n            />\r\n            <text class=\"control-value\">{{ opacity }}%</text>\r\n          </view>\r\n\r\n          <view class=\"opacity-control\">\r\n            <text class=\"control-label\">底图大小</text>\r\n            <slider \r\n              class=\"slider\"\r\n              :value=\"imageScale\" \r\n              @change=\"onScaleChange\" \r\n              @changing=\"onScaleChanging\"\r\n              min=\"50\" \r\n              max=\"200\"\r\n              activeColor=\"#2bad81\"\r\n              block-size=\"20\"\r\n            />\r\n            <text class=\"control-value\">{{ imageScale }}%</text>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"preview-modal-actions\">\r\n          <button class=\"preview-modal-btn adjust\" @click=\"openAdjustFromPreview\">调整底图</button>\r\n          <button class=\"preview-modal-btn close\" @click=\"showLivePreviewModal = false\">关闭</button>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 调整弹窗（透明度+裁剪） -->\r\n    <view v-if=\"showOpacityModal\" class=\"modal-overlay\" @click=\"showOpacityModal = false\">\r\n      <view class=\"modal-content\" @click.stop>\r\n        <text class=\"modal-title\">调整底图</text>\r\n        \r\n        <view class=\"modal-preview\">\r\n          <view \r\n            class=\"preview-wrapper\"\r\n            @touchmove=\"onDrag\"\r\n            @touchend=\"endDrag\"\r\n          >\r\n            <image \r\n              class=\"preview-bg\" \r\n              :src=\"letterBackground\" \r\n              mode=\"aspectFill\"\r\n              :style=\"{\r\n                transform: 'scale(' + (imageScale / 100) + ')',\r\n                transformOrigin: 'center center'\r\n              }\"\r\n            ></image>\r\n            <view class=\"preview-overlay\" :style=\"{ opacity: 1 - opacity / 100 }\"></view>\r\n            \r\n            <!-- 遮罩层：使未选中区域变暗 -->\r\n            <view class=\"mask-layer\" v-if=\"isCustomStyle\">\r\n              <view class=\"mask-top\" :style=\"{ height: cropArea.top + '%' }\"></view>\r\n              <view class=\"mask-middle\" :style=\"{ top: cropArea.top + '%', height: cropArea.height + '%' }\">\r\n                <view class=\"mask-left\" :style=\"{ width: cropArea.left + '%' }\"></view>\r\n                <view class=\"mask-center\" :style=\"{ width: cropArea.width + '%' }\"></view>\r\n                <view class=\"mask-right\" :style=\"{ width: (100 - cropArea.left - cropArea.width) + '%' }\"></view>\r\n              </view>\r\n              <view class=\"mask-bottom\" :style=\"{ top: (cropArea.top + cropArea.height) + '%', height: (100 - cropArea.top - cropArea.height) + '%' }\"></view>\r\n            </view>\r\n            \r\n            <!-- 可拖动的裁剪框 -->\r\n            <view \r\n              v-if=\"isCustomStyle\"\r\n              class=\"crop-box\"\r\n              :style=\"{\r\n                left: cropArea.left + '%',\r\n                top: cropArea.top + '%',\r\n                width: cropArea.width + '%',\r\n                height: cropArea.height + '%'\r\n              }\"\r\n              @touchstart=\"startDrag\"\r\n              @touchmove.stop=\"onDrag\"\r\n              @touchend=\"endDrag\"\r\n            >\r\n              <view class=\"crop-border\"></view>\r\n              <view class=\"crop-corner corner-tl\"></view>\r\n              <view class=\"crop-corner corner-tr\"></view>\r\n              <view class=\"crop-corner corner-bl\"></view>\r\n              <view \r\n                class=\"crop-corner corner-br\"\r\n                @touchstart.stop=\"startResize\"\r\n                @touchmove.stop=\"onResize\"\r\n                @touchend=\"endDrag\"\r\n              ></view>\r\n              <text class=\"crop-hint\">拖动移动，右下角调整大小</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"opacity-control\">\r\n          <text class=\"control-label\">透明度</text>\r\n          <slider \r\n            class=\"slider\"\r\n            :value=\"opacity\" \r\n            @change=\"onOpacityChange\" \r\n            @changing=\"onOpacityChanging\"\r\n            min=\"0\" \r\n            max=\"100\"\r\n            activeColor=\"#2bad81\"\r\n            block-size=\"20\"\r\n          />\r\n          <text class=\"control-value\">{{ opacity }}%</text>\r\n        </view>\r\n\r\n        <!-- 新增：图片缩放控制 -->\r\n        <view class=\"opacity-control\">\r\n          <text class=\"control-label\">底图大小</text>\r\n          <slider \r\n            class=\"slider\"\r\n            :value=\"imageScale\" \r\n            @change=\"onScaleChange\" \r\n            @changing=\"onScaleChanging\"\r\n            min=\"50\" \r\n            max=\"200\"\r\n            activeColor=\"#2bad81\"\r\n            block-size=\"20\"\r\n          />\r\n          <text class=\"control-value\">{{ imageScale }}%</text>\r\n        </view>\r\n\r\n        <view class=\"modal-actions\">\r\n          <button class=\"modal-btn cancel\" @click=\"finishAdjust\">完成</button>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 信件预览弹窗 -->\r\n    <view v-if=\"showPreviewModal\" class=\"preview-modal-overlay\">\r\n      <view class=\"preview-modal-content\" @click.stop>\r\n        <text class=\"preview-modal-title\">信件预览</text>\r\n        \r\n        <!-- 信件融合预览 -->\r\n        <view class=\"letter-preview\">\r\n          <view class=\"letter-wrapper\">\r\n            <!-- 底图层 -->\r\n            <image \r\n              class=\"letter-bg\" \r\n              :src=\"letterBackground\" \r\n              mode=\"aspectFill\"\r\n              :style=\"{\r\n                clipPath: isCustomStyle ? `inset(${cropArea.top}% ${100-cropArea.left-cropArea.width}% ${100-cropArea.top-cropArea.height}% ${cropArea.left}%)` : 'none'\r\n              }\"\r\n            ></image>\r\n            \r\n            <!-- 透明度遮罩 -->\r\n            <view class=\"letter-overlay\" :style=\"{ opacity: 1 - opacity / 100 }\"></view>\r\n            \r\n            <!-- 信件内容层 -->\r\n            <view class=\"letter-content\">\r\n              <view class=\"letter-header\">\r\n                <text class=\"letter-title\">{{ form.title }}</text>\r\n                <text class=\"letter-date\">送达时间：{{ form.deliveryDate }}</text>\r\n              </view>\r\n              \r\n              <view class=\"letter-body\">\r\n                <text class=\"letter-text\">{{ form.content }}</text>\r\n              </view>\r\n              \r\n              <view class=\"letter-footer\">\r\n                <text class=\"letter-sign\">—— 给 {{ form.phone.slice(0, 3) }}****{{ form.phone.slice(-4) }}</text>\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"preview-modal-actions\">\r\n          <button class=\"preview-modal-btn confirm\" @click=\"closePreviewAndBack\">确认</button>\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      currentStep: 1,\r\n      selectedStyle: 1,\r\n      isCustomStyle: false,\r\n      customImage: '',\r\n      opacity: 100,\r\n      showOpacityModal: false,\r\n      showPreviewModal: false,\r\n      showLivePreviewModal: false,\r\n      // 裁剪区域相关\r\n      cropArea: {\r\n        left: 0,\r\n        top: 0,\r\n        width: 100,\r\n        height: 100\r\n      },\r\n      // 底图缩放比例（100% 为原始大小）\r\n      imageScale: 100,\r\n      // 是否从预览打开的调整弹窗\r\n      fromPreview: false,\r\n      isDragging: false,\r\n      isResizing: false,\r\n      dragStart: { x: 0, y: 0 },\r\n      imageInfo: { width: 0, height: 0 },\r\n      form: {\r\n        title: '',\r\n        deliveryDate: '',\r\n        phone: '',\r\n        wechat: '',\r\n        content: ''\r\n      }\r\n    };\r\n  },\r\n  computed: {\r\n    minDate() {\r\n      const today = new Date();\r\n      const year = today.getFullYear();\r\n      const month = String(today.getMonth() + 1).padStart(2, '0');\r\n      const day = String(today.getDate()).padStart(2, '0');\r\n      return `${year}-${month}-${day}`;\r\n    },\r\n    // 获取信件底图路径\r\n    letterBackground() {\r\n      if (this.isCustomStyle) {\r\n        return this.customImage;\r\n      }\r\n      return `/static/xinxiang/xin${this.selectedStyle}.jpg`;\r\n    }\r\n  },\r\n  methods: {\r\n    // 选择预设样式\r\n    selectPresetStyle(index) {\r\n      this.selectedStyle = index;\r\n      this.isCustomStyle = false;\r\n      this.customImage = '';\r\n    },\r\n    \r\n    // 上传自定义图片\r\n    uploadCustom() {\r\n      uni.chooseImage({\r\n        count: 1,\r\n        sizeType: ['compressed'],\r\n        sourceType: ['album', 'camera'],\r\n        success: (res) => {\r\n          this.customImage = res.tempFilePaths[0];\r\n          this.isCustomStyle = true;\r\n          this.opacity = 100;\r\n          // 重置裁剪区域\r\n          this.cropArea = {\r\n            left: 10,\r\n            top: 10,\r\n            width: 80,\r\n            height: 80\r\n          };\r\n          // 获取图片信息\r\n          uni.getImageInfo({\r\n            src: res.tempFilePaths[0],\r\n            success: (info) => {\r\n              this.imageInfo = {\r\n                width: info.width,\r\n                height: info.height\r\n              };\r\n            }\r\n          });\r\n          this.showOpacityModal = true;\r\n          uni.showToast({ title: '自定义底图已选择', icon: 'success' });\r\n        }\r\n      });\r\n    },\r\n    \r\n    // 调整透明度（滑动中）\r\n    onOpacityChanging(e) {\r\n      this.opacity = e.detail.value;\r\n    },\r\n    \r\n    // 调整透明度（松开）\r\n    onOpacityChange(e) {\r\n      this.opacity = e.detail.value;\r\n    },\r\n    \r\n    // 调整图片缩放（滑动中）\r\n    onScaleChanging(e) {\r\n      this.imageScale = e.detail.value;\r\n    },\r\n    \r\n    // 调整图片缩放（松开）\r\n    onScaleChange(e) {\r\n      this.imageScale = e.detail.value;\r\n    },\r\n    \r\n    // 开始拖动裁剪框\r\n    startDrag(e) {\r\n      this.isDragging = true;\r\n      this.dragStart = {\r\n        x: e.touches[0].clientX,\r\n        y: e.touches[0].clientY\r\n      };\r\n    },\r\n    \r\n    // 拖动裁剪框\r\n    onDrag(e) {\r\n      if (!this.isDragging) return;\r\n      \r\n      const deltaX = e.touches[0].clientX - this.dragStart.x;\r\n      const deltaY = e.touches[0].clientY - this.dragStart.y;\r\n      \r\n      // 转换为百分比（假设预览区域宽度为 600rpx）\r\n      const percentX = (deltaX / 600) * 100;\r\n      const percentY = (deltaY / 600) * 100;\r\n      \r\n      let newLeft = this.cropArea.left + percentX;\r\n      let newTop = this.cropArea.top + percentY;\r\n      \r\n      // 边界限制\r\n      newLeft = Math.max(0, Math.min(100 - this.cropArea.width, newLeft));\r\n      newTop = Math.max(0, Math.min(100 - this.cropArea.height, newTop));\r\n      \r\n      this.cropArea.left = newLeft;\r\n      this.cropArea.top = newTop;\r\n      \r\n      this.dragStart = {\r\n        x: e.touches[0].clientX,\r\n        y: e.touches[0].clientY\r\n      };\r\n    },\r\n    \r\n    // 结束拖动\r\n    endDrag() {\r\n      this.isDragging = false;\r\n      this.isResizing = false;\r\n    },\r\n    \r\n    // 开始调整大小\r\n    startResize(e) {\r\n      this.isResizing = true;\r\n      this.dragStart = {\r\n        x: e.touches[0].clientX,\r\n        y: e.touches[0].clientY\r\n      };\r\n      e.stopPropagation();\r\n    },\r\n    \r\n    // 调整大小\r\n    onResize(e) {\r\n      if (!this.isResizing) return;\r\n      \r\n      const deltaX = e.touches[0].clientX - this.dragStart.x;\r\n      const deltaY = e.touches[0].clientY - this.dragStart.y;\r\n      \r\n      const percentX = (deltaX / 600) * 100;\r\n      const percentY = (deltaY / 600) * 100;\r\n      \r\n      let newWidth = this.cropArea.width + percentX;\r\n      let newHeight = this.cropArea.height + percentY;\r\n      \r\n      // 边界限制\r\n      newWidth = Math.max(20, Math.min(100 - this.cropArea.left, newWidth));\r\n      newHeight = Math.max(20, Math.min(100 - this.cropArea.top, newHeight));\r\n      \r\n      this.cropArea.width = newWidth;\r\n      this.cropArea.height = newHeight;\r\n      \r\n      this.dragStart = {\r\n        x: e.touches[0].clientX,\r\n        y: e.touches[0].clientY\r\n      };\r\n      \r\n      e.stopPropagation();\r\n    },\r\n    \r\n    // 打开预览弹窗\r\n    openPreview() {\r\n      this.showLivePreviewModal = true;\r\n    },\r\n    \r\n    // 完成调整（智能判断是否需要返回预览）\r\n    finishAdjust() {\r\n      this.showOpacityModal = false;\r\n      // 如果是从预览打开的，返回预览；否则关闭modal\r\n      if (this.fromPreview) {\r\n        this.showLivePreviewModal = true;\r\n        this.fromPreview = false;\r\n      }\r\n    },\r\n    \r\n    // 从预览打开调整弹窗\r\n    openAdjustFromPreview() {\r\n      this.fromPreview = true;\r\n      this.showLivePreviewModal = false;\r\n      this.showOpacityModal = true;\r\n    },\r\n    \r\n    // 日期选择\r\n    onDateChange(e) {\r\n      this.form.deliveryDate = e.detail.value;\r\n    },\r\n    \r\n    // 下一步\r\n    nextStep() {\r\n      if (!this.selectedStyle && !this.isCustomStyle) {\r\n        uni.showToast({ title: '请选择信件样式', icon: 'none' });\r\n        return;\r\n      }\r\n      this.currentStep = 2;\r\n    },\r\n    \r\n    // 上一步\r\n    prevStep() {\r\n      this.currentStep = 1;\r\n    },\r\n    \r\n    // 提交信件\r\n    submitLetter() {\r\n      // 验证必填项\r\n      if (!this.form.title) {\r\n        uni.showToast({ title: '请填写信件主题', icon: 'none' });\r\n        return;\r\n      }\r\n      if (!this.form.deliveryDate) {\r\n        uni.showToast({ title: '请选择送达时间', icon: 'none' });\r\n        return;\r\n      }\r\n      if (!this.form.phone) {\r\n        uni.showToast({ title: '请填写手机号', icon: 'none' });\r\n        return;\r\n      }\r\n      if (this.form.phone.length !== 11) {\r\n        uni.showToast({ title: '请输入正确的手机号', icon: 'none' });\r\n        return;\r\n      }\r\n      if (!this.form.content) {\r\n        uni.showToast({ title: '请填写信件内容', icon: 'none' });\r\n        return;\r\n      }\r\n\r\n      // 构建信件数据\r\n      const letterData = {\r\n        style: this.isCustomStyle ? 'custom' : this.selectedStyle,\r\n        customImage: this.customImage,\r\n        opacity: this.opacity,\r\n        cropArea: this.cropArea,\r\n        title: this.form.title,\r\n        deliveryDate: this.form.deliveryDate,\r\n        phone: this.form.phone,\r\n        wechat: this.form.wechat,\r\n        content: this.form.content,\r\n        createTime: new Date().toLocaleString()\r\n      };\r\n\r\n      // 保存到本地存储\r\n      try {\r\n        const letters = uni.getStorageSync('xinxiang_letters') || [];\r\n        letters.unshift(letterData);\r\n        uni.setStorageSync('xinxiang_letters', letters);\r\n        \r\n        // 显示预览弹窗\r\n        this.showPreviewModal = true;\r\n      } catch (e) {\r\n        uni.showToast({ title: '提交失败，请重试', icon: 'none' });\r\n      }\r\n    },\r\n    \r\n    // 关闭预览弹窗并返回\r\n    closePreviewAndBack() {\r\n      this.showPreviewModal = false;\r\n      setTimeout(() => {\r\n        uni.navigateBack();\r\n      }, 300);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.create-page {\r\n  min-height: 100vh;\r\n  background: #f5f5f5;\r\n  padding: 24rpx;\r\n  padding-bottom: 120rpx;\r\n}\r\n\r\n/* 步骤指示器 */\r\n.steps {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 32rpx 0;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.step {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 8rpx;\r\n}\r\n\r\n.step-number {\r\n  width: 60rpx;\r\n  height: 60rpx;\r\n  border-radius: 50%;\r\n  background: #e5e5e5;\r\n  color: #999;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 24rpx;\r\n  font-weight: 600;\r\n}\r\n\r\n.step.active .step-number {\r\n  background: #2bad81;\r\n  color: #ffffff;\r\n}\r\n\r\n.step-text {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n}\r\n\r\n.step.active .step-text {\r\n  color: #2bad81;\r\n  font-weight: 600;\r\n}\r\n\r\n.step-line {\r\n  width: 120rpx;\r\n  height: 2rpx;\r\n  background: #e5e5e5;\r\n  margin: 0 20rpx;\r\n  margin-bottom: 28rpx;\r\n}\r\n\r\n/* 内容区域 */\r\n.step-content {\r\n  background: #ffffff;\r\n  border-radius: 24rpx;\r\n  padding: 32rpx;\r\n}\r\n\r\n.section-title {\r\n  font-size: 32rpx;\r\n  font-weight: 700;\r\n  color: #333;\r\n  display: block;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n/* 样式网格 */\r\n.style-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(3, 1fr);\r\n  gap: 16rpx;\r\n  margin-bottom: 32rpx;\r\n}\r\n\r\n.style-item {\r\n  position: relative;\r\n  aspect-ratio: 1;\r\n  border-radius: 16rpx;\r\n  overflow: hidden;\r\n  border: 3rpx solid transparent;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.style-item.selected {\r\n  border-color: #2bad81;\r\n  box-shadow: 0 4rpx 12rpx rgba(43, 173, 129, 0.3);\r\n}\r\n\r\n.style-image {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.check-mark {\r\n  position: absolute;\r\n  top: 8rpx;\r\n  right: 8rpx;\r\n  width: 40rpx;\r\n  height: 40rpx;\r\n  border-radius: 50%;\r\n  background: #2bad81;\r\n  color: #ffffff;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 24rpx;\r\n}\r\n\r\n/* 自定义样式 */\r\n.custom-section {\r\n  margin-bottom: 32rpx;\r\n}\r\n\r\n.custom-btn {\r\n  width: 100%;\r\n  padding: 24rpx;\r\n  background: linear-gradient(135deg, #f0f0f0 0%, #e5e5e5 100%);\r\n  border-radius: 16rpx;\r\n  border: 2rpx dashed #999;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 12rpx;\r\n  font-size: 28rpx;\r\n  color: #666;\r\n}\r\n\r\n.btn-icon {\r\n  font-size: 36rpx;\r\n}\r\n\r\n.custom-preview {\r\n  margin-top: 20rpx;\r\n  border-radius: 16rpx;\r\n  overflow: hidden;\r\n  border: 2rpx solid #2bad81;\r\n  cursor: pointer;\r\n}\r\n\r\n.preview-wrapper {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 400rpx;\r\n  overflow: hidden;\r\n}\r\n\r\n.preview-bg {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.preview-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: #ffffff;\r\n  pointer-events: none;\r\n}\r\n\r\n/* 裁剪框预览 */\r\n.crop-preview {\r\n  position: absolute;\r\n  border: 2rpx solid #2bad81;\r\n  box-sizing: border-box;\r\n  pointer-events: none;\r\n}\r\n\r\n/* 遮罩层 - 让未选中区域变暗 */\r\n.mask-layer {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  pointer-events: none;\r\n}\r\n\r\n.mask-top,\r\n.mask-bottom {\r\n  position: absolute;\r\n  left: 0;\r\n  width: 100%;\r\n  background: rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.mask-top {\r\n  top: 0;\r\n}\r\n\r\n.mask-middle {\r\n  position: absolute;\r\n  left: 0;\r\n  width: 100%;\r\n  display: flex;\r\n}\r\n\r\n.mask-left,\r\n.mask-right {\r\n  background: rgba(0, 0, 0, 0.5);\r\n  height: 100%;\r\n}\r\n\r\n.mask-center {\r\n  height: 100%;\r\n  /* 透明，显示选中区域 */\r\n}\r\n\r\n.preview-tip {\r\n  display: block;\r\n  text-align: center;\r\n  padding: 16rpx;\r\n  background: #f5f5f5;\r\n  color: #2bad81;\r\n  font-size: 24rpx;\r\n}\r\n\r\n/* 透明度调整弹窗 */\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.6);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.modal-content {\r\n  width: 90%;\r\n  max-width: 600rpx;\r\n  background: #ffffff;\r\n  border-radius: 24rpx;\r\n  padding: 32rpx;\r\n  box-shadow: 0 8rpx 32rpx rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.modal-title {\r\n  font-size: 32rpx;\r\n  font-weight: 700;\r\n  color: #333;\r\n  display: block;\r\n  text-align: center;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.modal-preview {\r\n  margin-bottom: 24rpx;\r\n  border-radius: 16rpx;\r\n  overflow: hidden;\r\n}\r\n\r\n.modal-preview .preview-wrapper {\r\n  height: 400rpx;\r\n  position: relative;\r\n}\r\n\r\n/* 可拖动裁剪框 */\r\n.crop-box {\r\n  position: absolute;\r\n  touch-action: none;\r\n  cursor: move;\r\n}\r\n\r\n.crop-border {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  border: 3rpx solid #2bad81;\r\n  box-sizing: border-box;\r\n  background: rgba(43, 173, 129, 0.1);\r\n}\r\n\r\n.crop-corner {\r\n  position: absolute;\r\n  width: 20rpx;\r\n  height: 20rpx;\r\n  background: #2bad81;\r\n  border: 2rpx solid #ffffff;\r\n  border-radius: 50%;\r\n}\r\n\r\n.corner-tl {\r\n  top: -10rpx;\r\n  left: -10rpx;\r\n}\r\n\r\n.corner-tr {\r\n  top: -10rpx;\r\n  right: -10rpx;\r\n}\r\n\r\n.corner-bl {\r\n  bottom: -10rpx;\r\n  left: -10rpx;\r\n}\r\n\r\n.corner-br {\r\n  bottom: -10rpx;\r\n  right: -10rpx;\r\n  width: 30rpx;\r\n  height: 30rpx;\r\n  background: #2bad81;\r\n  cursor: se-resize;\r\n}\r\n\r\n.crop-hint {\r\n  position: absolute;\r\n  bottom: -40rpx;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  font-size: 22rpx;\r\n  color: #2bad81;\r\n  white-space: nowrap;\r\n  background: rgba(255, 255, 255, 0.9);\r\n  padding: 4rpx 12rpx;\r\n  border-radius: 8rpx;\r\n}\r\n\r\n.opacity-control {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 16rpx;\r\n  padding: 24rpx;\r\n  background: #f5f5f5;\r\n  border-radius: 16rpx;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.opacity-control .control-label {\r\n  font-size: 26rpx;\r\n  color: #666;\r\n  width: 100rpx;\r\n}\r\n\r\n.opacity-control .slider {\r\n  flex: 1;\r\n}\r\n\r\n.opacity-control .control-value {\r\n  font-size: 28rpx;\r\n  color: #2bad81;\r\n  font-weight: 700;\r\n  width: 80rpx;\r\n  text-align: right;\r\n}\r\n\r\n.modal-actions {\r\n  display: flex;\r\n  gap: 16rpx;\r\n}\r\n\r\n.modal-btn {\r\n  flex: 1;\r\n  padding: 20rpx;\r\n  border-radius: 12rpx;\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n}\r\n\r\n.modal-btn.cancel {\r\n  background: #2bad81;\r\n  color: #ffffff;\r\n}\r\n\r\n/* 表单 */\r\n.form {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 24rpx;\r\n}\r\n.form {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 24rpx;\r\n}\r\n\r\n.form-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12rpx;\r\n}\r\n\r\n.form-label {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  font-weight: 600;\r\n}\r\n\r\n.form-input,\r\n.picker-display {\r\n  padding: 20rpx;\r\n  background: #f5f5f5;\r\n  border-radius: 12rpx;\r\n  font-size: 26rpx;\r\n  border: 1rpx solid #e5e5e5;\r\n}\r\n\r\n.picker-display {\r\n  color: #333;\r\n}\r\n\r\n.form-textarea {\r\n  min-height: 300rpx;\r\n  padding: 20rpx;\r\n  background: #f5f5f5;\r\n  border-radius: 12rpx;\r\n  font-size: 26rpx;\r\n  border: 1rpx solid #e5e5e5;\r\n}\r\n\r\n.char-count {\r\n  font-size: 22rpx;\r\n  color: #999;\r\n  text-align: right;\r\n}\r\n\r\n/* 按钮 */\r\n.next-btn {\r\n  width: 100%;\r\n  padding: 24rpx;\r\n  background: #2bad81;\r\n  color: #ffffff;\r\n  border-radius: 16rpx;\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n  margin-top: 40rpx;\r\n}\r\n\r\n.action-btns {\r\n  display: flex;\r\n  gap: 16rpx;\r\n  margin-top: 40rpx;\r\n}\r\n\r\n.back-btn,\r\n.preview-btn,\r\n.submit-btn {\r\n  flex: 1;\r\n  padding: 24rpx;\r\n  border-radius: 16rpx;\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n}\r\n\r\n.back-btn {\r\n  background: #f0f0f0;\r\n  color: #666;\r\n}\r\n\r\n.preview-btn {\r\n  background: linear-gradient(135deg, #2bad81 0%, #25a172 100%);\r\n  color: #ffffff;\r\n}\r\n\r\n.submit-btn {\r\n  background: #2bad81;\r\n  color: #ffffff;\r\n}\r\n\r\n.preview-modal-btn.adjust {\r\n  background: #f0f0f0;\r\n  color: #666;\r\n}\r\n\r\n.preview-modal-btn.close {\r\n  background: #2bad81;\r\n  color: #ffffff;\r\n}\r\n\r\n/* 信件预览弹窗 */\r\n.preview-modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.8);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 2000;\r\n}\r\n\r\n.preview-modal-content {\r\n  width: 90%;\r\n  max-width: 650rpx;\r\n  background: #ffffff;\r\n  border-radius: 24rpx;\r\n  padding: 32rpx;\r\n  box-shadow: 0 8rpx 32rpx rgba(0, 0, 0, 0.3);\r\n  max-height: 90vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.preview-modal-title {\r\n  font-size: 32rpx;\r\n  font-weight: 700;\r\n  color: #333;\r\n  display: block;\r\n  text-align: center;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.letter-preview {\r\n  flex: 1;\r\n  overflow: hidden;\r\n  border-radius: 16rpx;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.letter-wrapper {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 800rpx;\r\n  border-radius: 16rpx;\r\n  overflow: hidden;\r\n  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.letter-bg {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: 0;\r\n}\r\n\r\n.letter-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: #ffffff;\r\n  z-index: 1;\r\n}\r\n\r\n.letter-content {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 60rpx 40rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  z-index: 2;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.letter-header {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12rpx;\r\n  margin-bottom: 40rpx;\r\n  padding-bottom: 24rpx;\r\n  border-bottom: 2rpx solid rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.letter-title {\r\n  font-size: 36rpx;\r\n  font-weight: 700;\r\n  color: #333;\r\n}\r\n\r\n.letter-date {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n}\r\n\r\n.letter-body {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  margin-bottom: 32rpx;\r\n}\r\n\r\n.letter-text {\r\n  font-size: 28rpx;\r\n  line-height: 2;\r\n  color: #333;\r\n  white-space: pre-wrap;\r\n  word-break: break-all;\r\n}\r\n\r\n.letter-footer {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  padding-top: 24rpx;\r\n  border-top: 2rpx solid rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.letter-sign {\r\n  font-size: 26rpx;\r\n  color: #666;\r\n  font-style: italic;\r\n}\r\n\r\n.preview-modal-actions {\r\n  display: flex;\r\n  gap: 16rpx;\r\n}\r\n\r\n.preview-modal-btn {\r\n  flex: 1;\r\n  padding: 24rpx;\r\n  border-radius: 12rpx;\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n}\r\n\r\n.preview-modal-btn.confirm {\r\n  background: #2bad81;\r\n  color: #ffffff;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'C:/Users/Administrator/Desktop/love_time/pages/xinxiang/create.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AA+dA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,aAAa;AAAA,MACb,eAAe;AAAA,MACf,eAAe;AAAA,MACf,aAAa;AAAA,MACb,SAAS;AAAA,MACT,kBAAkB;AAAA,MAClB,kBAAkB;AAAA,MAClB,sBAAsB;AAAA;AAAA,MAEtB,UAAU;AAAA,QACR,MAAM;AAAA,QACN,KAAK;AAAA,QACL,OAAO;AAAA,QACP,QAAQ;AAAA,MACT;AAAA;AAAA,MAED,YAAY;AAAA;AAAA,MAEZ,aAAa;AAAA,MACb,YAAY;AAAA,MACZ,YAAY;AAAA,MACZ,WAAW,EAAE,GAAG,GAAG,GAAG,EAAG;AAAA,MACzB,WAAW,EAAE,OAAO,GAAG,QAAQ,EAAG;AAAA,MAClC,MAAM;AAAA,QACJ,OAAO;AAAA,QACP,cAAc;AAAA,QACd,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,SAAS;AAAA,MACX;AAAA;EAEH;AAAA,EACD,UAAU;AAAA,IACR,UAAU;AACR,YAAM,QAAQ,oBAAI;AAClB,YAAM,OAAO,MAAM;AACnB,YAAM,QAAQ,OAAO,MAAM,SAAQ,IAAK,CAAC,EAAE,SAAS,GAAG,GAAG;AAC1D,YAAM,MAAM,OAAO,MAAM,QAAS,CAAA,EAAE,SAAS,GAAG,GAAG;AACnD,aAAO,GAAG,IAAI,IAAI,KAAK,IAAI,GAAG;AAAA,IAC/B;AAAA;AAAA,IAED,mBAAmB;AACjB,UAAI,KAAK,eAAe;AACtB,eAAO,KAAK;AAAA,MACd;AACA,aAAO,uBAAuB,KAAK,aAAa;AAAA,IAClD;AAAA,EACD;AAAA,EACD,SAAS;AAAA;AAAA,IAEP,kBAAkB,OAAO;AACvB,WAAK,gBAAgB;AACrB,WAAK,gBAAgB;AACrB,WAAK,cAAc;AAAA,IACpB;AAAA;AAAA,IAGD,eAAe;AACbA,oBAAAA,MAAI,YAAY;AAAA,QACd,OAAO;AAAA,QACP,UAAU,CAAC,YAAY;AAAA,QACvB,YAAY,CAAC,SAAS,QAAQ;AAAA,QAC9B,SAAS,CAAC,QAAQ;AAChB,eAAK,cAAc,IAAI,cAAc,CAAC;AACtC,eAAK,gBAAgB;AACrB,eAAK,UAAU;AAEf,eAAK,WAAW;AAAA,YACd,MAAM;AAAA,YACN,KAAK;AAAA,YACL,OAAO;AAAA,YACP,QAAQ;AAAA;AAGVA,wBAAAA,MAAI,aAAa;AAAA,YACf,KAAK,IAAI,cAAc,CAAC;AAAA,YACxB,SAAS,CAAC,SAAS;AACjB,mBAAK,YAAY;AAAA,gBACf,OAAO,KAAK;AAAA,gBACZ,QAAQ,KAAK;AAAA;YAEjB;AAAA,UACF,CAAC;AACD,eAAK,mBAAmB;AACxBA,wBAAG,MAAC,UAAU,EAAE,OAAO,YAAY,MAAM,UAAU,CAAC;AAAA,QACtD;AAAA,MACF,CAAC;AAAA,IACF;AAAA;AAAA,IAGD,kBAAkB,GAAG;AACnB,WAAK,UAAU,EAAE,OAAO;AAAA,IACzB;AAAA;AAAA,IAGD,gBAAgB,GAAG;AACjB,WAAK,UAAU,EAAE,OAAO;AAAA,IACzB;AAAA;AAAA,IAGD,gBAAgB,GAAG;AACjB,WAAK,aAAa,EAAE,OAAO;AAAA,IAC5B;AAAA;AAAA,IAGD,cAAc,GAAG;AACf,WAAK,aAAa,EAAE,OAAO;AAAA,IAC5B;AAAA;AAAA,IAGD,UAAU,GAAG;AACX,WAAK,aAAa;AAClB,WAAK,YAAY;AAAA,QACf,GAAG,EAAE,QAAQ,CAAC,EAAE;AAAA,QAChB,GAAG,EAAE,QAAQ,CAAC,EAAE;AAAA;IAEnB;AAAA;AAAA,IAGD,OAAO,GAAG;AACR,UAAI,CAAC,KAAK;AAAY;AAEtB,YAAM,SAAS,EAAE,QAAQ,CAAC,EAAE,UAAU,KAAK,UAAU;AACrD,YAAM,SAAS,EAAE,QAAQ,CAAC,EAAE,UAAU,KAAK,UAAU;AAGrD,YAAM,WAAY,SAAS,MAAO;AAClC,YAAM,WAAY,SAAS,MAAO;AAElC,UAAI,UAAU,KAAK,SAAS,OAAO;AACnC,UAAI,SAAS,KAAK,SAAS,MAAM;AAGjC,gBAAU,KAAK,IAAI,GAAG,KAAK,IAAI,MAAM,KAAK,SAAS,OAAO,OAAO,CAAC;AAClE,eAAS,KAAK,IAAI,GAAG,KAAK,IAAI,MAAM,KAAK,SAAS,QAAQ,MAAM,CAAC;AAEjE,WAAK,SAAS,OAAO;AACrB,WAAK,SAAS,MAAM;AAEpB,WAAK,YAAY;AAAA,QACf,GAAG,EAAE,QAAQ,CAAC,EAAE;AAAA,QAChB,GAAG,EAAE,QAAQ,CAAC,EAAE;AAAA;IAEnB;AAAA;AAAA,IAGD,UAAU;AACR,WAAK,aAAa;AAClB,WAAK,aAAa;AAAA,IACnB;AAAA;AAAA,IAGD,YAAY,GAAG;AACb,WAAK,aAAa;AAClB,WAAK,YAAY;AAAA,QACf,GAAG,EAAE,QAAQ,CAAC,EAAE;AAAA,QAChB,GAAG,EAAE,QAAQ,CAAC,EAAE;AAAA;AAElB,QAAE,gBAAe;AAAA,IAClB;AAAA;AAAA,IAGD,SAAS,GAAG;AACV,UAAI,CAAC,KAAK;AAAY;AAEtB,YAAM,SAAS,EAAE,QAAQ,CAAC,EAAE,UAAU,KAAK,UAAU;AACrD,YAAM,SAAS,EAAE,QAAQ,CAAC,EAAE,UAAU,KAAK,UAAU;AAErD,YAAM,WAAY,SAAS,MAAO;AAClC,YAAM,WAAY,SAAS,MAAO;AAElC,UAAI,WAAW,KAAK,SAAS,QAAQ;AACrC,UAAI,YAAY,KAAK,SAAS,SAAS;AAGvC,iBAAW,KAAK,IAAI,IAAI,KAAK,IAAI,MAAM,KAAK,SAAS,MAAM,QAAQ,CAAC;AACpE,kBAAY,KAAK,IAAI,IAAI,KAAK,IAAI,MAAM,KAAK,SAAS,KAAK,SAAS,CAAC;AAErE,WAAK,SAAS,QAAQ;AACtB,WAAK,SAAS,SAAS;AAEvB,WAAK,YAAY;AAAA,QACf,GAAG,EAAE,QAAQ,CAAC,EAAE;AAAA,QAChB,GAAG,EAAE,QAAQ,CAAC,EAAE;AAAA;AAGlB,QAAE,gBAAe;AAAA,IAClB;AAAA;AAAA,IAGD,cAAc;AACZ,WAAK,uBAAuB;AAAA,IAC7B;AAAA;AAAA,IAGD,eAAe;AACb,WAAK,mBAAmB;AAExB,UAAI,KAAK,aAAa;AACpB,aAAK,uBAAuB;AAC5B,aAAK,cAAc;AAAA,MACrB;AAAA,IACD;AAAA;AAAA,IAGD,wBAAwB;AACtB,WAAK,cAAc;AACnB,WAAK,uBAAuB;AAC5B,WAAK,mBAAmB;AAAA,IACzB;AAAA;AAAA,IAGD,aAAa,GAAG;AACd,WAAK,KAAK,eAAe,EAAE,OAAO;AAAA,IACnC;AAAA;AAAA,IAGD,WAAW;AACT,UAAI,CAAC,KAAK,iBAAiB,CAAC,KAAK,eAAe;AAC9CA,sBAAG,MAAC,UAAU,EAAE,OAAO,WAAW,MAAM,OAAK,CAAG;AAChD;AAAA,MACF;AACA,WAAK,cAAc;AAAA,IACpB;AAAA;AAAA,IAGD,WAAW;AACT,WAAK,cAAc;AAAA,IACpB;AAAA;AAAA,IAGD,eAAe;AAEb,UAAI,CAAC,KAAK,KAAK,OAAO;AACpBA,sBAAG,MAAC,UAAU,EAAE,OAAO,WAAW,MAAM,OAAK,CAAG;AAChD;AAAA,MACF;AACA,UAAI,CAAC,KAAK,KAAK,cAAc;AAC3BA,sBAAG,MAAC,UAAU,EAAE,OAAO,WAAW,MAAM,OAAK,CAAG;AAChD;AAAA,MACF;AACA,UAAI,CAAC,KAAK,KAAK,OAAO;AACpBA,sBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,OAAK,CAAG;AAC/C;AAAA,MACF;AACA,UAAI,KAAK,KAAK,MAAM,WAAW,IAAI;AACjCA,sBAAG,MAAC,UAAU,EAAE,OAAO,aAAa,MAAM,OAAK,CAAG;AAClD;AAAA,MACF;AACA,UAAI,CAAC,KAAK,KAAK,SAAS;AACtBA,sBAAG,MAAC,UAAU,EAAE,OAAO,WAAW,MAAM,OAAK,CAAG;AAChD;AAAA,MACF;AAGA,YAAM,aAAa;AAAA,QACjB,OAAO,KAAK,gBAAgB,WAAW,KAAK;AAAA,QAC5C,aAAa,KAAK;AAAA,QAClB,SAAS,KAAK;AAAA,QACd,UAAU,KAAK;AAAA,QACf,OAAO,KAAK,KAAK;AAAA,QACjB,cAAc,KAAK,KAAK;AAAA,QACxB,OAAO,KAAK,KAAK;AAAA,QACjB,QAAQ,KAAK,KAAK;AAAA,QAClB,SAAS,KAAK,KAAK;AAAA,QACnB,aAAY,oBAAI,KAAM,GAAC,eAAe;AAAA;AAIxC,UAAI;AACF,cAAM,UAAUA,cAAG,MAAC,eAAe,kBAAkB,KAAK,CAAA;AAC1D,gBAAQ,QAAQ,UAAU;AAC1BA,sBAAAA,MAAI,eAAe,oBAAoB,OAAO;AAG9C,aAAK,mBAAmB;AAAA,MAC1B,SAAS,GAAG;AACVA,sBAAG,MAAC,UAAU,EAAE,OAAO,YAAY,MAAM,OAAK,CAAG;AAAA,MACnD;AAAA,IACD;AAAA;AAAA,IAGD,sBAAsB;AACpB,WAAK,mBAAmB;AACxB,iBAAW,MAAM;AACfA,sBAAG,MAAC,aAAY;AAAA,MACjB,GAAE,GAAG;AAAA,IACR;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClwBA,GAAG,WAAW,eAAe;"}