{"version":3,"file":"couple.js","sources":["utils/couple.js"],"sourcesContent":["/**\r\n * 情侣关系工具函数\r\n * 用于管理本地情侣关系信息\r\n */\r\n\r\n/**\r\n * 获取本地情侣信息\r\n * @returns {object|null} 情侣信息对象或null\r\n */\r\nexport function getCoupleInfo() {\r\n  try {\r\n    const coupleInfo = uni.getStorageSync('couple_info');\r\n    return coupleInfo && coupleInfo.isBound ? coupleInfo : null;\r\n  } catch (e) {\r\n    console.error('获取情侣信息失败', e);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * 检查是否已绑定\r\n * @returns {boolean} 是否已绑定\r\n */\r\nexport function isBound() {\r\n  const coupleInfo = getCoupleInfo();\r\n  return coupleInfo !== null;\r\n}\r\n\r\n/**\r\n * 获取对方信息\r\n * @returns {object|null} 对方信息对象或null\r\n */\r\nexport function getPartnerInfo() {\r\n  const coupleInfo = getCoupleInfo();\r\n  return coupleInfo && coupleInfo.partnerInfo ? coupleInfo.partnerInfo : null;\r\n}\r\n\r\n/**\r\n * 保存情侣信息到本地\r\n * @param {object} coupleData - 情侣信息对象\r\n * @param {boolean} coupleData.isBound - 是否已绑定\r\n * @param {string} coupleData.coupleId - 关系ID\r\n * @param {string} coupleData.partnerId - 对方用户ID\r\n * @param {object} coupleData.partnerInfo - 对方用户信息\r\n * @param {string} coupleData.bindTime - 绑定时间\r\n * @param {string} coupleData.role - 角色：initiator/accepter\r\n * @returns {boolean} 是否保存成功\r\n */\r\nexport function saveCoupleInfo(coupleData) {\r\n  try {\r\n    const coupleInfo = {\r\n      isBound: coupleData.isBound || false,\r\n      coupleId: coupleData.coupleId || '',\r\n      partnerId: coupleData.partnerId || '',\r\n      partnerInfo: coupleData.partnerInfo || null,\r\n      bindTime: coupleData.bindTime || '',\r\n      role: coupleData.role || '',\r\n      inviteCode: coupleData.inviteCode || '',\r\n      inviteCodeExpire: coupleData.inviteCodeExpire || ''\r\n    };\r\n    uni.setStorageSync('couple_info', coupleInfo);\r\n    return true;\r\n  } catch (e) {\r\n    console.error('保存情侣信息失败', e);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * 清除情侣信息\r\n * @returns {boolean} 是否清除成功\r\n */\r\nexport function clearCoupleInfo() {\r\n  try {\r\n    uni.removeStorageSync('couple_info');\r\n    return true;\r\n  } catch (e) {\r\n    console.error('清除情侣信息失败', e);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * 更新邀请码信息\r\n * @param {string} inviteCode - 邀请码\r\n * @param {string} expireAt - 过期时间\r\n * @returns {boolean} 是否更新成功\r\n */\r\nexport function updateInviteCode(inviteCode, expireAt) {\r\n  try {\r\n    const coupleInfo = getCoupleInfo() || {\r\n      isBound: false,\r\n      coupleId: '',\r\n      partnerId: '',\r\n      partnerInfo: null,\r\n      bindTime: '',\r\n      role: ''\r\n    };\r\n    coupleInfo.inviteCode = inviteCode;\r\n    coupleInfo.inviteCodeExpire = expireAt;\r\n    return saveCoupleInfo(coupleInfo);\r\n  } catch (e) {\r\n    console.error('更新邀请码失败', e);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * 获取关系ID\r\n * @returns {string|null} 关系ID或null\r\n */\r\nexport function getCoupleId() {\r\n  const coupleInfo = getCoupleInfo();\r\n  return coupleInfo && coupleInfo.coupleId ? coupleInfo.coupleId : null;\r\n}\r\n\r\n"],"names":["uni"],"mappings":";;AASO,SAAS,gBAAgB;AAC9B,MAAI;AACF,UAAM,aAAaA,cAAAA,MAAI,eAAe,aAAa;AACnD,WAAO,cAAc,WAAW,UAAU,aAAa;AAAA,EACxD,SAAQ,GAAG;AACVA,gEAAc,YAAY,CAAC;AAC3B,WAAO;AAAA,EACR;AACH;AAMO,SAAS,UAAU;AACxB,QAAM,aAAa;AACnB,SAAO,eAAe;AACxB;AAMO,SAAS,iBAAiB;AAC/B,QAAM,aAAa;AACnB,SAAO,cAAc,WAAW,cAAc,WAAW,cAAc;AACzE;AAaO,SAAS,eAAe,YAAY;AACzC,MAAI;AACF,UAAM,aAAa;AAAA,MACjB,SAAS,WAAW,WAAW;AAAA,MAC/B,UAAU,WAAW,YAAY;AAAA,MACjC,WAAW,WAAW,aAAa;AAAA,MACnC,aAAa,WAAW,eAAe;AAAA,MACvC,UAAU,WAAW,YAAY;AAAA,MACjC,MAAM,WAAW,QAAQ;AAAA,MACzB,YAAY,WAAW,cAAc;AAAA,MACrC,kBAAkB,WAAW,oBAAoB;AAAA,IACvD;AACIA,kBAAAA,MAAI,eAAe,eAAe,UAAU;AAC5C,WAAO;AAAA,EACR,SAAQ,GAAG;AACVA,gEAAc,YAAY,CAAC;AAC3B,WAAO;AAAA,EACR;AACH;AAMO,SAAS,kBAAkB;AAChC,MAAI;AACFA,wBAAI,kBAAkB,aAAa;AACnC,WAAO;AAAA,EACR,SAAQ,GAAG;AACVA,gEAAc,YAAY,CAAC;AAC3B,WAAO;AAAA,EACR;AACH;;;;;;"}