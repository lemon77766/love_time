{"version":3,"file":"http.js","sources":["utils/http.js"],"sourcesContent":["import config from './config'\r\nimport { isLoggedIn, logout } from './auth'\r\n\r\n// é»˜è®¤è¯·æ±‚é…ç½®\r\nconst defaultOptions = {\r\n  timeout: config.timeout,\r\n  retryCount: 0,  // é»˜è®¤ä¸é‡è¯•\r\n  retryDelay: 1000,  // é‡è¯•é—´éš”1ç§’\r\n}\r\n\r\n// å¤„ç†è¯·æ±‚é”™è¯¯\r\nfunction handleRequestError(error, options = {}) {\r\n  console.error('è¯·æ±‚é”™è¯¯:', error)\r\n  \r\n  // å¼€å‘çŽ¯å¢ƒä¸‹æ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯\r\n  if (process.env.NODE_ENV === 'development') {\r\n    console.warn('âš ï¸ å¼€å‘æ¨¡å¼ï¼šåŽç«¯æŽ¥å£æœªå°±ç»ªæˆ–ç½‘ç»œé”™è¯¯')\r\n    console.warn('âš ï¸ è¯·æ£€æŸ¥ï¼š')\r\n    console.warn('  1. åŽç«¯æœåŠ¡æ˜¯å¦å·²å¯åŠ¨')\r\n    console.warn('  2. è¯·æ±‚åœ°å€æ˜¯å¦æ­£ç¡®')\r\n    console.warn('  3. ç½‘ç»œæ˜¯å¦è¿žé€š')\r\n  }\r\n  \r\n  // 401é”™è¯¯å¤„ç†\r\n  if (error.statusCode === 401) {\r\n    handleUnauthorized()\r\n    return\r\n  }\r\n  \r\n  // è¶…æ—¶é”™è¯¯ç‰¹æ®Šå¤„ç†\r\n  if (error.errMsg && error.errMsg.includes('timeout')) {\r\n    if (options.retryCount > 0) {\r\n      return new Promise((resolve, reject) => {\r\n        setTimeout(() => {\r\n          console.log(`è¯·æ±‚è¶…æ—¶ï¼Œ${options.retryDelay/1000}ç§’åŽé‡è¯•ï¼Œå‰©ä½™é‡è¯•æ¬¡æ•°ï¼š${options.retryCount-1}`)\r\n          options.retryCount--\r\n          request(options).then(resolve).catch(reject)\r\n        }, options.retryDelay)\r\n      })\r\n    }\r\n  }\r\n  \r\n  return Promise.reject(error)\r\n}\r\n\r\n// å¤„ç†æœªæŽˆæƒæƒ…å†µ\r\nfunction handleUnauthorized() {\r\n  if (isLoggedIn()) {\r\n    uni.showToast({\r\n      title: 'ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•',\r\n      icon: 'none',\r\n      duration: 2000\r\n    })\r\n    logout()\r\n  }\r\n}\r\n\r\n// åŸºç¡€è¯·æ±‚æ–¹æ³•\r\nfunction request(options) {\r\n  // åˆå¹¶é»˜è®¤é…ç½®\r\n  options = { ...defaultOptions, ...options }\r\n  \r\n  // å¤„ç†è¯·æ±‚URL\r\n  const originalUrl = options.url\r\n  if (!options.url.startsWith('http')) {\r\n    options.url = config.baseURL + options.url\r\n  }\r\n  \r\n  // åˆ¤æ–­æ˜¯å¦ä¸ºç™»å½•æŽ¥å£ï¼ˆç™»å½•æŽ¥å£ä¸éœ€è¦tokenï¼‰\r\n  const isLoginApi = options.url.includes('/api/login/') && \r\n                     !options.url.includes('/api/login/logout')\r\n  \r\n  // åˆ¤æ–­æ˜¯å¦ä¸ºä¸€ç™¾ä»¶äº‹ç›¸å…³API\r\n  const isChallengeApi = options.url.includes('/api/challenge/')\r\n  \r\n  // æ·»åŠ tokenï¼ˆç™»å½•æŽ¥å£é™¤å¤–ï¼‰\r\n  const loginInfo = uni.getStorageSync('login_info')\r\n  let token = null\r\n  \r\n  // å°è¯•ä»Žå¤šä¸ªå¯èƒ½çš„è·¯å¾„èŽ·å–token\r\n  if (loginInfo) {\r\n    token = loginInfo.token || loginInfo.data?.token || loginInfo.accessToken || null\r\n    // ç¡®ä¿tokenæ˜¯å­—ç¬¦ä¸²ä¸”ä¸ä¸ºç©º\r\n    if (token && typeof token === 'string' && token.trim()) {\r\n      token = token.trim()\r\n    } else {\r\n      token = null\r\n    }\r\n  }\r\n  \r\n  // è°ƒè¯•ä¿¡æ¯ï¼šæ£€æŸ¥tokenæ˜¯å¦å­˜åœ¨ï¼ˆç™»å½•æŽ¥å£é™¤å¤–ï¼‰\r\n  if (process.env.NODE_ENV === 'development' && !isLoginApi) {\r\n    if (!token) {\r\n      console.warn('âš ï¸ Tokenæœªæ‰¾åˆ°ï¼Œè¯·æ±‚å¯èƒ½å¤±è´¥')\r\n      console.warn('âš ï¸ ç™»å½•ä¿¡æ¯:', loginInfo)\r\n      if (loginInfo?.isGuest) {\r\n        console.warn('âš ï¸ æ£€æµ‹åˆ°æ¸¸å®¢ç™»å½•ï¼Œæ¸¸å®¢ç™»å½•ä¸æ”¯æŒéœ€è¦è®¤è¯çš„API')\r\n      } else if (loginInfo) {\r\n        console.warn('âš ï¸ ç™»å½•ä¿¡æ¯å­˜åœ¨ï¼Œä½†tokenä¸ºç©ºã€‚å¯èƒ½çš„åŽŸå› ï¼š')\r\n        console.warn('   1. åŽç«¯è¿”å›žçš„tokenå­—æ®µåä¸æ˜¯\"token\"')\r\n        console.warn('   2. åŽç«¯è¿”å›žçš„æ•°æ®ç»“æž„ä¸ç¬¦åˆé¢„æœŸ')\r\n        console.warn('   3. ç™»å½•æ—¶tokenæå–å¤±è´¥')\r\n      } else {\r\n        console.warn('âš ï¸ æœªæ‰¾åˆ°ç™»å½•ä¿¡æ¯ï¼Œè¯·å…ˆç™»å½•')\r\n      }\r\n    } else {\r\n      console.log('âœ… Tokenå·²æ‰¾åˆ°ï¼Œé•¿åº¦:', token.length)\r\n    }\r\n  }\r\n  \r\n  if (token) {\r\n    options.header = {\r\n      ...options.header,\r\n      'Authorization': `Bearer ${token}`\r\n    }\r\n  } else if (!isLoginApi) {\r\n    // å¦‚æžœæ²¡æœ‰tokenä¸”ä¸æ˜¯ç™»å½•æŽ¥å£ï¼Œæ·»åŠ è­¦å‘Š\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.warn('âš ï¸ è¯·æ±‚æœªæºå¸¦Authorizationå¤´ï¼Œå¯èƒ½å¯¼è‡´401é”™è¯¯')\r\n      console.warn('âš ï¸ å½“å‰è¯·æ±‚URL:', options.url)\r\n    }\r\n  }\r\n  \r\n  // å¼€å‘çŽ¯å¢ƒä¸‹è®°å½•æ‰€æœ‰APIè¯·æ±‚ä¿¡æ¯\r\n  // åˆ¤æ–­æ˜¯å¦åœ¨å¼€å‘çŽ¯å¢ƒï¼šuni-appå¼€å‘å·¥å…·æˆ–æœ¬åœ°è°ƒè¯•\r\n  let isDev = false;\r\n  try {\r\n    isDev = process.env.NODE_ENV === 'development' || \r\n            typeof __wxConfig !== 'undefined' ||  // å¾®ä¿¡å°ç¨‹åºå¼€å‘å·¥å…·\r\n            (typeof uni !== 'undefined' && uni.getSystemInfoSync && uni.getSystemInfoSync().platform === 'devtools'); // å¼€å‘å·¥å…·çŽ¯å¢ƒ\r\n  } catch (e) {\r\n    // å¦‚æžœèŽ·å–ç³»ç»Ÿä¿¡æ¯å¤±è´¥ï¼Œé»˜è®¤åˆ¤æ–­ä¸ºå¼€å‘çŽ¯å¢ƒï¼ˆä¿å®ˆç­–ç•¥ï¼Œç¡®ä¿æ—¥å¿—è¾“å‡ºï¼‰\r\n    isDev = process.env.NODE_ENV === 'development' || typeof __wxConfig !== 'undefined';\r\n  }\r\n  \r\n  // æ— è®ºæ˜¯å¦å¼€å‘çŽ¯å¢ƒï¼Œéƒ½è®°å½•çˆ±å¿ƒå¢™ç›¸å…³çš„è¯·æ±‚ï¼ˆä¾¿äºŽè°ƒè¯•ï¼‰\r\n  const urlForCheck = options.url || originalUrl || '';\r\n  const isHeartWallApi = urlForCheck.includes('/api/heart-wall/') || \r\n                         urlForCheck.includes('heart-wall') ||\r\n                         urlForCheck.includes('heartwall') ||\r\n                         urlForCheck.toLowerCase().includes('heart_wall');\r\n  \r\n  if (isDev || isHeartWallApi) {\r\n    // åˆ¤æ–­APIç±»åž‹ï¼ˆä½¿ç”¨å®Œæ•´URLæˆ–åŽŸå§‹URLè¿›è¡Œåˆ¤æ–­ï¼‰\r\n    let apiType = 'é€šç”¨API';\r\n    if (urlForCheck.includes('/api/challenge/')) {\r\n      apiType = 'ä¸€ç™¾ä»¶äº‹API';\r\n    } else if (urlForCheck.includes('/api/couple/')) {\r\n      apiType = 'æƒ…ä¾£ç»‘å®šAPI';\r\n    } else if (isHeartWallApi) {\r\n      apiType = 'å¿ƒå½¢å¢™API';\r\n    } else if (urlForCheck.includes('/api/qna/')) {\r\n      apiType = 'é—®ç­”API';\r\n    } else if (urlForCheck.includes('/api/login/')) {\r\n      apiType = 'ç™»å½•API';\r\n    } else if (urlForCheck.includes('/api/user/')) {\r\n      apiType = 'ç”¨æˆ·API';\r\n    } else if (urlForCheck.includes('/api/letter/')) {\r\n      apiType = 'æƒ…ä¹¦API';\r\n    }\r\n    \r\n    console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');\r\n    console.log('ðŸ”— [HTTPè¯·æ±‚]', apiType);\r\n    console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');\r\n    console.log('ðŸ“ [URL]', options.url);\r\n    console.log('ðŸ“‹ [æ–¹æ³•]', options.method || 'GET');\r\n    if (options.data) {\r\n      console.log('ðŸ“¤ [è¯·æ±‚å‚æ•°]', JSON.stringify(options.data, null, 2));\r\n    }\r\n    if (token) {\r\n      console.log('ðŸ”‘ [è®¤è¯] Tokenå·²æºå¸¦ (é•¿åº¦:', token.length, ')');\r\n    } else {\r\n      if (!isLoginApi) {\r\n        console.warn('âš ï¸ [è®¤è¯] Tokenæœªæºå¸¦ï¼Œè¯·æ±‚å¯èƒ½å¤±è´¥');\r\n      } else {\r\n        console.log('â„¹ï¸ [è®¤è¯] ç™»å½•æŽ¥å£ï¼Œæ— éœ€Token');\r\n      }\r\n    }\r\n    if (options.header) {\r\n      console.log('ðŸ“‹ [è¯·æ±‚å¤´]', Object.keys(options.header).join(', '));\r\n    }\r\n    console.log('â° [æ—¶é—´]', new Date().toLocaleString());\r\n    console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');\r\n  }\r\n  \r\n  return new Promise((resolve, reject) => {\r\n    uni.request({\r\n      ...options,\r\n      success: (res) => {\r\n        if (res.statusCode >= 200 && res.statusCode < 300) {\r\n          // å¼€å‘çŽ¯å¢ƒä¸‹è®°å½•æ‰€æœ‰APIå“åº”æ•°æ®ï¼Œå¸®åŠ©è°ƒè¯•\r\n          let isDev = false;\r\n          try {\r\n            isDev = process.env.NODE_ENV === 'development' || \r\n                    typeof __wxConfig !== 'undefined' ||\r\n                    (typeof uni !== 'undefined' && uni.getSystemInfoSync && uni.getSystemInfoSync().platform === 'devtools');\r\n          } catch (e) {\r\n            isDev = process.env.NODE_ENV === 'development' || typeof __wxConfig !== 'undefined';\r\n          }\r\n          \r\n          // æ— è®ºæ˜¯å¦å¼€å‘çŽ¯å¢ƒï¼Œéƒ½è®°å½•çˆ±å¿ƒå¢™ç›¸å…³çš„å“åº”ï¼ˆä¾¿äºŽè°ƒè¯•ï¼‰\r\n          const urlForCheck = options.url || '';\r\n          const isHeartWallApi = urlForCheck.includes('/api/heart-wall/') || \r\n                                 urlForCheck.includes('heart-wall') ||\r\n                                 urlForCheck.includes('heartwall') ||\r\n                                 urlForCheck.toLowerCase().includes('heart_wall');\r\n          \r\n          if (isDev || isHeartWallApi) {\r\n            // åˆ¤æ–­APIç±»åž‹ï¼ˆä½¿ç”¨å®Œæ•´URLè¿›è¡Œåˆ¤æ–­ï¼‰\r\n            let apiType = 'é€šç”¨API';\r\n            if (urlForCheck.includes('/api/challenge/')) {\r\n              apiType = 'ä¸€ç™¾ä»¶äº‹API';\r\n            } else if (urlForCheck.includes('/api/couple/')) {\r\n              apiType = 'æƒ…ä¾£ç»‘å®šAPI';\r\n            } else if (isHeartWallApi) {\r\n              apiType = 'å¿ƒå½¢å¢™API';\r\n            } else if (urlForCheck.includes('/api/qna/')) {\r\n              apiType = 'é—®ç­”API';\r\n            } else if (urlForCheck.includes('/api/login/')) {\r\n              apiType = 'ç™»å½•API';\r\n            } else if (urlForCheck.includes('/api/user/')) {\r\n              apiType = 'ç”¨æˆ·API';\r\n            } else if (urlForCheck.includes('/api/letter/')) {\r\n              apiType = 'æƒ…ä¹¦API';\r\n            }\r\n            \r\n            console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');\r\n            console.log('âœ… [HTTPå“åº”]', apiType, 'è¯·æ±‚æˆåŠŸ');\r\n            console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');\r\n            console.log('ðŸ“ [URL]', options.url);\r\n            console.log('ðŸ“Š [çŠ¶æ€ç ]', res.statusCode);\r\n            console.log('ðŸ“¦ [å“åº”æ•°æ®]', JSON.stringify(res.data, null, 2));\r\n            \r\n            // ç»Ÿè®¡å“åº”æ•°æ®ä¿¡æ¯\r\n            if (res.data && typeof res.data === 'object') {\r\n              if (res.data.tasks && Array.isArray(res.data.tasks)) {\r\n                console.log('ðŸ“Š [æ•°æ®ç»Ÿè®¡] ä»»åŠ¡æ•°é‡:', res.data.tasks.length);\r\n              }\r\n              if (res.data.projects && Array.isArray(res.data.projects)) {\r\n                console.log('ðŸ“Š [æ•°æ®ç»Ÿè®¡] é¡¹ç›®æ•°é‡:', res.data.projects.length);\r\n              }\r\n              if (res.data.photos && Array.isArray(res.data.photos)) {\r\n                console.log('ðŸ“Š [æ•°æ®ç»Ÿè®¡] ç…§ç‰‡æ•°é‡:', res.data.photos.length);\r\n              }\r\n              if (res.data.questions && Array.isArray(res.data.questions)) {\r\n                console.log('ðŸ“Š [æ•°æ®ç»Ÿè®¡] é—®é¢˜æ•°é‡:', res.data.questions.length);\r\n              }\r\n              if (res.data.success !== undefined) {\r\n                console.log('âœ… [ä¸šåŠ¡çŠ¶æ€]', res.data.success ? 'æˆåŠŸ' : 'å¤±è´¥');\r\n              }\r\n              if (res.data.message) {\r\n                console.log('ðŸ’¬ [æ¶ˆæ¯]', res.data.message);\r\n              }\r\n            }\r\n            \r\n            console.log('â° [æ—¶é—´]', new Date().toLocaleString());\r\n            console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');\r\n          }\r\n          \r\n          // å¦‚æžœåŽç«¯è¿”å›žçš„æ ¼å¼æ˜¯ { success: false, message: \"...\" }ï¼Œåº”è¯¥ä½œä¸ºé”™è¯¯å¤„ç†\r\n          if (res.data && typeof res.data === 'object' && res.data.success === false) {\r\n            const error = new Error(res.data.message || 'è¯·æ±‚å¤±è´¥')\r\n            error.statusCode = res.statusCode\r\n            error.data = res.data\r\n            reject(error)\r\n            return\r\n          }\r\n          \r\n          resolve(res.data)\r\n        } else {\r\n          // ç‰¹æ®Šæƒ…å†µï¼šå³ä½¿HTTPçŠ¶æ€ç ä¸æ˜¯200-299ï¼Œä½†å¦‚æžœå“åº”ä½“ä¸­ success: trueï¼Œä¹Ÿåº”è¯¥å½“ä½œæˆåŠŸå¤„ç†\r\n          // è¿™æ˜¯å› ä¸ºåŽç«¯å¯èƒ½åœ¨ä¸šåŠ¡æˆåŠŸæ—¶è¿”å›žäº†é”™è¯¯çš„çŠ¶æ€ç ï¼ˆå¦‚500ï¼‰\r\n          \r\n          // å…ˆè®°å½•è¯¦ç»†æ—¥å¿—ï¼Œä¾¿äºŽè°ƒè¯•\r\n          const urlForCheck = options.url || '';\r\n          const isHeartWallApi = urlForCheck.includes('/api/heart-wall/') || \r\n                                 urlForCheck.includes('heart-wall') ||\r\n                                 urlForCheck.includes('heartwall') ||\r\n                                 urlForCheck.toLowerCase().includes('heart_wall');\r\n          \r\n          // å°è¯•è§£æžå“åº”æ•°æ®ï¼ˆå¦‚æžœæ˜¯å­—ç¬¦ä¸²æ ¼å¼ï¼‰\r\n          let responseData = res.data;\r\n          if (typeof responseData === 'string') {\r\n            try {\r\n              responseData = JSON.parse(responseData);\r\n            } catch (e) {\r\n              // è§£æžå¤±è´¥ï¼Œä¿æŒåŽŸæ ·\r\n            }\r\n          }\r\n          \r\n          if (isHeartWallApi || process.env.NODE_ENV === 'development') {\r\n            console.warn(`âš ï¸ [HTTPå“åº”] çŠ¶æ€ç å¼‚å¸¸: ${res.statusCode}`);\r\n            console.warn(`âš ï¸ [å“åº”æ•°æ®]`, responseData);\r\n            console.warn(`âš ï¸ [å“åº”æ•°æ®ç±»åž‹]`, typeof responseData);\r\n            if (responseData && typeof responseData === 'object') {\r\n              console.warn(`âš ï¸ [successå­—æ®µ]`, responseData.success);\r\n              console.warn(`âš ï¸ [messageå­—æ®µ]`, responseData.message);\r\n              // å¦‚æžœæ˜¯å¿ƒå½¢å¢™APIï¼Œä¹Ÿæ£€æŸ¥photoå­—æ®µ\r\n              if (isHeartWallApi && responseData.photo) {\r\n                console.warn(`âš ï¸ [photoå­—æ®µå­˜åœ¨]`, !!responseData.photo);\r\n              }\r\n            }\r\n          }\r\n          \r\n          // æ£€æŸ¥å“åº”æ•°æ®ä¸­æ˜¯å¦æœ‰ success: true\r\n          // æ”¯æŒå¤šç§æ ¼å¼ï¼š\r\n          // 1. { success: true, ... }\r\n          // 2. { data: { success: true, ... } }\r\n          // 3. å¯¹äºŽå¿ƒå½¢å¢™APIï¼Œä¹Ÿæ£€æŸ¥æ˜¯å¦æœ‰photoå­—æ®µï¼ˆè¡¨ç¤ºæˆåŠŸï¼‰\r\n          let isSuccess = false;\r\n          if (responseData && typeof responseData === 'object') {\r\n            if (responseData.success === true) {\r\n              isSuccess = true;\r\n            } else if (responseData.data && typeof responseData.data === 'object' && responseData.data.success === true) {\r\n              isSuccess = true;\r\n              // å°†dataæå‡ä¸ºé¡¶å±‚\r\n              responseData = responseData.data;\r\n            } else if (isHeartWallApi && responseData.photo && typeof responseData.photo === 'object') {\r\n              // å¯¹äºŽå¿ƒå½¢å¢™APIï¼Œå¦‚æžœè¿”å›žäº†photoå­—æ®µï¼Œä¹Ÿè®¤ä¸ºæˆåŠŸ\r\n              isSuccess = true;\r\n            }\r\n          }\r\n          \r\n          if (isSuccess) {\r\n            console.warn(`âš ï¸ [HTTPå“åº”] åŽç«¯è¿”å›žçŠ¶æ€ç  ${res.statusCode}ï¼Œä½†ä¸šåŠ¡é€»è¾‘æˆåŠŸ (success: true)`);\r\n            console.warn('âš ï¸ å»ºè®®åŽç«¯ä¿®æ”¹ï¼šæˆåŠŸæ—¶åº”è¯¥è¿”å›ž 200 çŠ¶æ€ç ');\r\n            // å½“ä½œæˆåŠŸå¤„ç†\r\n            resolve(responseData)\r\n            return\r\n          }\r\n          \r\n          // å¦‚æžœæ£€æŸ¥å¤±è´¥ï¼Œè®°å½•è¯¦ç»†ä¿¡æ¯åŽreject\r\n          if (isHeartWallApi || process.env.NODE_ENV === 'development') {\r\n            console.error(`âŒ [HTTPå“åº”] çŠ¶æ€ç  ${res.statusCode} ä¸”ä¸šåŠ¡é€»è¾‘å¤±è´¥`);\r\n            if (!responseData || typeof responseData !== 'object') {\r\n              console.error(`âŒ å“åº”æ•°æ®ä¸æ˜¯å¯¹è±¡:`, responseData);\r\n            } else {\r\n              console.error(`âŒ successå­—æ®µ:`, responseData.success);\r\n              if (isHeartWallApi) {\r\n                console.error(`âŒ photoå­—æ®µ:`, responseData.photo ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');\r\n              }\r\n            }\r\n          }\r\n          \r\n          reject(res)\r\n        }\r\n      },\r\n      fail: (error) => {\r\n        // å¼€å‘çŽ¯å¢ƒä¸‹è®°å½•æ‰€æœ‰APIçš„é”™è¯¯ä¿¡æ¯\r\n        let isDev = false;\r\n        try {\r\n          isDev = process.env.NODE_ENV === 'development' || \r\n                  typeof __wxConfig !== 'undefined' ||\r\n                  (typeof uni !== 'undefined' && uni.getSystemInfoSync && uni.getSystemInfoSync().platform === 'devtools');\r\n        } catch (e) {\r\n          isDev = process.env.NODE_ENV === 'development' || typeof __wxConfig !== 'undefined';\r\n        }\r\n        \r\n        // æ— è®ºæ˜¯å¦å¼€å‘çŽ¯å¢ƒï¼Œéƒ½è®°å½•çˆ±å¿ƒå¢™ç›¸å…³çš„é”™è¯¯ï¼ˆä¾¿äºŽè°ƒè¯•ï¼‰\r\n        const urlForCheck = options.url || '';\r\n        const isHeartWallApi = urlForCheck.includes('/api/heart-wall/') || \r\n                               urlForCheck.includes('heart-wall') ||\r\n                               urlForCheck.includes('heartwall') ||\r\n                               urlForCheck.toLowerCase().includes('heart_wall');\r\n        \r\n        if (isDev || isHeartWallApi) {\r\n          // åˆ¤æ–­APIç±»åž‹ï¼ˆä½¿ç”¨å®Œæ•´URLè¿›è¡Œåˆ¤æ–­ï¼‰\r\n          let apiType = 'é€šç”¨API';\r\n          if (urlForCheck.includes('/api/challenge/')) {\r\n            apiType = 'ä¸€ç™¾ä»¶äº‹API';\r\n          } else if (urlForCheck.includes('/api/couple/')) {\r\n            apiType = 'æƒ…ä¾£ç»‘å®šAPI';\r\n          } else if (isHeartWallApi) {\r\n            apiType = 'å¿ƒå½¢å¢™API';\r\n          } else if (urlForCheck.includes('/api/qna/')) {\r\n            apiType = 'é—®ç­”API';\r\n          } else if (urlForCheck.includes('/api/login/')) {\r\n            apiType = 'ç™»å½•API';\r\n          } else if (urlForCheck.includes('/api/user/')) {\r\n            apiType = 'ç”¨æˆ·API';\r\n          } else if (urlForCheck.includes('/api/letter/')) {\r\n            apiType = 'æƒ…ä¹¦API';\r\n          }\r\n          \r\n          console.error('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');\r\n          console.error('âŒ [HTTPé”™è¯¯]', apiType, 'è¯·æ±‚å¤±è´¥');\r\n          console.error('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');\r\n          console.error('ðŸ“ [URL]', options.url);\r\n          console.error('ðŸ“‹ [æ–¹æ³•]', options.method || 'GET');\r\n          console.error('ðŸ”´ [é”™è¯¯è¯¦æƒ…]', error);\r\n          console.error('ðŸ“‹ [é”™è¯¯æ¶ˆæ¯]', error.errMsg || error.message || 'æœªçŸ¥é”™è¯¯');\r\n          console.error('ðŸ“Š [çŠ¶æ€ç ]', error.statusCode || 'æ— ');\r\n          \r\n          // é”™è¯¯åˆ†æž\r\n          if (error.errMsg) {\r\n            if (error.errMsg.includes('timeout')) {\r\n              console.error('â±ï¸ [é”™è¯¯ç±»åž‹] è¯·æ±‚è¶…æ—¶');\r\n            } else if (error.errMsg.includes('fail')) {\r\n              console.error('ðŸ”Œ [é”™è¯¯ç±»åž‹] ç½‘ç»œè¿žæŽ¥å¤±è´¥');\r\n              console.error('ðŸ’¡ [æç¤º] è¯·æ£€æŸ¥ï¼š');\r\n              console.error('   1. åŽç«¯æœåŠ¡æ˜¯å¦å·²å¯åŠ¨');\r\n              console.error('   2. è¯·æ±‚åœ°å€æ˜¯å¦æ­£ç¡®:', options.url);\r\n              console.error('   3. ç½‘ç»œæ˜¯å¦è¿žé€š');\r\n            } else if (error.errMsg.includes('404')) {\r\n              console.error('ðŸ” [é”™è¯¯ç±»åž‹] æŽ¥å£ä¸å­˜åœ¨ (404)');\r\n            } else if (error.errMsg.includes('401')) {\r\n              console.error('ðŸ” [é”™è¯¯ç±»åž‹] æœªæŽˆæƒ (401)ï¼Œå¯èƒ½æ˜¯Tokenè¿‡æœŸ');\r\n            }\r\n          }\r\n          \r\n          console.error('â° [æ—¶é—´]', new Date().toLocaleString());\r\n          console.error('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');\r\n        }\r\n        handleRequestError(error, options)\r\n          .then(resolve)\r\n          .catch(reject)\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\n// æ–‡ä»¶ä¸Šä¼ æ–¹æ³•\r\nfunction upload(options) {\r\n  // åˆå¹¶é»˜è®¤é…ç½®\r\n  options = {\r\n    ...defaultOptions,\r\n    timeout: config.uploadTimeout || 30000,  // ä¸Šä¼ é»˜è®¤30ç§’è¶…æ—¶\r\n    header: {\r\n      'content-type': 'multipart/form-data'\r\n    },\r\n    ...options\r\n  }\r\n  \r\n  // å¤„ç†è¯·æ±‚URL\r\n  if (!options.url.startsWith('http')) {\r\n    options.url = config.baseURL + options.url\r\n  }\r\n  \r\n  // æ·»åŠ token\r\n  const loginInfo = uni.getStorageSync('login_info')\r\n  const token = loginInfo?.token\r\n  \r\n  if (token) {\r\n    options.header['Authorization'] = `Bearer ${token}`\r\n  } else {\r\n    console.warn('âš ï¸ ä¸Šä¼ è¯·æ±‚æœªæºå¸¦Authorizationå¤´ï¼Œå¯èƒ½å¯¼è‡´401é”™è¯¯')\r\n  }\r\n  \r\n  return new Promise((resolve, reject) => {\r\n    uni.uploadFile({\r\n      ...options,\r\n      success: (uploadRes) => {\r\n        try {\r\n          const result = JSON.parse(uploadRes.data)\r\n          if (result.success) {\r\n            resolve(result.data)\r\n          } else {\r\n            reject(new Error(result.message || 'ä¸Šä¼ å¤±è´¥'))\r\n          }\r\n        } catch (e) {\r\n          reject(new Error('è§£æžä¸Šä¼ å“åº”å¤±è´¥'))\r\n        }\r\n      },\r\n      fail: (error) => {\r\n        handleRequestError(error, options)\r\n          .then(resolve)\r\n          .catch(reject)\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\n// HTTPæ–¹æ³•å°è£…\r\nconst http = {\r\n  request,\r\n  upload,\r\n  get: (url, data, options = {}) => request({ ...options, url, data, method: 'GET' }),\r\n  post: (url, data, options = {}) => request({ ...options, url, data, method: 'POST' }),\r\n  put: (url, data, options = {}) => request({ ...options, url, data, method: 'PUT' }),\r\n  delete: (url, data, options = {}) => request({ ...options, url, data, method: 'DELETE' })\r\n}\r\n\r\nexport default http\r\n"],"names":["config","uni","isLoggedIn","logout","isDev","urlForCheck","isHeartWallApi"],"mappings":"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"}