{"version":3,"file":"http.js","sources":["utils/http.js"],"sourcesContent":["import config from './config'\nimport { isLoggedIn, logout } from './auth'\n\n// ÈªòËÆ§ËØ∑Ê±ÇÈÖçÁΩÆ\nconst defaultOptions = {\n  timeout: config.timeout,\n  retryCount: 0,  // ÈªòËÆ§‰∏çÈáçËØï\n  retryDelay: 1000,  // ÈáçËØïÈó¥Èöî1Áßí\n}\n\n// ËßÑËåÉÂåñÂèØËÉΩÁöÑtokenÔºàÊéíÈô§Á∫ØÊï∞Â≠óÁä∂ÊÄÅÁ†Å/Á©∫ÂÄºÔºâ\nfunction normalizeTokenCandidate(candidate) {\n  if (typeof candidate !== 'string') {\n    return null;\n  }\n  const trimmed = candidate.trim();\n  if (!trimmed) {\n    return null;\n  }\n  if (/^\\d+$/.test(trimmed) && trimmed.length <= 6) {\n    return null;\n  }\n  return trimmed;\n}\n\nfunction resolveTokenFromLoginInfo(loginInfo) {\n  if (!loginInfo || typeof loginInfo !== 'object') {\n    return null;\n  }\n  const candidates = [\n    loginInfo.token,\n    loginInfo.data?.token,\n    loginInfo.accessToken,\n    loginInfo.authToken,\n    loginInfo.code,\n    loginInfo.data?.code,\n    loginInfo.rawToken\n  ];\n  for (const candidate of candidates) {\n    const normalized = normalizeTokenCandidate(candidate);\n    if (normalized) {\n      return normalized;\n    }\n  }\n  return null;\n}\n\n// Ê†áËÆ∞ÊòØÂê¶Â∑≤ÁªèÂ∞ùËØïËøáÊ∏ÖÈô§Êó†ÊïàÁôªÂΩï‰ø°ÊÅØÔºàÈÅøÂÖçÈáçÂ§çÊ∏ÖÈô§Ôºâ\nlet hasClearedInvalidLogin = false\n\n// Â§ÑÁêÜËØ∑Ê±ÇÈîôËØØ\nfunction handleRequestError(error, options = {}) {\n  console.error('ËØ∑Ê±ÇÈîôËØØ:', error)\n  \n  // ÂºÄÂèëÁéØÂ¢É‰∏ãÊòæÁ§∫ËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØ\n  if (process.env.NODE_ENV === 'development') {\n    console.warn('‚ö†Ô∏è ÂºÄÂèëÊ®°ÂºèÔºöÂêéÁ´ØÊé•Âè£Êú™Â∞±Áª™ÊàñÁΩëÁªúÈîôËØØ')\n    console.warn('‚ö†Ô∏è ËØ∑Ê£ÄÊü•Ôºö')\n    console.warn('  1. ÂêéÁ´ØÊúçÂä°ÊòØÂê¶Â∑≤ÂêØÂä®')\n    console.warn('  2. ËØ∑Ê±ÇÂú∞ÂùÄÊòØÂê¶Ê≠£Á°Æ')\n    console.warn('  3. ÁΩëÁªúÊòØÂê¶ËøûÈÄö')\n  }\n  \n  // 401ÈîôËØØÂ§ÑÁêÜ\n  // ‰ΩÜÊòØÁôªÂΩïÊé•Âè£ËøîÂõû401Êó∂‰∏çÂ∫îËØ•Ë∞ÉÁî®handleUnauthorized\n  if (error.statusCode === 401) {\n    const urlForCheck = (options.url || '').toString();\n    const isLoginApi = urlForCheck.includes('/api/login/') && \n                       !urlForCheck.includes('/api/login/logout');\n    \n    if (!isLoginApi) {\n      // ÈùûÁôªÂΩïÊé•Âè£ÁöÑ401ÈîôËØØÔºåÊ≠£Â∏∏Â§ÑÁêÜ\n      handleUnauthorized()\n      return\n    } else {\n      // ÁôªÂΩïÊé•Âè£ËøîÂõû401ÔºåËÆ∞ÂΩïÈîôËØØ‰ΩÜ‰∏çË∑≥ËΩ¨\n      console.error('‚ùå [ÁôªÂΩïÊé•Âè£] ËøîÂõû401ÈîôËØØÔºåÂèØËÉΩÊòØÂêéÁ´ØÈÖçÁΩÆÈóÆÈ¢ò');\n    }\n  }\n  \n  // Ë∂ÖÊó∂ÈîôËØØÁâπÊÆäÂ§ÑÁêÜ\n  if (error.errMsg && error.errMsg.includes('timeout')) {\n    if (options.retryCount > 0) {\n      return new Promise((resolve, reject) => {\n        setTimeout(() => {\n          console.log(`ËØ∑Ê±ÇË∂ÖÊó∂Ôºå${options.retryDelay/1000}ÁßíÂêéÈáçËØïÔºåÂâ©‰ΩôÈáçËØïÊ¨°Êï∞Ôºö${options.retryCount-1}`)\n          options.retryCount--\n          request(options).then(resolve).catch(reject)\n        }, options.retryDelay)\n      })\n    }\n  }\n  \n  return Promise.reject(error)\n}\n\n// Â§ÑÁêÜÊú™ÊéàÊùÉÊÉÖÂÜµ\nfunction handleUnauthorized(customMessage) {\n  if (isLoggedIn()) {\n    const message = customMessage || 'ÁôªÂΩïÂ∑≤ËøáÊúüÔºåËØ∑ÈáçÊñ∞ÁôªÂΩï';\n    uni.showToast({\n      title: message,\n      icon: 'none',\n      duration: 2000\n    })\n    // Âª∂Ëøü‰∏ÄÁÇπÂÜçÊâßË°ålogoutÔºàÈùôÈªòÊ®°ÂºèÔºåÈÅøÂÖçÈáçÂ§çÊèêÁ§∫ÔºâÔºåËÆ©Áî®Êà∑ÁúãÂà∞ÊèêÁ§∫\n    setTimeout(() => {\n      logout(true) // ÈùôÈªòÈÄÄÂá∫ÔºåÈÅøÂÖçÊòæÁ§∫\"Â∑≤ÈÄÄÂá∫ÁôªÂΩï\"ÁöÑÊèêÁ§∫\n    }, 500);\n  } else {\n    // Â¶ÇÊûúÊú™ÁôªÂΩïÔºåÁõ¥Êé•Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µ\n    uni.reLaunch({\n      url: '/pages/login/index'\n    });\n  }\n}\n\n// Âü∫Á°ÄËØ∑Ê±ÇÊñπÊ≥ï\nfunction request(options) {\n  // ÂêàÂπ∂ÈªòËÆ§ÈÖçÁΩÆ\n  options = { ...defaultOptions, ...options }\n  \n  // Â§ÑÁêÜËØ∑Ê±ÇURL\n  const originalUrl = options.url\n  if (!options.url.startsWith('http')) {\n    options.url = config.baseURL + options.url\n  }\n  \n  // Âà§Êñ≠ÊòØÂê¶‰∏∫ÁôªÂΩïÊé•Âè£ÔºàÁôªÂΩïÊé•Âè£‰∏çÈúÄË¶ÅtokenÔºâ\n  const isLoginApi = options.url.includes('/api/login/') && \n                     !options.url.includes('/api/login/logout')\n  \n  // Âà§Êñ≠ÊòØÂê¶‰∏∫‰∏ÄÁôæ‰ª∂‰∫ãÁõ∏ÂÖ≥API\n  const isChallengeApi = options.url.includes('/api/challenge/')\n  \n  // Ê∑ªÂä†tokenÔºàÁôªÂΩïÊé•Âè£Èô§Â§ñÔºâ\n  const loginInfo = uni.getStorageSync('login_info')\n  let token = resolveTokenFromLoginInfo(loginInfo)\n  if (token && loginInfo && !loginInfo.token) {\n    loginInfo.token = token\n    try {\n      uni.setStorageSync('login_info', loginInfo)\n    } catch (storageError) {\n      console.warn('‚ö†Ô∏è ÂÜôÂõûÊ†áÂáÜtokenÂ≠óÊÆµÂ§±Ë¥•:', storageError)\n    }\n  }\n  \n  // Ë∞ÉËØï‰ø°ÊÅØÔºöÊ£ÄÊü•tokenÊòØÂê¶Â≠òÂú®ÔºàÁôªÂΩïÊé•Âè£Èô§Â§ñÔºâ\n  if (process.env.NODE_ENV === 'development' && !isLoginApi) {\n    if (!token) {\n      console.warn('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n      console.warn('‚ö†Ô∏è [TokenËØäÊñ≠] TokenÊú™ÊâæÂà∞ÔºåËØ∑Ê±ÇÂèØËÉΩÂ§±Ë¥•');\n      console.warn('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n      console.warn('üì¶ ÂÆåÊï¥ÁôªÂΩï‰ø°ÊÅØÁªìÊûÑ:');\n      console.warn(JSON.stringify(loginInfo, null, 2));\n      console.warn('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n      console.warn('üîç ÁôªÂΩï‰ø°ÊÅØÂ≠óÊÆµÊ£ÄÊü•:');\n      if (loginInfo) {\n        console.warn(`   - isLoggedIn: ${loginInfo.isLoggedIn !== undefined ? loginInfo.isLoggedIn : '‚ùå ‰∏çÂ≠òÂú®'}`);\n        console.warn(`   - token: ${loginInfo.token !== undefined ? (loginInfo.token ? `‚úÖ Â≠òÂú®ÔºåÈïøÂ∫¶: ${loginInfo.token.length}` : '‚ùå ‰∏∫Á©∫') : '‚ùå ‰∏çÂ≠òÂú®'}`);\n        console.warn(`   - data?.token: ${loginInfo.data?.token !== undefined ? (loginInfo.data.token ? `‚úÖ Â≠òÂú®ÔºåÈïøÂ∫¶: ${loginInfo.data.token.length}` : '‚ùå ‰∏∫Á©∫') : '‚ùå ‰∏çÂ≠òÂú®'}`);\n        console.warn(`   - accessToken: ${loginInfo.accessToken !== undefined ? (loginInfo.accessToken ? `‚úÖ Â≠òÂú®ÔºåÈïøÂ∫¶: ${loginInfo.accessToken.length}` : '‚ùå ‰∏∫Á©∫') : '‚ùå ‰∏çÂ≠òÂú®'}`);\n        if (loginInfo.code !== undefined) {\n          if (typeof loginInfo.code === 'string') {\n            console.warn(`   - code: ${loginInfo.code ? `‚úÖ Â≠óÁ¨¶‰∏≤ÔºåÈïøÂ∫¶: ${loginInfo.code.length}` : '‚ùå ‰∏∫Á©∫Â≠óÁ¨¶‰∏≤'}`);\n          } else {\n            console.warn(`   - code: ‚ÑπÔ∏è Á±ªÂûã: ${typeof loginInfo.code}, ÂÄº: ${loginInfo.code}`);\n          }\n        } else {\n          console.warn('   - code: ‚ùå ‰∏çÂ≠òÂú®');\n        }\n        console.warn(`   - userInfo: ${loginInfo.userInfo !== undefined ? '‚úÖ Â≠òÂú®' : '‚ùå ‰∏çÂ≠òÂú®'}`);\n        console.warn(`   - loginTime: ${loginInfo.loginTime !== undefined ? `‚úÖ Â≠òÂú®: ${loginInfo.loginTime}` : '‚ùå ‰∏çÂ≠òÂú®'}`);\n      }\n      console.warn('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n      \n      if (loginInfo?.isGuest) {\n        console.warn('‚ö†Ô∏è Ê£ÄÊµãÂà∞Ê∏∏ÂÆ¢ÁôªÂΩïÔºåÊ∏∏ÂÆ¢ÁôªÂΩï‰∏çÊîØÊåÅÈúÄË¶ÅËÆ§ËØÅÁöÑAPI')\n      } else if (loginInfo && loginInfo.isLoggedIn) {\n        console.warn('‚ö†Ô∏è ÁôªÂΩïÁä∂ÊÄÅ‰∏∫trueÔºå‰ΩÜtokenÁº∫Â§±„ÄÇÂèØËÉΩÁöÑÂéüÂõ†Ôºö');\n        console.warn('   1. ‰πãÂâçÁöÑÁôªÂΩï‰ª£Á†ÅÊ≤°ÊúâÊ≠£Á°Æ‰øùÂ≠òtoken');\n        console.warn('   2. ÁôªÂΩï‰ø°ÊÅØË¢´ÈÉ®ÂàÜË¶ÜÁõñÊàñÊçüÂùè');\n        console.warn('   3. ÂêéÁ´ØËøîÂõûÁöÑÊï∞ÊçÆÁªìÊûÑ‰∏çÁ¨¶ÂêàÈ¢ÑÊúü');\n        console.warn('üí° Âª∫ËÆÆÔºöÊ∏ÖÈô§ÁôªÂΩï‰ø°ÊÅØÂπ∂ÈáçÊñ∞ÁôªÂΩï');\n        \n        // Ëá™Âä®‰øÆÂ§çÔºöÂ¶ÇÊûúÁôªÂΩï‰ø°ÊÅØÂ≠òÂú®‰ΩÜtokenÁº∫Â§±ÔºåÊ∏ÖÈô§ÁôªÂΩï‰ø°ÊÅØÔºàÂè™Ê∏ÖÈô§‰∏ÄÊ¨°Ôºâ\n        // Ê≥®ÊÑèÔºöËøôÈáåÂè™Ê∏ÖÈô§Ôºå‰∏çËá™Âä®Ë∑≥ËΩ¨ÔºåËÆ©Áî®Êà∑ÊâãÂä®ÈáçÊñ∞ÁôªÂΩï\n        if (!hasClearedInvalidLogin && !token) {\n          console.warn('üîß [Ëá™Âä®‰øÆÂ§ç] Ê£ÄÊµãÂà∞Êó†ÊïàÁöÑÁôªÂΩï‰ø°ÊÅØÔºåÊ≠£Âú®Ê∏ÖÈô§...');\n          uni.removeStorageSync('login_info');\n          hasClearedInvalidLogin = true; // Ê†áËÆ∞Â∑≤Ê∏ÖÈô§ÔºåÈÅøÂÖçÈáçÂ§çÊ∏ÖÈô§\n          console.warn('‚úÖ [Ëá™Âä®‰øÆÂ§ç] Â∑≤Ê∏ÖÈô§Êó†ÊïàÁöÑÁôªÂΩï‰ø°ÊÅØ');\n          console.warn('üí° ËØ∑ÈáçÊñ∞ÁôªÂΩï‰ª•Ëé∑ÂèñÊúâÊïàÁöÑtoken');\n          \n          // ÂèØÈÄâÔºöÊòæÁ§∫ÊèêÁ§∫ÁªôÁî®Êà∑\n          uni.showToast({\n            title: 'ÁôªÂΩï‰ø°ÊÅØÂ∑≤ËøáÊúüÔºåËØ∑ÈáçÊñ∞ÁôªÂΩï',\n            icon: 'none',\n            duration: 3000\n          });\n        } else if (hasClearedInvalidLogin) {\n          console.warn('üí° Â∑≤Ê∏ÖÈô§ËøáÊó†ÊïàÁôªÂΩï‰ø°ÊÅØÔºåËØ∑ÈáçÊñ∞ÁôªÂΩï');\n        }\n      } else {\n        console.warn('‚ö†Ô∏è Êú™ÊâæÂà∞ÁôªÂΩï‰ø°ÊÅØÔºåËØ∑ÂÖàÁôªÂΩï')\n      }\n      console.warn('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n    } else {\n      console.log('‚úÖ TokenÂ∑≤ÊâæÂà∞ÔºåÈïøÂ∫¶:', token.length)\n    }\n  }\n  \n  if (token) {\n    options.header = {\n      ...options.header,\n      'Authorization': `Bearer ${token}`\n    }\n  } else if (!isLoginApi) {\n    // Â¶ÇÊûúÊ≤°Êúâtoken‰∏î‰∏çÊòØÁôªÂΩïÊé•Âè£ÔºåÊ∑ªÂä†Ë≠¶Âëä\n    if (process.env.NODE_ENV === 'development') {\n      console.warn('‚ö†Ô∏è ËØ∑Ê±ÇÊú™Êê∫Â∏¶AuthorizationÂ§¥ÔºåÂèØËÉΩÂØºËá¥401ÈîôËØØ')\n      console.warn('‚ö†Ô∏è ÂΩìÂâçËØ∑Ê±ÇURL:', options.url)\n    }\n  }\n  \n  // ÂºÄÂèëÁéØÂ¢É‰∏ãËÆ∞ÂΩïÊâÄÊúâAPIËØ∑Ê±Ç‰ø°ÊÅØ\n  // Âà§Êñ≠ÊòØÂê¶Âú®ÂºÄÂèëÁéØÂ¢ÉÔºöuni-appÂºÄÂèëÂ∑•ÂÖ∑ÊàñÊú¨Âú∞Ë∞ÉËØï\n  let isDev = false;\n  try {\n    isDev = process.env.NODE_ENV === 'development' || \n            typeof __wxConfig !== 'undefined' ||  // ÂæÆ‰ø°Â∞èÁ®ãÂ∫èÂºÄÂèëÂ∑•ÂÖ∑\n            (typeof uni !== 'undefined' && uni.getSystemInfoSync && uni.getSystemInfoSync().platform === 'devtools'); // ÂºÄÂèëÂ∑•ÂÖ∑ÁéØÂ¢É\n  } catch (e) {\n    // Â¶ÇÊûúËé∑ÂèñÁ≥ªÁªü‰ø°ÊÅØÂ§±Ë¥•ÔºåÈªòËÆ§Âà§Êñ≠‰∏∫ÂºÄÂèëÁéØÂ¢ÉÔºà‰øùÂÆàÁ≠ñÁï•ÔºåÁ°Æ‰øùÊó•ÂøóËæìÂá∫Ôºâ\n    isDev = process.env.NODE_ENV === 'development' || typeof __wxConfig !== 'undefined';\n  }\n  \n  // Êó†ËÆ∫ÊòØÂê¶ÂºÄÂèëÁéØÂ¢ÉÔºåÈÉΩËÆ∞ÂΩïÁà±ÂøÉÂ¢ôÁõ∏ÂÖ≥ÁöÑËØ∑Ê±ÇÔºà‰æø‰∫éË∞ÉËØïÔºâ\n  const urlForCheck = options.url || originalUrl || '';\n  const isHeartWallApi = urlForCheck.includes('/api/heart-wall/') || \n                         urlForCheck.includes('heart-wall') ||\n                         urlForCheck.includes('heartwall') ||\n                         urlForCheck.toLowerCase().includes('heart_wall');\n  \n  if (isDev || isHeartWallApi) {\n    // Âà§Êñ≠APIÁ±ªÂûãÔºà‰ΩøÁî®ÂÆåÊï¥URLÊàñÂéüÂßãURLËøõË°åÂà§Êñ≠Ôºâ\n    let apiType = 'ÈÄöÁî®API';\n    if (urlForCheck.includes('/api/challenge/')) {\n      apiType = '‰∏ÄÁôæ‰ª∂‰∫ãAPI';\n    } else if (urlForCheck.includes('/api/couple/')) {\n      apiType = 'ÊÉÖ‰æ£ÁªëÂÆöAPI';\n    } else if (isHeartWallApi) {\n      apiType = 'ÂøÉÂΩ¢Â¢ôAPI';\n    } else if (urlForCheck.includes('/api/qna/')) {\n      apiType = 'ÈóÆÁ≠îAPI';\n    } else if (urlForCheck.includes('/api/login/')) {\n      apiType = 'ÁôªÂΩïAPI';\n    } else if (urlForCheck.includes('/api/user/')) {\n      apiType = 'Áî®Êà∑API';\n    } else if (urlForCheck.includes('/api/letter/')) {\n      apiType = 'ÊÉÖ‰π¶API';\n    }\n    \n    console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n    console.log('üîó [HTTPËØ∑Ê±Ç]', apiType);\n    console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n    console.log('üìç [URL]', options.url);\n    console.log('üìã [ÊñπÊ≥ï]', options.method || 'GET');\n    if (options.data) {\n      console.log('üì§ [ËØ∑Ê±ÇÂèÇÊï∞]', JSON.stringify(options.data, null, 2));\n    }\n    if (token) {\n      console.log('üîë [ËÆ§ËØÅ] TokenÂ∑≤Êê∫Â∏¶ (ÈïøÂ∫¶:', token.length, ')');\n    } else {\n      if (!isLoginApi) {\n        console.warn('‚ö†Ô∏è [ËÆ§ËØÅ] TokenÊú™Êê∫Â∏¶ÔºåËØ∑Ê±ÇÂèØËÉΩÂ§±Ë¥•');\n      } else {\n        console.log('‚ÑπÔ∏è [ËÆ§ËØÅ] ÁôªÂΩïÊé•Âè£ÔºåÊó†ÈúÄToken');\n      }\n    }\n    if (options.header) {\n      console.log('üìã [ËØ∑Ê±ÇÂ§¥]', Object.keys(options.header).join(', '));\n    }\n    console.log('‚è∞ [Êó∂Èó¥]', new Date().toLocaleString());\n    console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n  }\n  \n  return new Promise((resolve, reject) => {\n    uni.request({\n      ...options,\n      success: (res) => {\n        if (res.statusCode >= 200 && res.statusCode < 300) {\n          // ÂºÄÂèëÁéØÂ¢É‰∏ãËÆ∞ÂΩïÊâÄÊúâAPIÂìçÂ∫îÊï∞ÊçÆÔºåÂ∏ÆÂä©Ë∞ÉËØï\n          let isDev = false;\n          try {\n            isDev = process.env.NODE_ENV === 'development' || \n                    typeof __wxConfig !== 'undefined' ||\n                    (typeof uni !== 'undefined' && uni.getSystemInfoSync && uni.getSystemInfoSync().platform === 'devtools');\n          } catch (e) {\n            isDev = process.env.NODE_ENV === 'development' || typeof __wxConfig !== 'undefined';\n          }\n          \n          // Êó†ËÆ∫ÊòØÂê¶ÂºÄÂèëÁéØÂ¢ÉÔºåÈÉΩËÆ∞ÂΩïÁà±ÂøÉÂ¢ôÁõ∏ÂÖ≥ÁöÑÂìçÂ∫îÔºà‰æø‰∫éË∞ÉËØïÔºâ\n          const urlForCheck = options.url || '';\n          const isHeartWallApi = urlForCheck.includes('/api/heart-wall/') || \n                                 urlForCheck.includes('heart-wall') ||\n                                 urlForCheck.includes('heartwall') ||\n                                 urlForCheck.toLowerCase().includes('heart_wall');\n          \n          if (isDev || isHeartWallApi) {\n            // Âà§Êñ≠APIÁ±ªÂûãÔºà‰ΩøÁî®ÂÆåÊï¥URLËøõË°åÂà§Êñ≠Ôºâ\n            let apiType = 'ÈÄöÁî®API';\n            if (urlForCheck.includes('/api/challenge/')) {\n              apiType = '‰∏ÄÁôæ‰ª∂‰∫ãAPI';\n            } else if (urlForCheck.includes('/api/couple/')) {\n              apiType = 'ÊÉÖ‰æ£ÁªëÂÆöAPI';\n            } else if (isHeartWallApi) {\n              apiType = 'ÂøÉÂΩ¢Â¢ôAPI';\n            } else if (urlForCheck.includes('/api/qna/')) {\n              apiType = 'ÈóÆÁ≠îAPI';\n            } else if (urlForCheck.includes('/api/login/')) {\n              apiType = 'ÁôªÂΩïAPI';\n            } else if (urlForCheck.includes('/api/user/')) {\n              apiType = 'Áî®Êà∑API';\n            } else if (urlForCheck.includes('/api/letter/')) {\n              apiType = 'ÊÉÖ‰π¶API';\n            }\n            \n            console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n            console.log('‚úÖ [HTTPÂìçÂ∫î]', apiType, 'ËØ∑Ê±ÇÊàêÂäü');\n            console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n            console.log('üìç [URL]', options.url);\n            console.log('üìä [Áä∂ÊÄÅÁ†Å]', res.statusCode);\n            console.log('üì¶ [ÂìçÂ∫îÊï∞ÊçÆ]', JSON.stringify(res.data, null, 2));\n            \n            // ÁªüËÆ°ÂìçÂ∫îÊï∞ÊçÆ‰ø°ÊÅØ\n            if (res.data && typeof res.data === 'object') {\n              if (res.data.tasks && Array.isArray(res.data.tasks)) {\n                console.log('üìä [Êï∞ÊçÆÁªüËÆ°] ‰ªªÂä°Êï∞Èáè:', res.data.tasks.length);\n              }\n              if (res.data.projects && Array.isArray(res.data.projects)) {\n                console.log('üìä [Êï∞ÊçÆÁªüËÆ°] È°πÁõÆÊï∞Èáè:', res.data.projects.length);\n              }\n              if (res.data.photos && Array.isArray(res.data.photos)) {\n                console.log('üìä [Êï∞ÊçÆÁªüËÆ°] ÁÖßÁâáÊï∞Èáè:', res.data.photos.length);\n              }\n              if (res.data.questions && Array.isArray(res.data.questions)) {\n                console.log('üìä [Êï∞ÊçÆÁªüËÆ°] ÈóÆÈ¢òÊï∞Èáè:', res.data.questions.length);\n              }\n              if (res.data.success !== undefined) {\n                console.log('‚úÖ [‰∏öÂä°Áä∂ÊÄÅ]', res.data.success ? 'ÊàêÂäü' : 'Â§±Ë¥•');\n              }\n              if (res.data.message) {\n                console.log('üí¨ [Ê∂àÊÅØ]', res.data.message);\n              }\n            }\n            \n            console.log('‚è∞ [Êó∂Èó¥]', new Date().toLocaleString());\n            console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n          }\n          \n          // Â¶ÇÊûúÂêéÁ´ØËøîÂõûÁöÑÊ†ºÂºèÊòØ { success: false, message: \"...\" }ÔºåÂ∫îËØ•‰Ωú‰∏∫ÈîôËØØÂ§ÑÁêÜ\n          if (res.data && typeof res.data === 'object' && res.data.success === false) {\n            const errorMessage = res.data.message || 'ËØ∑Ê±ÇÂ§±Ë¥•'\n            const error = new Error(errorMessage)\n            error.statusCode = res.statusCode\n            error.data = res.data\n            \n            // Ê£ÄÊü•ÊòØÂê¶ÊòØtokenËøáÊúüÊàñÊú™ÁôªÂΩïÁöÑÈîôËØØ\n            const isTokenExpired = errorMessage.includes('Êú™ÁôªÂΩï') || \n                                   errorMessage.includes('tokenÂ∑≤ËøáÊúü') || \n                                   errorMessage.includes('tokenËøáÊúü') ||\n                                   errorMessage.includes('ÁôªÂΩïÂ∑≤ËøáÊúü') ||\n                                   errorMessage.includes('Êú™ÊéàÊùÉ') ||\n                                   errorMessage.includes('Unauthorized') ||\n                                   errorMessage.toLowerCase().includes('token expired') ||\n                                   errorMessage.toLowerCase().includes('not logged in')\n            \n            // Â¶ÇÊûúÊòØtokenËøáÊúüÈîôËØØÔºåË∞ÉÁî®handleUnauthorizedÂ§ÑÁêÜ\n            if (isTokenExpired) {\n              handleUnauthorized(errorMessage)\n            }\n            \n            reject(error)\n            return\n          }\n          \n          resolve(res.data)\n        } else {\n          // ÁâπÊÆäÊÉÖÂÜµÔºöÂç≥‰ΩøHTTPÁä∂ÊÄÅÁ†Å‰∏çÊòØ200-299Ôºå‰ΩÜÂ¶ÇÊûúÂìçÂ∫î‰Ωì‰∏≠ success: trueÔºå‰πüÂ∫îËØ•ÂΩì‰ΩúÊàêÂäüÂ§ÑÁêÜ\n          // ËøôÊòØÂõ†‰∏∫ÂêéÁ´ØÂèØËÉΩÂú®‰∏öÂä°ÊàêÂäüÊó∂ËøîÂõû‰∫ÜÈîôËØØÁöÑÁä∂ÊÄÅÁ†ÅÔºàÂ¶Ç500Ôºâ\n          \n          // ÂÖàËÆ∞ÂΩïËØ¶ÁªÜÊó•ÂøóÔºå‰æø‰∫éË∞ÉËØï\n          const urlForCheck = options.url || '';\n          const isHeartWallApi = urlForCheck.includes('/api/heart-wall/') || \n                                 urlForCheck.includes('heart-wall') ||\n                                 urlForCheck.includes('heartwall') ||\n                                 urlForCheck.toLowerCase().includes('heart_wall');\n          \n          // Â∞ùËØïËß£ÊûêÂìçÂ∫îÊï∞ÊçÆÔºàÂ¶ÇÊûúÊòØÂ≠óÁ¨¶‰∏≤Ê†ºÂºèÔºâ\n          let responseData = res.data;\n          if (typeof responseData === 'string') {\n            try {\n              responseData = JSON.parse(responseData);\n            } catch (e) {\n              // Ëß£ÊûêÂ§±Ë¥•Ôºå‰øùÊåÅÂéüÊ†∑\n            }\n          }\n          \n          if (isHeartWallApi || process.env.NODE_ENV === 'development') {\n            console.warn(`‚ö†Ô∏è [HTTPÂìçÂ∫î] Áä∂ÊÄÅÁ†ÅÂºÇÂ∏∏: ${res.statusCode}`);\n            console.warn(`‚ö†Ô∏è [ÂìçÂ∫îÊï∞ÊçÆ]`, responseData);\n            console.warn(`‚ö†Ô∏è [ÂìçÂ∫îÊï∞ÊçÆÁ±ªÂûã]`, typeof responseData);\n            if (responseData && typeof responseData === 'object') {\n              console.warn(`‚ö†Ô∏è [successÂ≠óÊÆµ]`, responseData.success);\n              console.warn(`‚ö†Ô∏è [messageÂ≠óÊÆµ]`, responseData.message);\n              // Â¶ÇÊûúÊòØÂøÉÂΩ¢Â¢ôAPIÔºå‰πüÊ£ÄÊü•photoÂ≠óÊÆµ\n              if (isHeartWallApi && responseData.photo) {\n                console.warn(`‚ö†Ô∏è [photoÂ≠óÊÆµÂ≠òÂú®]`, !!responseData.photo);\n              }\n            }\n          }\n          \n          // Ê£ÄÊü•ÂìçÂ∫îÊï∞ÊçÆ‰∏≠ÊòØÂê¶Êúâ success: true\n          // ÊîØÊåÅÂ§öÁßçÊ†ºÂºèÔºö\n          // 1. { success: true, ... }\n          // 2. { data: { success: true, ... } }\n          // 3. ÂØπ‰∫éÂøÉÂΩ¢Â¢ôAPIÔºå‰πüÊ£ÄÊü•ÊòØÂê¶ÊúâphotoÂ≠óÊÆµÔºàË°®Á§∫ÊàêÂäüÔºâ\n          let isSuccess = false;\n          if (responseData && typeof responseData === 'object') {\n            if (responseData.success === true) {\n              isSuccess = true;\n            } else if (responseData.data && typeof responseData.data === 'object' && responseData.data.success === true) {\n              isSuccess = true;\n              // Â∞ÜdataÊèêÂçá‰∏∫È°∂Â±Ç\n              responseData = responseData.data;\n            } else if (isHeartWallApi && responseData.photo && typeof responseData.photo === 'object') {\n              // ÂØπ‰∫éÂøÉÂΩ¢Â¢ôAPIÔºåÂ¶ÇÊûúËøîÂõû‰∫ÜphotoÂ≠óÊÆµÔºå‰πüËÆ§‰∏∫ÊàêÂäü\n              isSuccess = true;\n            }\n          }\n          \n          if (isSuccess) {\n            console.warn(`‚ö†Ô∏è [HTTPÂìçÂ∫î] ÂêéÁ´ØËøîÂõûÁä∂ÊÄÅÁ†Å ${res.statusCode}Ôºå‰ΩÜ‰∏öÂä°ÈÄªËæëÊàêÂäü (success: true)`);\n            console.warn('‚ö†Ô∏è Âª∫ËÆÆÂêéÁ´Ø‰øÆÊîπÔºöÊàêÂäüÊó∂Â∫îËØ•ËøîÂõû 200 Áä∂ÊÄÅÁ†Å');\n            // ÂΩì‰ΩúÊàêÂäüÂ§ÑÁêÜ\n            resolve(responseData)\n            return\n          }\n          \n          // Â¶ÇÊûúÊ£ÄÊü•Â§±Ë¥•ÔºåËÆ∞ÂΩïËØ¶ÁªÜ‰ø°ÊÅØÂêéreject\n          if (isHeartWallApi || process.env.NODE_ENV === 'development') {\n            console.error('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n            console.error(`‚ùå [HTTPÂìçÂ∫î] Áä∂ÊÄÅÁ†Å ${res.statusCode} ‰∏î‰∏öÂä°ÈÄªËæëÂ§±Ë¥•`);\n            console.error('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n            console.error('üìç [ËØ∑Ê±ÇURL]', options.url);\n            console.error('üìã [ËØ∑Ê±ÇÊñπÊ≥ï]', options.method || 'GET');\n            if (options.data) {\n              console.error('üì§ [ËØ∑Ê±ÇÂèÇÊï∞]', JSON.stringify(options.data, null, 2));\n            }\n            if (options.header) {\n              console.error('üìã [ËØ∑Ê±ÇÂ§¥]', JSON.stringify(options.header, null, 2));\n            }\n            console.error('üìä [ÂìçÂ∫îÁä∂ÊÄÅÁ†Å]', res.statusCode);\n            console.error('üì¶ [ÂÆåÊï¥ÂìçÂ∫îÂØπË±°]', JSON.stringify(res, null, 2));\n            if (!responseData || typeof responseData !== 'object') {\n              console.error(`‚ùå [ÂìçÂ∫îÊï∞ÊçÆ] ‰∏çÊòØÂØπË±°ÔºåÁ±ªÂûã: ${typeof responseData}ÔºåÂÄº:`, responseData);\n            } else {\n              console.error(`‚ùå [successÂ≠óÊÆµ]`, responseData.success);\n              console.error(`‚ùå [messageÂ≠óÊÆµ]`, responseData.message);\n              console.error(`‚ùå [ÂÆåÊï¥ÂìçÂ∫îÊï∞ÊçÆ]`, JSON.stringify(responseData, null, 2));\n              // Ê£ÄÊü•ÂìçÂ∫îÊï∞ÊçÆÁöÑÊâÄÊúâÂ≠óÊÆµ\n              console.error(`‚ùå [ÂìçÂ∫îÊï∞ÊçÆÂ≠óÊÆµÂàóË°®]`, Object.keys(responseData).join(', '));\n              if (isHeartWallApi) {\n                console.error(`‚ùå [photoÂ≠óÊÆµ]`, responseData.photo ? 'Â≠òÂú®' : '‰∏çÂ≠òÂú®');\n              }\n            }\n            console.error('‚è∞ [Êó∂Èó¥]', new Date().toLocaleString());\n            console.error('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n          }\n          \n          // ÂàõÂª∫ Error ÂØπË±°ÔºåÁ°Æ‰øù handleRequestError ËÉΩÊ≠£Á°ÆÂ§ÑÁêÜ\n          const errorMessage = (responseData && typeof responseData === 'object' && responseData.message) \n            ? responseData.message \n            : `ËØ∑Ê±ÇÂ§±Ë¥•ÔºåÁä∂ÊÄÅÁ†Å: ${res.statusCode}`;\n          \n          const error = new Error(errorMessage);\n          error.statusCode = res.statusCode;\n          error.data = responseData || res.data;\n          // Ê∑ªÂä†ÂìçÂ∫îÊï∞ÊçÆÂà∞ÈîôËØØÂØπË±°Ôºå‰æø‰∫é‰∏äÂ±ÇÂ§ÑÁêÜ\n          if (responseData && typeof responseData === 'object') {\n            error.responseData = responseData;\n          }\n          \n          // Â¶ÇÊûúÊòØ 401 ÈîôËØØÔºåÁ´ãÂç≥Â§ÑÁêÜÊú™ÊéàÊùÉÊÉÖÂÜµ\n          // ‰ΩÜÊòØÁôªÂΩïÊé•Âè£ËøîÂõû401Êó∂‰∏çÂ∫îËØ•Ë∞ÉÁî®handleUnauthorizedÔºåÂõ†‰∏∫Ôºö\n          // 1. ÁôªÂΩïÊé•Âè£Êú¨Ë∫´‰∏çÈúÄË¶ÅËÆ§ËØÅ\n          // 2. Â¶ÇÊûúÁôªÂΩïÊé•Âè£ËøîÂõû401ÔºåËØ¥ÊòéÂêéÁ´ØÈÖçÁΩÆÊúâÈóÆÈ¢òÊàñËØ∑Ê±ÇÂèÇÊï∞ÊúâÈóÆÈ¢ò\n          // 3. ‰∏çÂ∫îËØ•Âõ†‰∏∫ÁôªÂΩïÊé•Âè£ËøîÂõû401Â∞±Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µÔºà‰ºöÂØºËá¥Ê≠ªÂæ™ÁéØÔºâ\n          if (res.statusCode === 401) {\n            const urlForCheck = options.url || '';\n            const isLoginApi = urlForCheck.includes('/api/login/') && \n                             !urlForCheck.includes('/api/login/logout');\n            \n            if (isLoginApi) {\n              // ÁôªÂΩïÊé•Âè£ËøîÂõû401ÔºåËØ¥ÊòéÂêéÁ´ØÈÖçÁΩÆÊúâÈóÆÈ¢ò\n              console.error('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n              console.error('‚ùå [‰∏•ÈáçÈîôËØØ] ÁôªÂΩïÊé•Âè£ËøîÂõû401ÈîôËØØÔºÅ');\n              console.error('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n              console.error('‚ö†Ô∏è ÂèØËÉΩÂéüÂõ†Ôºö');\n              console.error('   1. ÂêéÁ´ØÈÖçÁΩÆÈîôËØØÔºöÁôªÂΩïÊé•Âè£Ë¢´ÈîôËØØÂú∞ÈÖçÁΩÆ‰∏∫ÈúÄË¶ÅËÆ§ËØÅ');\n              console.error('   2. ÂêéÁ´ØSpring SecurityÈÖçÁΩÆÈóÆÈ¢òÔºö/api/login/** Ë∑ØÂæÑÊú™Ê≠£Á°ÆÊîæË°å');\n              console.error('   3. ËØ∑Ê±ÇÂèÇÊï∞ÈîôËØØÔºöcode„ÄÅnickNameÊàñavatarUrlÁº∫Â§±ÊàñÊ†ºÂºèÈîôËØØ');\n              console.error('   4. ÂêéÁ´ØÊúçÂä°ÂºÇÂ∏∏ÔºöËÆ§ËØÅÊã¶Êà™Âô®ËØØÊã¶Êà™‰∫ÜÁôªÂΩïÊé•Âè£');\n              console.error('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n              console.error('üìç [ËØ∑Ê±ÇURL]', options.url);\n              console.error('üìã [ËØ∑Ê±ÇÊñπÊ≥ï]', options.method || 'POST');\n              if (options.data) {\n                console.error('üì§ [ËØ∑Ê±ÇÂèÇÊï∞]', JSON.stringify(options.data, null, 2));\n              }\n              console.error('üì¶ [ÂìçÂ∫îÊï∞ÊçÆ]', JSON.stringify(responseData, null, 2));\n              console.error('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n              console.error('üí° Ëß£ÂÜ≥ÊñπÊ°àÔºö');\n              console.error('   1. Ê£ÄÊü•ÂêéÁ´ØSpring SecurityÈÖçÁΩÆÔºåÁ°Æ‰øù /api/login/** Ë∑ØÂæÑÂ∑≤ÊîæË°å');\n              console.error('   2. Ê£ÄÊü•ÂêéÁ´ØËÆ§ËØÅÊã¶Êà™Âô®ÔºåÁ°Æ‰øùÁôªÂΩïÊé•Âè£‰∏çÂú®Êã¶Êà™ËåÉÂõ¥ÂÜÖ');\n              console.error('   3. Ê£ÄÊü•ËØ∑Ê±ÇÂèÇÊï∞ÊòØÂê¶ÂÆåÊï¥‰∏îÊ†ºÂºèÊ≠£Á°Æ');\n              console.error('   4. ËÅîÁ≥ªÂêéÁ´ØÂºÄÂèë‰∫∫ÂëòÊ£ÄÊü•ÂêéÁ´ØÊó•Âøó');\n              console.error('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n              \n              // ÊòæÁ§∫Áî®Êà∑ÂèãÂ•ΩÁöÑÈîôËØØÊèêÁ§∫\n              uni.showToast({\n                title: 'ÁôªÂΩïÂ§±Ë¥•ÔºöÂêéÁ´ØÈÖçÁΩÆÈîôËØØ',\n                icon: 'none',\n                duration: 3000\n              });\n            } else {\n              // ÈùûÁôªÂΩïÊé•Âè£ÁöÑ401ÈîôËØØÔºåÊ≠£Â∏∏Â§ÑÁêÜ\n              handleUnauthorized();\n            }\n          }\n          \n          // Â¶ÇÊûúÊòØ 404 ÈîôËØØ‰∏îÈîôËØØÊ∂àÊÅØÊòØ\"Áî®Êà∑‰∏çÂ≠òÂú®\"Ôºå‰πüÊåâÊú™ÊéàÊùÉÂ§ÑÁêÜ\n          // ËøôÈÄöÂ∏∏Ë°®Á§∫token‰∏≠ÁöÑÁî®Êà∑‰ø°ÊÅØÂ∑≤Â§±ÊïàÊàñÂêéÁ´ØÊï∞ÊçÆÂ∫ì‰∏≠Áî®Êà∑‰∏çÂ≠òÂú®\n          // ‰ΩÜÊòØÂØπ‰∫é‰ΩçÁΩÆÁõ∏ÂÖ≥ÁöÑAPIÂíå‰∏ÄÁôæ‰ª∂‰∫ãAPIÔºå‰∏çËá™Âä®Ë∑≥ËΩ¨ÁôªÂΩïÔºåËÆ©Ë∞ÉÁî®ËÄÖËá™Â∑±Â§ÑÁêÜ\n          if (res.statusCode === 404 && errorMessage && errorMessage.includes('Áî®Êà∑‰∏çÂ≠òÂú®')) {\n            const isLocationApi = options.url.includes('/api/trajectory/location/');\n            const isChallengeApi = options.url.includes('/api/challenge/');\n            \n            if (isLocationApi) {\n              // ‰ΩçÁΩÆÁõ∏ÂÖ≥APIÔºöÂè™ËÆ∞ÂΩïÊó•ÂøóÔºå‰∏çËá™Âä®Ë∑≥ËΩ¨ÁôªÂΩï\n              console.warn('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n              console.warn('‚ö†Ô∏è [HTTPÂìçÂ∫î] Ê£ÄÊµãÂà∞\"Áî®Êà∑‰∏çÂ≠òÂú®\"ÈîôËØØÔºà‰ΩçÁΩÆAPIÔºâ');\n              console.warn('‚ö†Ô∏è ËøôÈÄöÂ∏∏Ë°®Á§∫Áî®Êà∑‰ø°ÊÅØÂ∑≤Â§±ÊïàÊàñtoken‰∏≠ÁöÑÁî®Êà∑Âú®ÂêéÁ´Ø‰∏çÂ≠òÂú®');\n              console.warn('‚ö†Ô∏è ‰ΩçÁΩÆÂäüËÉΩÂ∞ÜÊó†Ê≥ï‰ΩøÁî®Ôºå‰ΩÜ‰∏ç‰ºöÂΩ±ÂìçÈ°µÈù¢ÂÖ∂‰ªñÂäüËÉΩ');\n              console.warn('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n            } else if (isChallengeApi) {\n              // ‰∏ÄÁôæ‰ª∂‰∫ãAPIÔºöÂèØËÉΩÊòØÊé•Âè£‰∏çÂ≠òÂú®Ôºå‰πüÂèØËÉΩÊòØÁî®Êà∑‰∏çÂ≠òÂú®\n              // ‰∏çËá™Âä®Ë∑≥ËΩ¨ÁôªÂΩïÔºåËÆ©Ë∞ÉÁî®ËÄÖËá™Â∑±Â§ÑÁêÜÔºàÂèØ‰ª•ÊòæÁ§∫ÂèãÂ•ΩÊèêÁ§∫Êàñ‰ΩøÁî®Êú¨Âú∞Êï∞ÊçÆÔºâ\n              console.warn('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n              console.warn('‚ö†Ô∏è [HTTPÂìçÂ∫î] Ê£ÄÊµãÂà∞\"Áî®Êà∑‰∏çÂ≠òÂú®\"ÈîôËØØÔºà‰∏ÄÁôæ‰ª∂‰∫ãAPIÔºâ');\n              console.warn('‚ö†Ô∏è ÂèØËÉΩÂéüÂõ†Ôºö');\n              console.warn('   1. Êé•Âè£‰∏çÂ≠òÂú®ÔºàÂêéÁ´ØÊú™ÂÆûÁé∞Ê≠§Êé•Âè£Ôºâ');\n              console.warn('   2. Áî®Êà∑‰ø°ÊÅØÂ∑≤Â§±ÊïàÊàñtoken‰∏≠ÁöÑÁî®Êà∑Âú®ÂêéÁ´Ø‰∏çÂ≠òÂú®');\n              console.warn('‚ö†Ô∏è ‰∏ç‰ºöËá™Âä®Ë∑≥ËΩ¨ÁôªÂΩïÔºåËØ∑Ê£ÄÊü•Êé•Âè£ÊòØÂê¶Â∑≤ÂÆûÁé∞');\n              console.warn('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n            } else {\n              // ÂÖ∂‰ªñAPIÔºöÊ∏ÖÈô§ÁôªÂΩï‰ø°ÊÅØÂπ∂Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µ\n              console.warn('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n              console.warn('‚ö†Ô∏è [HTTPÂìçÂ∫î] Ê£ÄÊµãÂà∞\"Áî®Êà∑‰∏çÂ≠òÂú®\"ÈîôËØØ');\n              console.warn('‚ö†Ô∏è ËøôÈÄöÂ∏∏Ë°®Á§∫Áî®Êà∑‰ø°ÊÅØÂ∑≤Â§±ÊïàÊàñtoken‰∏≠ÁöÑÁî®Êà∑Âú®ÂêéÁ´Ø‰∏çÂ≠òÂú®');\n              console.warn('‚ö†Ô∏è Â∞ÜÊ∏ÖÈô§ÁôªÂΩï‰ø°ÊÅØÂπ∂Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µ');\n              console.warn('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n              handleUnauthorized('Áî®Êà∑‰ø°ÊÅØÂ∑≤Â§±ÊïàÔºåËØ∑ÈáçÊñ∞ÁôªÂΩï');\n            }\n          }\n          \n          reject(error);\n        }\n      },\n      fail: (error) => {\n        // ÂºÄÂèëÁéØÂ¢É‰∏ãËÆ∞ÂΩïÊâÄÊúâAPIÁöÑÈîôËØØ‰ø°ÊÅØ\n        let isDev = false;\n        try {\n          isDev = process.env.NODE_ENV === 'development' || \n                  typeof __wxConfig !== 'undefined' ||\n                  (typeof uni !== 'undefined' && uni.getSystemInfoSync && uni.getSystemInfoSync().platform === 'devtools');\n        } catch (e) {\n          isDev = process.env.NODE_ENV === 'development' || typeof __wxConfig !== 'undefined';\n        }\n        \n        // Êó†ËÆ∫ÊòØÂê¶ÂºÄÂèëÁéØÂ¢ÉÔºåÈÉΩËÆ∞ÂΩïÁà±ÂøÉÂ¢ôÁõ∏ÂÖ≥ÁöÑÈîôËØØÔºà‰æø‰∫éË∞ÉËØïÔºâ\n        const urlForCheck = options.url || '';\n        const isHeartWallApi = urlForCheck.includes('/api/heart-wall/') || \n                               urlForCheck.includes('heart-wall') ||\n                               urlForCheck.includes('heartwall') ||\n                               urlForCheck.toLowerCase().includes('heart_wall');\n        \n        if (isDev || isHeartWallApi) {\n          // Âà§Êñ≠APIÁ±ªÂûãÔºà‰ΩøÁî®ÂÆåÊï¥URLËøõË°åÂà§Êñ≠Ôºâ\n          let apiType = 'ÈÄöÁî®API';\n          if (urlForCheck.includes('/api/challenge/')) {\n            apiType = '‰∏ÄÁôæ‰ª∂‰∫ãAPI';\n          } else if (urlForCheck.includes('/api/couple/')) {\n            apiType = 'ÊÉÖ‰æ£ÁªëÂÆöAPI';\n          } else if (isHeartWallApi) {\n            apiType = 'ÂøÉÂΩ¢Â¢ôAPI';\n          } else if (urlForCheck.includes('/api/qna/')) {\n            apiType = 'ÈóÆÁ≠îAPI';\n          } else if (urlForCheck.includes('/api/login/')) {\n            apiType = 'ÁôªÂΩïAPI';\n          } else if (urlForCheck.includes('/api/user/')) {\n            apiType = 'Áî®Êà∑API';\n          } else if (urlForCheck.includes('/api/letter/')) {\n            apiType = 'ÊÉÖ‰π¶API';\n          }\n          \n          console.error('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n          console.error('‚ùå [HTTPÈîôËØØ]', apiType, 'ËØ∑Ê±ÇÂ§±Ë¥•');\n          console.error('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n          console.error('üìç [URL]', options.url);\n          console.error('üìã [ÊñπÊ≥ï]', options.method || 'GET');\n          console.error('üî¥ [ÈîôËØØËØ¶ÊÉÖ]', error);\n          console.error('üìã [ÈîôËØØÊ∂àÊÅØ]', error.errMsg || error.message || 'Êú™Áü•ÈîôËØØ');\n          console.error('üìä [Áä∂ÊÄÅÁ†Å]', error.statusCode || 'Êó†');\n          \n          // ÈîôËØØÂàÜÊûê\n          if (error.errMsg) {\n            if (error.errMsg.includes('timeout')) {\n              console.error('‚è±Ô∏è [ÈîôËØØÁ±ªÂûã] ËØ∑Ê±ÇË∂ÖÊó∂');\n            } else if (error.errMsg.includes('fail')) {\n              console.error('üîå [ÈîôËØØÁ±ªÂûã] ÁΩëÁªúËøûÊé•Â§±Ë¥•');\n              console.error('üí° [ÊèêÁ§∫] ËØ∑Ê£ÄÊü•Ôºö');\n              console.error('   1. ÂêéÁ´ØÊúçÂä°ÊòØÂê¶Â∑≤ÂêØÂä®');\n              console.error('   2. ËØ∑Ê±ÇÂú∞ÂùÄÊòØÂê¶Ê≠£Á°Æ:', options.url);\n              console.error('   3. ÁΩëÁªúÊòØÂê¶ËøûÈÄö');\n            } else if (error.errMsg.includes('404')) {\n              console.error('üîç [ÈîôËØØÁ±ªÂûã] Êé•Âè£‰∏çÂ≠òÂú® (404)');\n            } else if (error.errMsg.includes('401')) {\n              console.error('üîê [ÈîôËØØÁ±ªÂûã] Êú™ÊéàÊùÉ (401)ÔºåÂèØËÉΩÊòØTokenËøáÊúü');\n            }\n          }\n          \n          console.error('‚è∞ [Êó∂Èó¥]', new Date().toLocaleString());\n          console.error('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');\n        }\n        handleRequestError(error, options)\n          .then(resolve)\n          .catch(reject)\n      }\n    })\n  })\n}\n\n// Êñá‰ª∂‰∏ä‰º†ÊñπÊ≥ï\nfunction upload(options) {\n  // ÂêàÂπ∂ÈªòËÆ§ÈÖçÁΩÆ\n  options = {\n    ...defaultOptions,\n    timeout: config.uploadTimeout || 30000,  // ‰∏ä‰º†ÈªòËÆ§30ÁßíË∂ÖÊó∂\n    header: {\n      'content-type': 'multipart/form-data'\n    },\n    ...options\n  }\n  \n  // È™åËØÅÊñá‰ª∂Ë∑ØÂæÑ\n  if (!options.filePath) {\n    return Promise.reject(new Error('Êú™ÊâæÂà∞‰∏ä‰º†ÁöÑÊñá‰ª∂ÔºöfilePath ÂèÇÊï∞‰∏∫Á©∫'))\n  }\n  \n  // ËÆ∞ÂΩïÂéüÂßãË∑ØÂæÑ\n  const originalFilePath = options.filePath\n  console.log('üìÅ [‰∏ä‰º†] ÂéüÂßãÊñá‰ª∂Ë∑ØÂæÑ:', originalFilePath)\n  \n  // Â§ÑÁêÜÊñá‰ª∂Ë∑ØÂæÑ\n  let validFilePath = originalFilePath\n  \n  if (validFilePath && typeof validFilePath === 'string') {\n    // Â¶ÇÊûúË∑ØÂæÑÂ∑≤ÁªèÊòØÂÆåÊï¥ÁöÑHTTP(S) URLÔºà‰∏î‰∏çÊòØ‰∏¥Êó∂Êñá‰ª∂Ë∑ØÂæÑÔºâÔºåËØ¥ÊòéÊòØÂ∑≤‰∏ä‰º†ÁöÑÂõæÁâáÔºå‰∏çÈúÄË¶Å‰∏ä‰º†\n    if (validFilePath.startsWith('http://') || validFilePath.startsWith('https://')) {\n      // Ê£ÄÊü•ÊòØÂê¶ÊòØ‰∏¥Êó∂Êñá‰ª∂Ë∑ØÂæÑÔºàÂºÄÂèëÂ∑•ÂÖ∑ÂèØËÉΩËøîÂõûËøôÁßçÊ†ºÂºèÔºâ\n      if (validFilePath.includes('://tmp/') || validFilePath.includes('://tmp_')) {\n        // ËøôÊòØÂºÄÂèëÂ∑•ÂÖ∑ËøîÂõûÁöÑ‰∏¥Êó∂Êñá‰ª∂Ë∑ØÂæÑÔºåÈúÄË¶ÅÁâπÊÆäÂ§ÑÁêÜ\n        // Âú®ÂæÆ‰ø°Â∞èÁ®ãÂ∫è‰∏≠Ôºå‰∏¥Êó∂Êñá‰ª∂Ë∑ØÂæÑÂ∫îËØ•ÊòØÊú¨Âú∞Ë∑ØÂæÑÔºåÁõ¥Êé•‰ΩøÁî®ÂèØËÉΩÊó†Êïà\n        // Â∞ùËØïËΩ¨Êç¢‰∏∫Êú¨Âú∞Ë∑ØÂæÑÊ†ºÂºè\n        const pathMatch = validFilePath.match(/:\\/\\/tmp[\\/_](.+)$/)\n        if (pathMatch) {\n          const fileName = pathMatch[1]\n          // Â∞ùËØïÊûÑÈÄ†Êú¨Âú∞Ë∑ØÂæÑÔºà‰ΩÜËøôÂèØËÉΩ‰∏çÂ∑•‰ΩúÔºåÂõ†‰∏∫ÂÆûÈôÖÊñá‰ª∂‰ΩçÁΩÆÂèØËÉΩ‰∏çÂêåÔºâ\n          // ÊúÄÂ•ΩÁöÑÊñπÂºèÊòØÁõ¥Êé•‰ΩøÁî®ÂéüÂßãË∑ØÂæÑÔºåËÆ© uni.uploadFile Â§ÑÁêÜ\n          console.warn('‚ö†Ô∏è [‰∏ä‰º†] Ê£ÄÊµãÂà∞‰∏¥Êó∂Êñá‰ª∂URLÊ†ºÂºèÔºåÂ∞ùËØïÁõ¥Êé•‰ΩøÁî®:', validFilePath)\n          // ‰øùÊåÅÂéüË∑ØÂæÑÔºå‰∏çËΩ¨Êç¢\n        }\n      } else {\n        // ËøôÊòØÂ∑≤‰∏ä‰º†ÁöÑÂÆåÊï¥URLÔºå‰∏çÈúÄË¶Å‰∏ä‰º†\n        console.warn('‚ö†Ô∏è [‰∏ä‰º†] Êñá‰ª∂Ë∑ØÂæÑÂ∑≤ÁªèÊòØURLÊ†ºÂºèÔºåË∑≥Ëøá‰∏ä‰º†:', validFilePath)\n        return Promise.reject(new Error('Êñá‰ª∂Ë∑ØÂæÑÂ∑≤ÁªèÊòØURLÊ†ºÂºèÔºåÊó†ÈúÄ‰∏ä‰º†'))\n      }\n    }\n    // ÂÖ∂‰ªñÊÉÖÂÜµÁõ¥Êé•‰ΩøÁî®ÂéüÂßãË∑ØÂæÑÔºàuni.uploadFile Â∫îËØ•ËÉΩÂ§ÑÁêÜÂêÑÁßçÊú¨Âú∞Ë∑ØÂæÑÊ†ºÂºèÔºâ\n  }\n  \n  // Â§ÑÁêÜËØ∑Ê±ÇURL\n  if (!options.url.startsWith('http')) {\n    options.url = config.baseURL + options.url\n  }\n  \n  // Ê∑ªÂä†token\n  const loginInfo = uni.getStorageSync('login_info')\n  const token = loginInfo?.token\n  \n  if (token) {\n    options.header['Authorization'] = `Bearer ${token}`\n  } else {\n    console.warn('‚ö†Ô∏è ‰∏ä‰º†ËØ∑Ê±ÇÊú™Êê∫Â∏¶AuthorizationÂ§¥ÔºåÂèØËÉΩÂØºËá¥401ÈîôËØØ')\n  }\n  \n  // ‰ΩøÁî®‰øÆÂ§çÂêéÁöÑÊñá‰ª∂Ë∑ØÂæÑ\n  const uploadOptions = {\n    ...options,\n    filePath: validFilePath\n  }\n  \n  return new Promise((resolve, reject) => {\n    console.log('üì§ [‰∏ä‰º†] ÂºÄÂßã‰∏ä‰º†Êñá‰ª∂ÔºåË∑ØÂæÑ:', validFilePath)\n    uni.uploadFile({\n      ...uploadOptions,\n      success: (uploadRes) => {\n        try {\n          const result = JSON.parse(uploadRes.data)\n          if (result.success) {\n            console.log('‚úÖ [‰∏ä‰º†] Êñá‰ª∂‰∏ä‰º†ÊàêÂäü')\n            const normalizedData = result.data !== undefined && result.data !== null\n              ? result.data\n              : result\n            resolve(normalizedData)\n          } else {\n            const errorMsg = result.message || '‰∏ä‰º†Â§±Ë¥•'\n            console.error('‚ùå [‰∏ä‰º†] ÊúçÂä°Âô®ËøîÂõûÂ§±Ë¥•:', errorMsg)\n            reject(new Error(errorMsg))\n          }\n        } catch (e) {\n          console.error('‚ùå [‰∏ä‰º†] Ëß£ÊûêÂìçÂ∫îÂ§±Ë¥•:', e)\n          reject(new Error('Ëß£Êûê‰∏ä‰º†ÂìçÂ∫îÂ§±Ë¥•'))\n        }\n      },\n      fail: (error) => {\n        console.error('‚ùå [‰∏ä‰º†] ‰∏ä‰º†Â§±Ë¥•:', error)\n        console.error('‚ùå [‰∏ä‰º†] ÂéüÂßãË∑ØÂæÑ:', originalFilePath)\n        console.error('‚ùå [‰∏ä‰º†] ‰ΩøÁî®Ë∑ØÂæÑ:', validFilePath)\n        \n        // Ê£ÄÊü•ÊòØÂê¶ÊòØÊñá‰ª∂Ë∑ØÂæÑÈóÆÈ¢ò\n        if (error.errMsg && (error.errMsg.includes('Êú™ÊâæÂà∞') || error.errMsg.includes('file not found') || error.errMsg.includes('no such file') || error.errMsg.includes('file doesn\\'t exist'))) {\n          // Â¶ÇÊûúÊòØÂõ†‰∏∫Ë∑ØÂæÑÈóÆÈ¢òÂ§±Ë¥•ÔºåÂ∞ùËØï‰ΩøÁî®ÂéüÂßãË∑ØÂæÑÔºàÂ¶ÇÊûú‰∏çÂêåÔºâ\n          if (validFilePath !== originalFilePath && originalFilePath) {\n            console.warn('‚ö†Ô∏è [‰∏ä‰º†] ËΩ¨Êç¢ÂêéÁöÑË∑ØÂæÑÊó†ÊïàÔºåÂ∞ùËØï‰ΩøÁî®ÂéüÂßãË∑ØÂæÑ:', originalFilePath)\n            // ËøôÁßçÊÉÖÂÜµ‰∏çÂ∫îËØ•ÂÜçÂ∞ùËØïÔºåÂõ†‰∏∫Â∑≤ÁªèÂ§±Ë¥•‰∫Ü\n          }\n          console.error('‚ùå [‰∏ä‰º†] Êñá‰ª∂Ë∑ØÂæÑÊó†ÊïàÔºåÊó†Ê≥ïÊâæÂà∞Êñá‰ª∂')\n          reject(new Error(`Êú™ÊâæÂà∞‰∏ä‰º†ÁöÑÊñá‰ª∂: ${validFilePath} (ÂéüÂßãË∑ØÂæÑ: ${originalFilePath})`))\n        } else {\n          handleRequestError(error, options)\n            .then(resolve)\n            .catch(reject)\n        }\n      }\n    })\n  })\n}\n\n// HTTPÊñπÊ≥ïÂ∞ÅË£Ö\nconst http = {\n  request,\n  upload,\n  get: (url, data, options = {}) => request({ ...options, url, data, method: 'GET' }),\n  post: (url, data, options = {}) => request({ ...options, url, data, method: 'POST' }),\n  put: (url, data, options = {}) => request({ ...options, url, data, method: 'PUT' }),\n  delete: (url, data, options = {}) => request({ ...options, url, data, method: 'DELETE' })\n}\n\nexport default http\n"],"names":["config","uni","isLoggedIn","logout","isDev","urlForCheck","isHeartWallApi","isLoginApi","isChallengeApi"],"mappings":"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"}