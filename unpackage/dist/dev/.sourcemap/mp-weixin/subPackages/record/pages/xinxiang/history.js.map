{"version":3,"file":"history.js","sources":["subPackages/record/pages/xinxiang/history.vue","D:/softcaree/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c3ViUGFja2FnZXNccmVjb3JkXHBhZ2VzXHhpbnhpYW5nXGhpc3RvcnkudnVl"],"sourcesContent":["<template>\r\n  <view class=\"history-page\" :style=\"{ paddingTop: containerPaddingTop }\">\r\n    <!-- Ëá™ÂÆö‰πâÂØºËà™Ê†è -->\r\n    <view class=\"custom-navbar\">\r\n      <!-- Ê∏êÂèòËÉåÊôØ -->\r\n      <view class=\"navbar-gradient-bg\"></view>\r\n      <!-- Áä∂ÊÄÅÊ†èÂç†‰Ωç -->\r\n      <view class=\"status-bar\" :style=\"{ height: statusBarHeight + 'px' }\"></view>\r\n      <!-- ÂØºËà™Ê†èÂÜÖÂÆπ -->\r\n      <view class=\"navbar-content\" :style=\"{ height: navBarHeight + 'px' }\">\r\n        <view class=\"navbar-left\" @click=\"goBack\">\r\n          <text class=\"back-icon\">‚Üê</text>\r\n        </view>\r\n        <view class=\"navbar-title\">\r\n          <text class=\"title-text\">ÂÜô‰ø°ËÆ∞ÂΩï</text>\r\n        </view>\r\n        <view class=\"navbar-right\"></view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- ÂàÜÁ±ªÊ†áÁ≠æ -->\r\n    <view class=\"category-tabs\">\r\n      <view \r\n        class=\"tab-item\" \r\n        :class=\"{ active: activeTab === 'all' }\"\r\n        @click=\"switchTab('all')\"\r\n      >\r\n        <text>ÂÖ®ÈÉ®</text>\r\n      </view>\r\n      <view \r\n        class=\"tab-item\" \r\n        :class=\"{ active: activeTab === 'unsent' }\"\r\n        @click=\"switchTab('unsent')\"\r\n      >\r\n        <text>Êú™ÂèëÈÄÅ</text>\r\n      </view>\r\n      <view \r\n        class=\"tab-item\" \r\n        :class=\"{ active: activeTab === 'sent' }\"\r\n        @click=\"switchTab('sent')\"\r\n      >\r\n        <text>Â∑≤ÂèëÈÄÅ</text>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- ‰ø°‰ª∂ÂàóË°® -->\r\n    <view v-if=\"filteredLetters.length > 0\" class=\"letter-list\">\r\n      <view \r\n        v-for=\"(letter, index) in filteredLetters\" \r\n        :key=\"letter.id || index\"\r\n        class=\"letter-card\"\r\n        @click=\"viewLetter(letter, index)\"\r\n      >\r\n        <!-- Áº©Áï•ÂõæÈ¢ÑËßà -->\r\n        <view class=\"card-preview\">\r\n          <image \r\n            class=\"preview-bg\" \r\n            :src=\"getLetterBackground(letter)\" \r\n            mode=\"aspectFill\"\r\n          ></image>\r\n          <view class=\"preview-overlay\" :style=\"{ opacity: 1 - letter.opacity / 100 }\"></view>\r\n          <view class=\"preview-badge\">\r\n            <text class=\"badge-text\">{{ letter.style === 'custom' ? 'Ëá™ÂÆö‰πâ' : 'Ê†∑Âºè' + letter.style }}</text>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- ‰ø°‰ª∂‰ø°ÊÅØ -->\r\n        <view class=\"card-info\">\r\n          <text class=\"card-title\">{{ letter.title }}</text>\r\n          <view class=\"card-meta\">\r\n            <text class=\"meta-item\">üìÖ ÈÄÅËææ: {{ letter.deliveryDate }}</text>\r\n            <text class=\"meta-item\">üìù {{ letter.createTime }}</text>\r\n            <view class=\"meta-item\">\r\n              <text class=\"status-badge\" :class=\"getStatusClass(letter.status)\">\r\n                {{ getStatusText(letter.status) }}\r\n              </text>\r\n            </view>\r\n          </view>\r\n          <view class=\"card-preview-content\">\r\n            <text class=\"preview-text\">{{ letter.content.slice(0, 50) }}{{ letter.content.length > 50 ? '...' : '' }}</text>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- Êìç‰ΩúÊåâÈíÆ -->\r\n        <view class=\"card-actions\">\r\n          <view class=\"action-btn view\" @click.stop=\"viewLetter(letter, index)\">\r\n            <text>üëÅÔ∏è Êü•Áúã</text>\r\n          </view>\r\n          <view class=\"action-btn delete\" @click.stop=\"confirmDelete(letter, index)\">\r\n            <text>üóëÔ∏è Âà†Èô§</text>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- Á©∫Áä∂ÊÄÅ -->\r\n    <view v-else class=\"empty-state\">\r\n      <text class=\"empty-icon\">‚úâÔ∏è</text>\r\n      <text class=\"empty-text\">{{ emptyText }}</text>\r\n      <button v-if=\"activeTab !== 'sent'\" class=\"write-btn\" @click=\"goWrite\">ÂÜôÁ¨¨‰∏ÄÂ∞Å‰ø°</button>\r\n    </view>\r\n\r\n    <!-- ‰ø°‰ª∂ËØ¶ÊÉÖÂºπÁ™ó -->\r\n    <view v-if=\"showDetailModal\" class=\"detail-modal-overlay\" @click=\"closeDetail\">\r\n      <view class=\"detail-modal-content\" @click.stop>\r\n        <text class=\"detail-modal-title\">‰ø°‰ª∂ËØ¶ÊÉÖ</text>\r\n        \r\n        <!-- ‰ø°‰ª∂ËûçÂêàÈ¢ÑËßà -->\r\n        <view class=\"letter-detail\">\r\n          <view class=\"letter-wrapper\">\r\n            <!-- Â∫ïÂõæÂ±Ç -->\r\n            <image \r\n              class=\"letter-bg\" \r\n              :src=\"getLetterBackground(currentLetter)\" \r\n              mode=\"aspectFill\"\r\n            ></image>\r\n            \r\n            <!-- ÈÄèÊòéÂ∫¶ÈÅÆÁΩ© -->\r\n            <view class=\"letter-overlay\" :style=\"{ opacity: 1 - currentLetter.opacity / 100 }\"></view>\r\n            \r\n            <!-- ‰ø°‰ª∂ÂÜÖÂÆπÂ±Ç -->\r\n            <view class=\"letter-content\">\r\n              <view class=\"letter-header\">\r\n                <text class=\"letter-title\" :class=\"getFontClass(currentLetter)\">{{ currentLetter.title }}</text>\r\n                <text v-if=\"currentLetter.sentAt && currentLetter.sentAt !== '--'\" class=\"letter-date\" :class=\"getFontClass(currentLetter)\">ÂèëÈÄÅÊó∂Èó¥Ôºö{{ currentLetter.sentAt }}</text>\r\n                <text v-if=\"currentLetter.deliveryDate && currentLetter.deliveryDate !== '--'\" class=\"letter-date\" :class=\"getFontClass(currentLetter)\">ÈÄÅËææÊó∂Èó¥Ôºö{{ currentLetter.deliveryDate }}</text>\r\n              </view>\r\n              \r\n              <view class=\"letter-body\">\r\n                <text class=\"letter-text\" :class=\"getFontClass(currentLetter)\">{{ currentLetter.content }}</text>\r\n              </view>\r\n              \r\n              <view class=\"letter-footer\">\r\n                <text class=\"letter-info\" :class=\"getFontClass(currentLetter)\">‚Äî‚Äî ÁªôÊú™Êù•ÁöÑ‰Ω†</text>\r\n                <text class=\"letter-time\" :class=\"getFontClass(currentLetter)\">ÂàõÂª∫‰∫é {{ currentLetter.createTime }}</text>\r\n              </view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"detail-modal-actions\">\r\n          <button class=\"detail-modal-btn close\" @click=\"closeDetail\">ÂÖ≥Èó≠</button>\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { \r\n  getFutureLetterList, \r\n  getSentLetters,\r\n  deleteFutureLetter,\r\n  getFutureLetterDetail\r\n} from '@/api/futureLetter.js';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      statusBarHeight: 0,\r\n      navBarHeight: 44,\r\n      screenWidth: 375,\r\n      letters: [],\r\n      sentLetters: [],\r\n      activeTab: 'all',\r\n      showDetailModal: false,\r\n      currentLetter: null,\r\n      currentIndex: -1\r\n    };\r\n  },\r\n  computed: {\r\n    containerPaddingTop() {\r\n      const totalHeightPx = this.statusBarHeight + this.navBarHeight;\r\n      const pxToRpx = 750 / this.screenWidth;\r\n      const totalHeightRpx = totalHeightPx * pxToRpx;\r\n      return totalHeightRpx + 20 + 'rpx';\r\n    },\r\n    filteredLetters() {\r\n      if (this.activeTab === 'all') {\r\n        return [...this.letters, ...this.sentLetters];\r\n      } else if (this.activeTab === 'unsent') {\r\n        return this.letters;\r\n      } else if (this.activeTab === 'sent') {\r\n        return this.sentLetters;\r\n      }\r\n      return [];\r\n    },\r\n    emptyText() {\r\n      if (this.activeTab === 'sent') {\r\n        return 'ËøòÊ≤°ÊúâÂ∑≤ÂèëÈÄÅÁöÑ‰ø°‰ª∂';\r\n      } else if (this.activeTab === 'unsent') {\r\n        return 'ËøòÊ≤°ÊúâÊú™ÂèëÈÄÅÁöÑ‰ø°‰ª∂';\r\n      }\r\n      return 'ËøòÊ≤°ÊúâÂÜôËøá‰ø°‰ª∂';\r\n    }\r\n  },\r\n  onLoad() {\r\n    this.getSystemInfo();\r\n    \r\n    // Ê£ÄÊü•ÊòØÂê¶‰∏∫Ê∏∏ÂÆ¢Áî®Êà∑\r\n    const loginInfo = uni.getStorageSync('login_info');\r\n    const isGuest = !loginInfo || loginInfo.isGuest || !loginInfo.isLoggedIn;\r\n    \r\n    if (isGuest) {\r\n      // Ê∏∏ÂÆ¢Ê®°ÂºèÔºö‰ΩøÁî®ÈªòËÆ§Êï∞ÊçÆÔºå‰∏çË∞ÉÁî®API\r\n      console.log('üë§ Ê∏∏ÂÆ¢Ê®°ÂºèÔºöÊòæÁ§∫Á§∫‰æã‰ø°‰ª∂');\r\n      this.useGuestMode();\r\n    } else {\r\n      // ÁôªÂΩïÁî®Êà∑Ôºö‰ªéÂêéÁ´ØÂä†ËΩΩÊï∞ÊçÆ\r\n      this.loadLetters();\r\n    }\r\n  },\r\n  onShow() {\r\n    // Ê£ÄÊü•ÊòØÂê¶‰∏∫Ê∏∏ÂÆ¢Áî®Êà∑\r\n    const loginInfo = uni.getStorageSync('login_info');\r\n    const isGuest = !loginInfo || loginInfo.isGuest || !loginInfo.isLoggedIn;\r\n    \r\n    if (!isGuest) {\r\n      this.loadLetters();\r\n    }\r\n    // Ê∏∏ÂÆ¢Áî®Êà∑‰∏çÈáçÊñ∞Âä†ËΩΩÊï∞ÊçÆÔºå‰øùÊåÅÁé∞ÊúâÁöÑÁ§∫‰æãÊï∞ÊçÆ\r\n  },\r\n  methods: {\r\n    // Ê∏∏ÂÆ¢Ê®°ÂºèÔºö‰ΩøÁî®ÈªòËÆ§Êï∞ÊçÆ\r\n    useGuestMode() {\r\n      // ËÆæÁΩÆÁ§∫‰æã‰ø°‰ª∂\r\n      this.letters = [\r\n        {\r\n          id: 'sample1',\r\n          title: 'Á§∫‰æãÊÉÖ‰π¶1',\r\n          deliveryDate: '2024-01-01',\r\n          content: 'ËøôÊòØ‰∏ÄÂ∞ÅÁ§∫‰æãÊÉÖ‰π¶ÁöÑÂÜÖÂÆπ...',\r\n          createTime: new Date().toLocaleDateString(),\r\n          status: 'DRAFT'\r\n        },\r\n        {\r\n          id: 'sample2',\r\n          title: 'Á§∫‰æãÊÉÖ‰π¶2', \r\n          deliveryDate: '2024-02-14',\r\n          content: 'ËøôÊòØÂè¶‰∏ÄÂ∞ÅÁ§∫‰æãÊÉÖ‰π¶ÁöÑÂÜÖÂÆπ...',\r\n          createTime: new Date().toLocaleDateString(),\r\n          status: 'SENT'\r\n        }\r\n      ];\r\n      \r\n      console.log('‚úÖ Ê∏∏ÂÆ¢Ê®°ÂºèÂàùÂßãÂåñÂÆåÊàê');\r\n    },\r\n\r\n    goBack() {\r\n      uni.navigateBack();\r\n    },\r\n    getSystemInfo() {\r\n      const systemInfo = uni.getSystemInfoSync();\r\n      this.statusBarHeight = systemInfo.statusBarHeight || 0;\r\n      this.screenWidth = systemInfo.windowWidth || 375;\r\n      // #ifdef MP-WEIXIN\r\n      this.navBarHeight = 44;\r\n      // #endif\r\n      // #ifdef H5\r\n      this.navBarHeight = 44;\r\n      // #endif\r\n    },\r\n    // ÂàáÊç¢Ê†áÁ≠æ\r\n    switchTab(tab) {\r\n      this.activeTab = tab;\r\n    },\r\n    \r\n    // Âä†ËΩΩ‰ø°‰ª∂ÂàóË°®\r\n    async loadLetters() {\r\n      try {\r\n        // Âä†ËΩΩÊú™ÂèëÈÄÅÁöÑ‰ø°‰ª∂ÔºàËçâÁ®øÂíåÂ∑≤ÂÆâÊéíÔºâ\r\n        const response = await getFutureLetterList();\r\n        const backendLetters = this.extractLetterArray(response).filter(Boolean);\r\n        this.letters = backendLetters\r\n          .filter(letter => letter.status !== 'SENT') // ËøáÊª§ÊéâÂ∑≤ÂèëÈÄÅÁöÑ\r\n          .map(letter => {\r\n            const deliveryDateRaw = letter.scheduledTime || letter.scheduledDate || letter.deliveryDate;\r\n            const createTimeRaw = letter.createdAt || letter.createTime;\r\n            \r\n            return {\r\n              id: letter.id,\r\n              title: letter.title,\r\n              content: letter.content,\r\n              deliveryDate: this.formatToMinute(deliveryDateRaw),\r\n              createTime: this.formatToMinute(createTimeRaw),\r\n              status: letter.status,\r\n              style: this.getStyleFromBackground(letter.backgroundImage),\r\n              customImage: letter.backgroundImage,\r\n              opacity: 100, // ÈªòËÆ§ÈÄèÊòéÂ∫¶\r\n              fontStyle: letter.fontStyle || letter.font_style || 'default',\r\n              // ‰øùÁïôÂêéÁ´ØÂéüÂßãÊï∞ÊçÆ\r\n              _backendData: letter\r\n            };\r\n          });\r\n      } catch (error) {\r\n        console.error('Âä†ËΩΩ‰ø°‰ª∂Â§±Ë¥•', error);\r\n        // Â¶ÇÊûúAPIË∞ÉÁî®Â§±Ë¥•ÔºåÂ∞ùËØï‰ªéÊú¨Âú∞Â≠òÂÇ®Âä†ËΩΩÔºàÈôçÁ∫ßÊñπÊ°àÔºâ\r\n        try {\r\n          const localLetters = uni.getStorageSync('xinxiang_letters') || [];\r\n          this.letters = localLetters.filter(letter => letter.status !== 'SENT');\r\n        } catch (e) {\r\n          console.error('Âä†ËΩΩÊú¨Âú∞‰ø°‰ª∂Â§±Ë¥•', e);\r\n          this.letters = [];\r\n        }\r\n        \r\n        // ÊòæÁ§∫ÈîôËØØÊèêÁ§∫ÔºàÈùûÂÖ≥ÈîÆÈîôËØØÔºå‰∏çÈòªÂ°ûÁî®Êà∑Ôºâ\r\n        if (error.statusCode !== 401) {\r\n          // 401ÈîôËØØÁî±http.jsÁªü‰∏ÄÂ§ÑÁêÜÔºåËøôÈáå‰∏çÈáçÂ§çÊèêÁ§∫\r\n          console.warn('‰ªéÂêéÁ´ØÂä†ËΩΩ‰ø°‰ª∂Â§±Ë¥•Ôºå‰ΩøÁî®Êú¨Âú∞Êï∞ÊçÆ');\r\n        }\r\n      }\r\n      \r\n      // Âä†ËΩΩÂ∑≤ÂèëÈÄÅÁöÑ‰ø°‰ª∂\r\n      try {\r\n        const sentResponse = await getSentLetters();\r\n        const backendSentLetters = this.extractLetterArray(sentResponse);\r\n        this.sentLetters = backendSentLetters.map(letter => {\r\n          const deliveryDateRaw = letter.scheduledTime || letter.scheduledDate || letter.deliveryDate;\r\n          const createTimeRaw = letter.createdAt || letter.createTime;\r\n          const sentAtRaw = letter.sentAt;\r\n          \r\n          return {\r\n            id: letter.id,\r\n            title: letter.title,\r\n            content: letter.content,\r\n            deliveryDate: this.formatToMinute(deliveryDateRaw),\r\n            createTime: this.formatToMinute(createTimeRaw),\r\n            sentAt: this.formatToMinute(sentAtRaw),\r\n            status: letter.status,\r\n            style: this.getStyleFromBackground(letter.backgroundImage),\r\n            customImage: letter.backgroundImage,\r\n            opacity: 100,\r\n            fontStyle: letter.fontStyle || letter.font_style || 'default',\r\n            _backendData: letter\r\n          };\r\n        });\r\n      } catch (error) {\r\n        console.error('Âä†ËΩΩÂ∑≤ÂèëÈÄÅ‰ø°‰ª∂Â§±Ë¥•', error);\r\n        if (error.statusCode !== 401) {\r\n          console.warn('‰ªéÂêéÁ´ØÂä†ËΩΩÂ∑≤ÂèëÈÄÅ‰ø°‰ª∂Â§±Ë¥•');\r\n        }\r\n      }\r\n    },\r\n    \r\n    // Ëé∑ÂèñÁä∂ÊÄÅÊñáÊú¨\r\n    getStatusText(status) {\r\n      const statusMap = {\r\n        'DRAFT': 'ËçâÁ®ø',\r\n        'SCHEDULED': 'Â∑≤ÂÆâÊéí',\r\n        'SENT': 'Â∑≤ÂèëÈÄÅ'\r\n      };\r\n      return statusMap[status] || status;\r\n    },\r\n    \r\n    // Ëé∑ÂèñÁä∂ÊÄÅÊ†∑ÂºèÁ±ª\r\n    getStatusClass(status) {\r\n      const classMap = {\r\n        'DRAFT': 'status-draft',\r\n        'SCHEDULED': 'status-scheduled',\r\n        'SENT': 'status-sent'\r\n      };\r\n      return classMap[status] || '';\r\n    },\r\n    \r\n    // ‰ªéËÉåÊôØÂõæÁâáURLÊèêÂèñÊ†∑ÂºèID\r\n    getStyleFromBackground(backgroundImage) {\r\n      if (!backgroundImage) return 1;\r\n      // Â¶ÇÊûúÊòØËá™ÂÆö‰πâÂõæÁâáÔºåËøîÂõû'custom'\r\n      if (backgroundImage.includes('custom') || backgroundImage.startsWith('http')) {\r\n        return 'custom';\r\n      }\r\n      // ‰ªéË∑ØÂæÑ‰∏≠ÊèêÂèñÊ†∑ÂºèÁºñÂè∑ÔºåÂ¶Ç /static/xinxiang/xin1.jpg -> 1\r\n      const match = backgroundImage.match(/xin(\\d+)\\.jpg/);\r\n      return match ? parseInt(match[1]) : 1;\r\n    },\r\n    \r\n    // Ëé∑Âèñ‰ø°‰ª∂ËÉåÊôØÂõæ\r\n    getLetterBackground(letter) {\r\n      if (letter.style === 'custom') {\r\n        return letter.customImage;\r\n      }\r\n      return `/subPackages/record/static/xinxiang/xin${letter.style}.jpg`;\r\n    },\r\n    \r\n    // ÂÖºÂÆπÂ§öÁßçÂìçÂ∫îÁªìÊûÑ\r\n    extractLetterArray(response) {\r\n      if (!response) return [];\r\n      \r\n      const candidates = [\r\n        response,\r\n        response?.data,\r\n        response?.letters,\r\n        response?.records,\r\n        response?.items,\r\n        response?.list,\r\n        response?.result,\r\n        response?.body,\r\n        response?.data?.letters,\r\n        response?.data?.records,\r\n        response?.data?.items,\r\n        response?.data?.list,\r\n        response?.data?.result,\r\n        response?.data?.content,\r\n        response?.data?.rows\r\n      ];\r\n      \r\n      for (const candidate of candidates) {\r\n        if (Array.isArray(candidate)) {\r\n          return candidate;\r\n        }\r\n      }\r\n      \r\n      return [];\r\n    },\r\n    \r\n    // Â∞ÜÊó∂Èó¥Áªü‰∏ÄÊ†ºÂºèÂåñÂà∞ÂàÜÈíü\r\n    formatToMinute(dateInput) {\r\n      if (!dateInput) return '--';\r\n      \r\n      const dateValue = dateInput instanceof Date ? dateInput : new Date(dateInput);\r\n      if (Number.isNaN(dateValue.getTime())) {\r\n        return typeof dateInput === 'string' ? dateInput : '--';\r\n      }\r\n      \r\n      const pad = num => (num < 10 ? `0${num}` : `${num}`);\r\n      const year = dateValue.getFullYear();\r\n      const month = pad(dateValue.getMonth() + 1);\r\n      const day = pad(dateValue.getDate());\r\n      const hours = pad(dateValue.getHours());\r\n      const minutes = pad(dateValue.getMinutes());\r\n      \r\n      return `${year}-${month}-${day} ${hours}:${minutes}`;\r\n    },\r\n    \r\n    // Êü•Áúã‰ø°‰ª∂ËØ¶ÊÉÖ\r\n    async viewLetter(letter, index) {\r\n      try {\r\n        // ÊòæÁ§∫Âä†ËΩΩÊèêÁ§∫\r\n        uni.showLoading({ title: 'Âä†ËΩΩ‰∏≠...' });\r\n        \r\n        // Ë∞ÉÁî®ËØ¶ÊÉÖÊé•Âè£Ëé∑ÂèñÂÆåÊï¥‰ø°ÊÅØ\r\n        const response = await getFutureLetterDetail(letter.id);\r\n        \r\n        uni.hideLoading();\r\n        \r\n        // Â§ÑÁêÜÂìçÂ∫îÊï∞ÊçÆ\r\n        if (response && response.data) {\r\n          const detailData = response.data;\r\n          const detailDeliveryDate = detailData.scheduledTime || detailData.scheduledDate || detailData.deliveryDate || letter.deliveryDate;\r\n          const detailCreateTime = detailData.createdAt || detailData.createTime || letter.createTime;\r\n          const detailSentAt = detailData.sentAt || letter.sentAt;\r\n          // ÂêàÂπ∂ËØ¶ÊÉÖÊï∞ÊçÆÂà∞ÂΩìÂâç‰ø°‰ª∂ÂØπË±°\r\n          this.currentLetter = {\r\n            ...letter,\r\n            ...detailData,\r\n            // Á°Æ‰øùÂ≠óÊÆµÊò†Â∞ÑÊ≠£Á°Æ\r\n            id: detailData.id || letter.id,\r\n            title: detailData.title || letter.title,\r\n            content: detailData.content || letter.content,\r\n            deliveryDate: this.formatToMinute(detailDeliveryDate),\r\n            createTime: this.formatToMinute(detailCreateTime),\r\n            sentAt: this.formatToMinute(detailSentAt),\r\n            status: detailData.status || letter.status,\r\n            style: this.getStyleFromBackground(detailData.backgroundImage || letter.backgroundImage),\r\n            customImage: detailData.backgroundImage || letter.customImage,\r\n            opacity: detailData.opacity !== undefined ? detailData.opacity : (letter.opacity || 100),\r\n            fontStyle: detailData.fontStyle || detailData.font_style || letter.fontStyle || 'default',\r\n            _backendData: detailData\r\n          };\r\n        } else {\r\n          // Â¶ÇÊûúËØ¶ÊÉÖÊé•Âè£Â§±Ë¥•Ôºå‰ΩøÁî®ÂàóË°®Êï∞ÊçÆ\r\n          this.currentLetter = letter;\r\n        }\r\n        \r\n        this.currentIndex = index;\r\n        this.showDetailModal = true;\r\n      } catch (error) {\r\n        uni.hideLoading();\r\n        console.error('Ëé∑Âèñ‰ø°‰ª∂ËØ¶ÊÉÖÂ§±Ë¥•', error);\r\n        \r\n        // Â¶ÇÊûúËØ¶ÊÉÖÊé•Âè£Â§±Ë¥•Ôºå‰ΩøÁî®ÂàóË°®Êï∞ÊçÆ‰Ωú‰∏∫ÈôçÁ∫ßÊñπÊ°à\r\n        this.currentLetter = letter;\r\n        this.currentIndex = index;\r\n        this.showDetailModal = true;\r\n        \r\n        // ÊòæÁ§∫ÈîôËØØÊèêÁ§∫ÔºàÈùûÈòªÂ°ûÔºâ\r\n        uni.showToast({\r\n          title: 'Âä†ËΩΩËØ¶ÊÉÖÂ§±Ë¥•ÔºåÊòæÁ§∫Âü∫Êú¨‰ø°ÊÅØ',\r\n          icon: 'none',\r\n          duration: 2000\r\n        });\r\n      }\r\n    },\r\n    \r\n    // Ëé∑ÂèñÂ≠ó‰ΩìÊ†∑ÂºèÁ±ª\r\n    getFontClass(letter) {\r\n      if (!letter) return 'font-style-default';\r\n      const fontStyle = letter.fontStyle || letter.font_style || 'default';\r\n      return `font-style-${fontStyle}`;\r\n    },\r\n    \r\n    // ÂÖ≥Èó≠ËØ¶ÊÉÖÂºπÁ™ó\r\n    closeDetail() {\r\n      this.showDetailModal = false;\r\n      this.currentLetter = null;\r\n      this.currentIndex = -1;\r\n    },\r\n    \r\n    // Á°ÆËÆ§Âà†Èô§\r\n    confirmDelete(letter, index) {\r\n      uni.showModal({\r\n        title: 'Á°ÆËÆ§Âà†Èô§',\r\n        content: 'Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÂ∞Å‰ø°‰ª∂ÂêóÔºü',\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            this.deleteLetter(letter, index);\r\n          }\r\n        }\r\n      });\r\n    },\r\n    \r\n    // Âà†Èô§‰ø°‰ª∂\r\n    async deleteLetter(letter, index) {\r\n      const isInSent = this.sentLetters.some(l => l.id === letter.id);\r\n      const sourceList = isInSent ? this.sentLetters : this.letters;\r\n      const sourceIndex = sourceList.findIndex(l => l.id === letter.id);\r\n      \r\n      // Â¶ÇÊûúÊúâÂêéÁ´ØIDÔºåË∞ÉÁî®ÂêéÁ´ØAPIÂà†Èô§\r\n      if (letter && letter.id) {\r\n        try {\r\n          uni.showLoading({ title: 'Ê≠£Âú®Âà†Èô§...' });\r\n          await deleteFutureLetter(letter.id);\r\n          uni.hideLoading();\r\n          \r\n          // ‰ªéÂàóË°®‰∏≠ÁßªÈô§\r\n          if (sourceIndex !== -1) {\r\n            sourceList.splice(sourceIndex, 1);\r\n          }\r\n          \r\n          // ÂêåÊó∂Êõ¥Êñ∞Êú¨Âú∞Â≠òÂÇ®ÔºàÂ¶ÇÊûúÂ≠òÂú®Ôºâ\r\n          try {\r\n            const localLetters = uni.getStorageSync('xinxiang_letters') || [];\r\n            const localIndex = localLetters.findIndex(l => l.id === letter.id);\r\n            if (localIndex !== -1) {\r\n              localLetters.splice(localIndex, 1);\r\n              uni.setStorageSync('xinxiang_letters', localLetters);\r\n            }\r\n          } catch (e) {\r\n            console.warn('Êõ¥Êñ∞Êú¨Âú∞Â≠òÂÇ®Â§±Ë¥•', e);\r\n          }\r\n          \r\n          uni.showToast({ title: 'Â∑≤Âà†Èô§', icon: 'success' });\r\n        } catch (error) {\r\n          uni.hideLoading();\r\n          console.error('Âà†Èô§‰ø°‰ª∂Â§±Ë¥•:', error);\r\n          uni.showToast({ \r\n            title: error.message || 'Âà†Èô§Â§±Ë¥•ÔºåËØ∑ÈáçËØï', \r\n            icon: 'none' \r\n          });\r\n        }\r\n      } else {\r\n        // Ê≤°ÊúâÂêéÁ´ØIDÔºåÂè™Âà†Èô§Êú¨Âú∞Êï∞ÊçÆ\r\n        try {\r\n          if (sourceIndex !== -1) {\r\n            sourceList.splice(sourceIndex, 1);\r\n          }\r\n          uni.setStorageSync('xinxiang_letters', [...this.letters, ...this.sentLetters]);\r\n          uni.showToast({ title: 'Â∑≤Âà†Èô§', icon: 'success' });\r\n        } catch (e) {\r\n          uni.showToast({ title: 'Âà†Èô§Â§±Ë¥•', icon: 'none' });\r\n        }\r\n      }\r\n    },\r\n    \r\n    // ÂéªÂÜô‰ø°\r\n    goWrite() {\r\n      uni.navigateTo({ url: '/subPackages/record/pages/xinxiang/create' });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n/* Ëá™ÂÆö‰πâÂØºËà™Ê†èÊ†∑Âºè */\r\n.custom-navbar {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  z-index: 9999;\r\n  background-color: #FFFAF4;\r\n  overflow: hidden;\r\n}\r\n\r\n.navbar-gradient-bg {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  height: 200%;\r\n  background: rgba(255, 255, 255, 0.7);\r\n  backdrop-filter: blur(15px);\r\n  -webkit-backdrop-filter: blur(15px);\r\n}\r\n\r\n.status-bar {\r\n  width: 100%;\r\n  background: transparent;\r\n  position: relative;\r\n  z-index: 1;\r\n}\r\n\r\n.navbar-content {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 0 30rpx;\r\n  box-sizing: border-box;\r\n  position: relative;\r\n  z-index: 1;\r\n}\r\n\r\n.navbar-title {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  text-align: center;\r\n}\r\n\r\n.title-text {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: #4A4A4A;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n\r\n.navbar-left {\r\n  width: 80rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.back-icon {\r\n  font-size: 50rpx;\r\n  font-weight: 600;\r\n  color: #4A4A4A;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  transition: opacity 0.3s;\r\n}\r\n\r\n.back-icon:active {\r\n  opacity: 0.6;\r\n}\r\n\r\n.navbar-right {\r\n  width: 80rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.history-page {\r\n  min-height: 100vh;\r\n  background: #FFFAF4;\r\n  padding: 24rpx;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n\r\n/* ÂàÜÁ±ªÊ†áÁ≠æ */\r\n.category-tabs {\r\n  display: flex;\r\n  gap: 16rpx;\r\n  margin-bottom: 24rpx;\r\n  background: #ffffff;\r\n  padding: 16rpx;\r\n  border-radius: 16rpx;\r\n  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.04);\r\n}\r\n\r\n.tab-item {\r\n  flex: 1;\r\n  padding: 16rpx 24rpx;\r\n  text-align: center;\r\n  border-radius: 12rpx;\r\n  background: #F8F0FC;\r\n  transition: all 0.3s;\r\n  cursor: pointer;\r\n}\r\n\r\n.tab-item text {\r\n  font-size: 28rpx;\r\n  color: #888888;\r\n  font-weight: 500;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n\r\n.tab-item.active {\r\n  background: #FFE0CC;\r\n}\r\n\r\n.tab-item.active text {\r\n  color: #3d2a00;\r\n  font-weight: 600;\r\n}\r\n\r\n/* ‰ø°‰ª∂ÂàóË°® */\r\n.letter-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 24rpx;\r\n}\r\n\r\n.letter-card {\r\n  background: #ffffff;\r\n  border-radius: 24rpx;\r\n  overflow: hidden;\r\n  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.06);\r\n  border: 1rpx solid #FFE6D0;\r\n}\r\n\r\n/* Áº©Áï•ÂõæÈ¢ÑËßà */\r\n.card-preview {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 240rpx;\r\n  overflow: hidden;\r\n}\r\n\r\n.preview-bg {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.preview-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: #ffffff;\r\n}\r\n\r\n.preview-badge {\r\n  position: absolute;\r\n  top: 16rpx;\r\n  right: 16rpx;\r\n  background: rgba(255, 181, 194, 0.9);\r\n  padding: 8rpx 16rpx;\r\n  border-radius: 8rpx;\r\n}\r\n\r\n.badge-text {\r\n  font-size: 22rpx;\r\n  color: #ffffff;\r\n  font-weight: 600;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n\r\n/* Âç°Áâá‰ø°ÊÅØ */\r\n.card-info {\r\n  padding: 24rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12rpx;\r\n}\r\n\r\n.card-title {\r\n  font-size: 34rpx;\r\n  font-weight: 600;\r\n  color: #4A4A4A;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n\r\n.card-meta {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8rpx;\r\n}\r\n\r\n.meta-item {\r\n  font-size: 24rpx;\r\n  color: #888888;\r\n  font-weight: 400;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n\r\n.status-badge {\r\n  display: inline-block;\r\n  padding: 4rpx 12rpx;\r\n  border-radius: 8rpx;\r\n  font-size: 22rpx;\r\n  font-weight: 600;\r\n  margin-top: 8rpx;\r\n}\r\n\r\n.status-draft {\r\n  background: #FFF3CD;\r\n  color: #856404;\r\n}\r\n\r\n.status-scheduled {\r\n  background: #D1ECF1;\r\n  color: #0C5460;\r\n}\r\n\r\n.status-sent {\r\n  background: #D4EDDA;\r\n  color: #155724;\r\n}\r\n\r\n.card-preview-content {\r\n  margin-top: 8rpx;\r\n  padding: 16rpx;\r\n  background: #FFFAF4;\r\n  border-radius: 12rpx;\r\n  border: 1rpx solid #FFE6D0;\r\n}\r\n\r\n.preview-text {\r\n  font-size: 26rpx;\r\n  color: #888888;\r\n  line-height: 1.6;\r\n  font-weight: 400;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n\r\n/* Êìç‰ΩúÊåâÈíÆ */\r\n.card-actions {\r\n  display: flex;\r\n  border-top: 1rpx solid #FFE6D0;\r\n}\r\n\r\n.action-btn {\r\n  flex: 1;\r\n  padding: 24rpx;\r\n  text-align: center;\r\n  font-size: 28rpx;\r\n  transition: background 0.3s;\r\n}\r\n\r\n.action-btn.view {\r\n  color: #FFB5C2;\r\n  border-right: 1rpx solid #F3E8FF;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n\r\n.action-btn.delete {\r\n  color: #ff6b6b;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n\r\n.action-btn:active {\r\n  background: #FFFAF4;\r\n}\r\n\r\n/* Á©∫Áä∂ÊÄÅ */\r\n.empty-state {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 120rpx 0;\r\n}\r\n\r\n.empty-icon {\r\n  font-size: 120rpx;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.empty-text {\r\n  font-size: 28rpx;\r\n  color: #888888;\r\n  margin-bottom: 40rpx;\r\n  font-weight: 400;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n\r\n.write-btn {\r\n  padding: 20rpx 60rpx;\r\n  background: linear-gradient(90deg, #FFB5C2 0%, #FFD4A3 100%);\r\n  color: #3d2a00;\r\n  border-radius: 48rpx;\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n\r\n/* ËØ¶ÊÉÖÂºπÁ™ó */\r\n.detail-modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.8);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 2000;\r\n}\r\n\r\n.detail-modal-content {\r\n  width: 90%;\r\n  max-width: 650rpx;\r\n  background: #ffffff;\r\n  border-radius: 24rpx;\r\n  padding: 32rpx;\r\n  box-shadow: 0 8rpx 32rpx rgba(0, 0, 0, 0.3);\r\n  max-height: 90vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.detail-modal-title {\r\n  font-size: 34rpx;\r\n  font-weight: 600;\r\n  color: #4A4A4A;\r\n  display: block;\r\n  text-align: center;\r\n  margin-bottom: 24rpx;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n\r\n.letter-detail {\r\n  flex: 1;\r\n  overflow: hidden;\r\n  border-radius: 16rpx;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.letter-wrapper {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 800rpx;\r\n  border-radius: 16rpx;\r\n  overflow: hidden;\r\n  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.letter-bg {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: 0;\r\n}\r\n\r\n.letter-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: #ffffff;\r\n  z-index: 1;\r\n}\r\n\r\n.letter-content {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 60rpx 40rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  z-index: 2;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.letter-header {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12rpx;\r\n  margin-bottom: 40rpx;\r\n  padding-bottom: 24rpx;\r\n  border-bottom: 2rpx solid rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.letter-title {\r\n  font-size: 36rpx;\r\n  font-weight: 600;\r\n  color: #4A4A4A;\r\n}\r\n\r\n.letter-date {\r\n  font-size: 24rpx;\r\n  color: #888888;\r\n  font-weight: 400;\r\n}\r\n\r\n.letter-body {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  margin-bottom: 32rpx;\r\n}\r\n\r\n.letter-text {\r\n  font-size: 28rpx;\r\n  line-height: 2;\r\n  color: #4A4A4A;\r\n  white-space: pre-wrap;\r\n  word-break: break-all;\r\n  font-weight: 400;\r\n}\r\n\r\n.letter-footer {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8rpx;\r\n  padding-top: 24rpx;\r\n  border-top: 2rpx solid rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.letter-info {\r\n  font-size: 24rpx;\r\n  color: #888888;\r\n  font-weight: 400;\r\n}\r\n\r\n.letter-time {\r\n  font-size: 22rpx;\r\n  color: #888888;\r\n  margin-top: 8rpx;\r\n  font-weight: 400;\r\n}\r\n\r\n/* Â≠ó‰ΩìÊ†∑ÂºèÁ±ª */\r\n.font-style-default {\r\n  font-family: 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n  letter-spacing: 0;\r\n}\r\n\r\n.font-style-mashanzheng {\r\n  font-family: 'MaShanZheng', 'Ma Shan Zheng', 'KaiTi', cursive;\r\n  letter-spacing: 2rpx;\r\n}\r\n\r\n.font-style-zcoolkuaile {\r\n  font-family: 'ZCOOLKuaiLe', 'ZCOOL KuaiLe', 'KaiTi', cursive;\r\n  letter-spacing: 1rpx;\r\n}\r\n\r\n.font-style-qingsong {\r\n  font-family: 'QingSong', 'KaiTi', 'STKaiti', cursive;\r\n  letter-spacing: 1.5rpx;\r\n}\r\n\r\n.font-style-zcoolxiaowei {\r\n  font-family: 'ZCOOLXiaoWei', 'ZCOOL XiaoWei', 'KaiTi', cursive;\r\n  letter-spacing: 1rpx;\r\n}\r\n\r\n.font-style-zcoolwenyi {\r\n  font-family: 'ZCOOLWenYi', 'ZCOOL WenYi', 'KaiTi', cursive;\r\n  letter-spacing: 1.5rpx;\r\n}\r\n\r\n.detail-modal-actions {\r\n  display: flex;\r\n  gap: 16rpx;\r\n}\r\n\r\n.detail-modal-btn {\r\n  flex: 1;\r\n  padding: 24rpx;\r\n  border-radius: 12rpx;\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n}\r\n\r\n.detail-modal-btn.close {\r\n  background: linear-gradient(90deg, #FFB5C2 0%, #FFD4A3 100%);\r\n  color: #3d2a00;\r\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'C:/Users/Administrator/Desktop/love_time/subPackages/record/pages/xinxiang/history.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getFutureLetterList","getSentLetters","getFutureLetterDetail","deleteFutureLetter"],"mappings":"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"}