{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<script>\n\t// ⚡ 立即初始化错误处理（在 App 实例创建之前）\n\t(function() {\n\t\t// 保存原始的 console.error\n\t\tconst originalError = console.error;\n\t\t\n\t\t// 重写 console.error 以过滤已知的无害错误\n\t\tconsole.error = function(...args) {\n\t\t\tconst errorMsg = args.join(' ');\n\t\t\t\n\t\t\t// 过滤 WebSocket 连接错误（开发工具日志通道）\n\t\t\tif (\n\t\t\t\terrorMsg.includes('WebSocket connection') && \n\t\t\t\terrorMsg.includes('failed') &&\n\t\t\t\t(errorMsg.includes('mp-weixin') || errorMsg.includes('8090'))\n\t\t\t) {\n\t\t\t\treturn; // 静默处理\n\t\t\t}\n\t\t\t\n\t\t\t// 过滤文件系统错误（小程序环境不支持 Node.js 文件系统）\n\t\t\tif (\n\t\t\t\terrorMsg.includes('not node js file system') ||\n\t\t\t\terrorMsg.includes('saaa_config.json') ||\n\t\t\t\t(errorMsg.includes('readFile') && errorMsg.includes('worker')) ||\n\t\t\t\terrorMsg.includes('__invokeHandler__ readFile')\n\t\t\t) {\n\t\t\t\treturn; // 静默处理\n\t\t\t}\n\t\t\t\n\t\t\t// 其他错误正常显示\n\t\t\toriginalError.apply(console, args);\n\t\t};\n\t\t\n\t\t// 捕获全局错误（小程序环境）\n\t\tif (typeof uni !== 'undefined') {\n\t\t\tuni.onError && uni.onError((error) => {\n\t\t\t\tif (!error) return;\n\t\t\t\t\n\t\t\t\tconst errorStr = typeof error === 'string' ? error : JSON.stringify(error);\n\t\t\t\t\n\t\t\t\t// 过滤已知的无害错误\n\t\t\t\tif (\n\t\t\t\t\t(errorStr.includes('WebSocket') && errorStr.includes('mp-weixin')) ||\n\t\t\t\t\terrorStr.includes('not node js file system') ||\n\t\t\t\t\terrorStr.includes('saaa_config.json') ||\n\t\t\t\t\t(errorStr.includes('readFile') && errorStr.includes('worker')) ||\n\t\t\t\t\terrorStr.includes('__invokeHandler__ readFile')\n\t\t\t\t) {\n\t\t\t\t\treturn; // 静默处理\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 其他错误正常处理\n\t\t\t\toriginalError('未捕获的错误:', error);\n\t\t\t});\n\t\t}\n\t\t\n\t\t// 捕获全局错误（浏览器环境）\n\t\tif (typeof window !== 'undefined') {\n\t\t\tconst originalOnError = window.onerror;\n\t\t\twindow.onerror = function(message, source, lineno, colno, error) {\n\t\t\t\tconst errorMsg = message || '';\n\t\t\t\tif (\n\t\t\t\t\terrorMsg.includes('not node js file system') ||\n\t\t\t\t\terrorMsg.includes('saaa_config.json') ||\n\t\t\t\t\t(errorMsg.includes('readFile') && errorMsg.includes('worker')) ||\n\t\t\t\t\terrorMsg.includes('__invokeHandler__ readFile')\n\t\t\t\t) {\n\t\t\t\t\treturn true; // 阻止默认错误处理\n\t\t\t\t}\n\t\t\t\t// 其他错误正常处理\n\t\t\t\tif (originalOnError) {\n\t\t\t\t\treturn originalOnError.call(this, message, source, lineno, colno, error);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\t\t}\n\t})();\n\t\n\texport default {\n\t\tonLaunch: function() {\n\t\t\tconsole.log('App Launch');\n\t\t\t\n\t\t\t// 检查登录状态\n\t\t\tthis.checkLoginStatus();\n\t\t},\n\t\tonShow: function() {\n\t\t\tconsole.log('App Show')\n\t\t},\n\t\tonHide: function() {\n\t\t\tconsole.log('App Hide')\n\t\t},\n\t\tmethods: {\n\t\t\t// 检查登录状态\n\t\t\tcheckLoginStatus() {\n\t\t\t\ttry {\n\t\t\t\t\tconst loginInfo = uni.getStorageSync('login_info');\n\t\t\t\t\tconst pages = getCurrentPages();\n\t\t\t\t\tconst currentPage = pages[pages.length - 1];\n\t\t\t\t\tconst currentRoute = currentPage ? currentPage.route : '';\n\t\t\t\t\t\n\t\t\t\t\t// 白名单页面（不需要登录的页面）\n\t\t\t\t\tconst whiteList = ['pages/login/index'];\n\t\t\t\t\t\n\t\t\t\t\t// 检查是否有有效的token\n\t\t\t\t\tconst hasToken = loginInfo && (\n\t\t\t\t\t\t(loginInfo.token && loginInfo.token.trim()) ||\n\t\t\t\t\t\t(loginInfo.data?.token && loginInfo.data.token.trim()) ||\n\t\t\t\t\t\t(loginInfo.accessToken && loginInfo.accessToken.trim())\n\t\t\t\t\t);\n\t\t\t\t\t\n\t\t\t\t\t// 如果登录信息存在但token缺失，清除无效的登录信息\n\t\t\t\t\tif (loginInfo && loginInfo.isLoggedIn && !hasToken) {\n\t\t\t\t\t\tconsole.warn('⚠️ 检测到无效的登录信息（缺少token），正在清除...');\n\t\t\t\t\t\tuni.removeStorageSync('login_info');\n\t\t\t\t\t\tconsole.warn('✅ 已清除无效的登录信息');\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// 如果未登录且不在白名单中，跳转到登录页\n\t\t\t\t\tif (!loginInfo || !loginInfo.isLoggedIn || !hasToken) {\n\t\t\t\t\t\tif (!whiteList.includes(currentRoute)) {\n\t\t\t\t\t\t\tuni.reLaunch({\n\t\t\t\t\t\t\t\turl: '/pages/login/index'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('检查登录状态失败', e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\t/*每个页面公共css */\n\t\n\t/* 底部导航栏字体样式 - 与主页导航栏一致 */\n\t/* #ifdef MP-WEIXIN */\n\t/* 微信小程序底部导航栏字体样式 */\n\t/deep/ .uni-tabbar {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\n\t}\n\t\n\t/deep/ .uni-tabbar__bd {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\n\t\tfont-weight: 500;\n\t}\n\t/* #endif */\n\t\n\t/* #ifdef H5 */\n\t/* H5底部导航栏字体样式 */\n\t.uni-tabbar {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\n\t}\n\t\n\t.uni-tabbar__bd {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;\n\t\tfont-weight: 500;\n\t}\n\t/* #endif */\n\t\n\t/* 底部导航栏选中图标颜色 - 尝试通过filter实现粉色效果 */\n\t/* 注意：原生tabbar的PNG图标可能无法通过CSS直接改变颜色 */\n\t/* 如果此方法无效，需要准备粉色版本的图标文件 */\n</style>\n","import App from './App'\r\n\r\n// #ifndef VUE3\r\nimport Vue from 'vue'\r\nimport './uni.promisify.adaptor'\r\nVue.config.productionTip = false\r\nApp.mpType = 'app'\r\nconst app = new Vue({\r\n  ...App\r\n})\r\napp.$mount()\r\n// #endif\r\n\r\n// #ifdef VUE3\r\nimport { createSSRApp } from 'vue'\r\nexport function createApp() {\r\n  const app = createSSRApp(App)\r\n  return {\r\n    app\r\n  }\r\n}\r\n// #endif"],"names":["uni","createSSRApp","App"],"mappings":"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"}